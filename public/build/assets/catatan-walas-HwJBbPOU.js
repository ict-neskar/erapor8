import{_ as A}from"./ConfirmDialog-FUvEvqZ3.js";import{_ as B}from"./AppTextarea-CYZiotoS.js";import{_ as S}from"./ProfileSiswa-Oaws0S5b.js";import{G as U,r as t,f,e as s,o as r,b as i,t as y,m as e,c as k,am as E,F as w,ap as q,d as o,h as K,y as C,aa as M,a2 as N}from"./main-BLR2YNPc.js";import{d as x,a as F}from"./mixins-B3UHDqO3.js";import{u as O,c as j}from"./createUrl-Ck_LlMGD.js";import{$ as z}from"./api-KcMzrp4S.js";import{V as G,c as I,a as L,b as D}from"./VCard-2_qp3Vvc.js";import{V as W}from"./VDivider-DOshNxjC.js";import{V as H}from"./VForm-BNrtY43f.js";import{V as J}from"./VTable-DC5yuf29.js";import{V as Q}from"./VAlert-D_wAHgpV.js";import"./VDialog-Hzphy_2H.js";import"./VOverlay-CiGj4qAf.js";import"./forwardRefs-DWGaNmQL.js";import"./scopeId-LkyyTvVZ.js";import"./VImg-C5whf5xb.js";import"./VLabel-QfOIbUGb.js";import"./VTextarea-CXGUfcsA.js";/* empty css                   */import"./VField-BZSU_Yhz.js";import"./VAvatar-BZJqyIb4.js";import"./index-BxkgbwWS.js";const ya={__name:"catatan-walas",setup(X){U(async()=>{await P()});const V=t({body:!1,table:!1}),l=t({user_id:x.user_id,guru_id:x.guru_id,sekolah_id:x.sekolah_id,semester_id:F.semester_id,periode_aktif:F.nama,aksi:"catatan_walas"}),p=t({uraian_deskripsi:{}}),_=t({siswa:[]}),d=t(!1),v=t(!1),c=t(!1),h=t(!1),g=t({color:null,title:null,text:null});t({dudi_id:null});const P=async()=>{V.value.body=!0;try{let a=(await O(j("/walas",{query:{user_id:l.value.user_id,guru_id:l.value.guru_id,sekolah_id:l.value.sekolah_id,semester_id:l.value.semester_id,periode_aktif:l.value.nama,aksi:l.value.aksi}}))).data.value;_.value.siswa=a.data_siswa,h.value=a.is_new_ppa,a.data_siswa.forEach(n=>{var b;p.value.uraian_deskripsi[n.anggota_rombel.anggota_rombel_id]=((b=n.anggota_rombel.catatan_walas)==null?void 0:b.uraian_deskripsi)??null})}catch(m){console.error(m)}finally{V.value.body=!1}},R=async()=>{d.value=!0;const m={...l.value,...p.value};await z("/walas/save",{method:"POST",body:m,onResponseError({response:a}){console.log("ERROR:",a._data.errors),d.value=!1},onResponse({response:a}){d.value=!1;let n=a._data;n.errors||(c.value=!0,g.value=n)}})};return(m,a)=>{const n=S,b=B,T=A;return r(),f(G,null,{default:s(()=>[i(L,{class:"pb-4"},{default:s(()=>[i(I,null,{default:s(()=>a[2]||(a[2]=[y("Catatan Wali Kelas")])),_:1})]),_:1}),e(V).body?(r(),k(w,{key:0},[i(W),i(D,{class:"text-center"},{default:s(()=>[i(E,{size:60,indeterminate:"",color:"error",class:"my-10"})]),_:1})],64)):(r(),k(w,{key:1},[e(h)?(r(),f(H,{key:0,onSubmit:q(R,["prevent"])},{default:s(()=>[e(_).siswa.length?(r(),f(J,{key:0},{default:s(()=>[a[3]||(a[3]=o("thead",null,[o("tr",null,[o("th",{class:"text-center",width:"30%"},"Nama Peserta Didik"),o("th",{class:"text-center",width:"70%"},"Deskripsi")])],-1)),o("tbody",null,[(r(!0),k(w,null,K(e(_).siswa,u=>(r(),k("tr",null,[o("td",null,[i(n,{item:u},null,8,["item"])]),o("td",null,[i(b,{class:"my-4",modelValue:e(p).uraian_deskripsi[u.anggota_rombel.anggota_rombel_id],"onUpdate:modelValue":$=>e(p).uraian_deskripsi[u.anggota_rombel.anggota_rombel_id]=$},null,8,["modelValue","onUpdate:modelValue"])])]))),256))])]),_:1})):C("",!0),e(_).siswa.length?(r(),f(D,{key:1,class:"d-flex justify-end flex-wrap gap-3 pt-5 overflow-visible"},{default:s(()=>[i(M,{variant:"elevated",type:"submit",loading:e(d),disabled:e(d)},{default:s(()=>a[4]||(a[4]=[y(" Simpan ")])),_:1},8,["loading","disabled"])]),_:1})):C("",!0)]),_:1})):(r(),f(D,{key:1},{default:s(()=>[i(Q,{color:"error",class:"text-center my-4",variant:"tonal"},{default:s(()=>a[5]||(a[5]=[o("h2",{class:"mt-4 mb-4"},"Fitur ditutup!",-1),o("p",null,[y("Fitur Kokurikuler hanya untuk "),o("strong",null,"PPA Revisi")],-1)])),_:1})]),_:1}))],64)),i(T,{isDialogVisible:e(v),"onUpdate:isDialogVisible":a[0]||(a[0]=u=>N(v)?v.value=u:null),isNotifVisible:e(c),"onUpdate:isNotifVisible":a[1]||(a[1]=u=>N(c)?c.value=u:null),"confirmation-question":"Apakah Anda yakin?","confirmation-text":"Tindakan ini tidak dapat dikembalikan!","confirm-color":e(g).color,"confirm-title":e(g).title,"confirm-msg":e(g).text},null,8,["isDialogVisible","isNotifVisible","confirm-color","confirm-title","confirm-msg"])]),_:1})}}};export{ya as default};
