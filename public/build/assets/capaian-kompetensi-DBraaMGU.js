import{_ as ra}from"./ConfirmDialog-FUvEvqZ3.js";import{_ as ia}from"./AppTextarea-CYZiotoS.js";import{_ as sa}from"./ProfileSiswa-Oaws0S5b.js";import{_ as ma}from"./DefaultForm-Dr2UKQPo.js";import{r as s,G as da,f as b,e as r,o as g,b as n,t as N,m as e,am as q,ap as ua,a2 as k,d as i,aa as G,y as F,c as B,h as pa,F as ga,v as I}from"./main-BLR2YNPc.js";import{$ as T}from"./api-KcMzrp4S.js";import{a as H,d as w}from"./mixins-B3UHDqO3.js";import{V as _a,c as fa,a as ca,b as R}from"./VCard-2_qp3Vvc.js";import{V as J}from"./VDivider-DOshNxjC.js";import{V as ba}from"./VForm-BNrtY43f.js";import{V as Q,a as $}from"./VRow-90jB0EEo.js";import{V as X}from"./VAlert-D_wAHgpV.js";import{V as ka}from"./VTable-DC5yuf29.js";import"./VDialog-Hzphy_2H.js";import"./VOverlay-CiGj4qAf.js";import"./forwardRefs-DWGaNmQL.js";import"./scopeId-LkyyTvVZ.js";import"./VImg-C5whf5xb.js";import"./VLabel-QfOIbUGb.js";import"./VTextarea-CXGUfcsA.js";/* empty css                   */import"./VField-BZSU_Yhz.js";import"./VAvatar-BZJqyIb4.js";import"./AppAutocomplete-BlXTHohd.js";import"./VSelect-DTXlVIl9.js";import"./AppTextField-BTba3qr2.js";import"./VList-DhBNZzgQ.js";import"./ssrBoot-Cfszeb4X.js";import"./VMenu-IOUSI9rL.js";import"./VSelectionControl-Cco01M7z.js";import"./VChip-CM7CTnjc.js";import"./VSlideGroup-CtUoo4jB.js";import"./filter-95PybUkX.js";import"./AppSelect-Cd9HFhsW.js";import"./index-BxkgbwWS.js";/* empty css              */const va={key:0,class:"text-center"},ya={class:"text-center"},Va={class:"text-center"},ne={__name:"capaian-kompetensi",setup(ha){const A=s(!0),E=s(!0),Y=async()=>{try{const l=await T("/setting/status-penilaian",{method:"POST",body:{sekolah_id:w.sekolah_id,semester_id:H.semester_id}});E.value=l}catch(l){console.error(l)}finally{A.value=!1}};da(async()=>{await Y()});const _=s({tingkat:null,rombongan_belajar_id:null,pembelajaran_id:null,mata_pelajaran_id:null}),x=s({tingkat:null,rombongan_belajar_id:null,pembelajaran_id:null}),p=s({rombel:[],mapel:[],siswa:[]}),f=s({body:!1,rombel:!1,mapel:!1}),j=s(!1),K=s(0),v={opsi:"capaian-kompetensi",semester_id:H.semester_id,user_id:w.user_id,guru_id:w.guru_id,sekolah_id:w.sekolah_id,merdeka:!1},m=s({angka:{},kompeten:{},inkompeten:{}}),C=s(!1),O=async l=>{const a={...l,...v};await T("/referensi/get-data",{method:"POST",body:a,onResponse({response:d}){p.value.siswa=[],j.value=!1;let u=d._data;l.data=="rombel"&&(p.value.rombel=u),l.data=="mapel"&&(p.value.mapel=u.mapel,v.merdeka=u.merdeka,C.value=!!u.rombel.kunci_nilai)}})},Z=async l=>{_.value.rombongan_belajar_id=null,_.value.pembelajaran_id=null,l&&(f.value.rombel=!0,await O({data:"rombel",nilai:1,tingkat:l}).then(()=>{f.value.rombel=!1}))},aa=async l=>{_.value.pembelajaran_id=null,l&&(f.value.mapel=!0,await O({data:"mapel",nilai:1,rombongan_belajar_id:l}).then(()=>{f.value.mapel=!1}))},M=l=>l.charAt(0).toLowerCase()+l.slice(1),z=l=>{var a=/\+([a-z\d\/+]*\-?)/gi,d,u,c,o;return l.replace(a,function(t,h){for(d=Buffer(h,"base64"),u=d.length>>1<<1,c="",o=1,o;o<u;o=o+2)c+=String.fromCharCode(d.readUInt16BE(o-1));return c})},ea=async l=>{if(p.value.siswa=[],l){const a={..._.value,...v};f.value.body=!0,j.value=!1,await T("/penilaian/get-capaian-kompetensi",{method:"POST",body:a,onResponse({response:d}){var c;let u=d._data;p.value.siswa=u.data_siswa,K.value=u.show_reset,j.value=!!((c=u.data_siswa)!=null&&c.length),f.value.body=!1,u.data_siswa.forEach(o=>{if(m.value.angka[o.anggota_rombel.anggota_rombel_id]=o.anggota_rombel.nilai_akhir_mapel?o.anggota_rombel.nilai_akhir_mapel.nilai:"",o.anggota_rombel.single_deskripsi_mata_pelajaran)m.value.kompeten[o.anggota_rombel.anggota_rombel_id]=o.anggota_rombel.single_deskripsi_mata_pelajaran.deskripsi_pengetahuan,m.value.inkompeten[o.anggota_rombel.anggota_rombel_id]=o.anggota_rombel.single_deskripsi_mata_pelajaran.deskripsi_keterampilan;else{var t=[],h=[];o.anggota_rombel.tp_kompeten.length?(o.anggota_rombel.tp_kompeten.forEach(y=>{t.push(z(M(y.tp.deskripsi)))}),m.value.kompeten[o.anggota_rombel.anggota_rombel_id]="Menunjukkan penguasaan yang baik dalam "+t.join(", ")):m.value.kompeten[o.anggota_rombel.anggota_rombel_id]=null,o.anggota_rombel.tp_inkompeten.length?(o.anggota_rombel.tp_inkompeten.forEach(y=>{h.push(z(M(y.tp.deskripsi)))}),m.value.inkompeten[o.anggota_rombel.anggota_rombel_id]="Perlu ditingkatkan dalam "+h.join(", ")):m.value.inkompeten[o.anggota_rombel.anggota_rombel_id]=null}})}})}},U=s(!1),D=s(!1),P=s(!1),L=s(""),V=s({color:"",title:"",text:""}),ta=async()=>{U.value=!0;const l={...v,..._.value,...m.value};await T("/penilaian/simpan",{method:"POST",body:l,onResponse({response:a}){let d=a._data;U.value=!1,d.errors?x.value=d.errors:(D.value=!0,V.value=d)}})},S=s(!1),W=()=>{S.value=!0,_.value={tingkat:null,rombongan_belajar_id:null,pembelajaran_id:null,mata_pelajaran_id:null},x.value={tingkat:null,rombongan_belajar_id:null,pembelajaran_id:null},p.value={rombel:[],mapel:[],siswa:[]},j.value=!1,K.value=0,m.value={angka:{},kompeten:{},inkompeten:{}}},la=()=>{W()},oa=()=>{P.value=!0,L.value="Tindakan ini tidak dapat dikembalikan!",V.value={color:"warning",title:"a",text:"b"}},na=async()=>{v.opsi="reset-kompetensi";const l={...v,..._.value,...m.value};await T("/penilaian/simpan",{method:"POST",body:l,onResponse({response:a}){let d=a._data;v.opsi="capaian-kompetensi",V.value=d,D.value=!0,W()}})};return(l,a)=>{const d=ma,u=sa,c=ia,o=ra;return g(),b(_a,{class:"mb-6"},{default:r(()=>[n(ca,{class:"pb-4"},{default:r(()=>[n(fa,null,{default:r(()=>a[8]||(a[8]=[N("Capaian Kompetensi")])),_:1})]),_:1}),n(J),e(A)?(g(),b(R,{key:0,class:"text-center"},{default:r(()=>[n(q,{size:60,indeterminate:"",color:"error",class:"my-10"})]),_:1})):e(E)?(g(),b(ba,{key:1,onSubmit:ua(ta,["prevent"])},{default:r(()=>[n(R,null,{default:r(()=>[n(Q,null,{default:r(()=>[n(d,{form:e(_),"onUpdate:form":a[0]||(a[0]=t=>k(_)?_.value=t:null),errors:e(x),"onUpdate:errors":a[1]||(a[1]=t=>k(x)?x.value=t:null),arrayData:e(p),"onUpdate:arrayData":a[2]||(a[2]=t=>k(p)?p.value=t:null),loading:e(f),"onUpdate:loading":a[3]||(a[3]=t=>k(f)?f.value=t:null),resetForm:e(S),"onUpdate:resetForm":a[4]||(a[4]=t=>k(S)?S.value=t:null),isKunci:e(C),"onUpdate:isKunci":a[5]||(a[5]=t=>k(C)?C.value=t:null),onTingkat:Z,onRombongan_belajar_id:aa,onPembelajaran_id:ea},null,8,["form","errors","arrayData","loading","resetForm","isKunci"]),e(K)?(g(),b($,{key:0,cols:"12"},{default:r(()=>[n(Q,{"no-gutters":""},{default:r(()=>[n($,{cols:"12",md:"3",class:"d-flex align-items-center"},{default:r(()=>a[9]||(a[9]=[i("label",{class:"v-label text-body-2 text-high-emphasis"},"Reset Capaian Kompetensi",-1)])),_:1}),n($,{cols:"12",md:"9"},{default:r(()=>[n(G,{variant:"tonal",color:"error",onClick:oa},{default:r(()=>a[10]||(a[10]=[N(" Reset Capaian Kompetensi ")])),_:1})]),_:1})]),_:1})]),_:1})):F("",!0)]),_:1}),e(f).body?(g(),B("div",va,[n(q,{size:60,indeterminate:"",color:"error",class:"my-10"})])):F("",!0),e(C)?(g(),b(X,{key:1,color:"error",class:"text-center my-4",variant:"tonal"},{default:r(()=>a[11]||(a[11]=[i("h2",{class:"mt-4 mb-4"},"Penilaian tidak aktif. Silahkan hubungi Wali Kelas!",-1)])),_:1})):F("",!0)]),_:1}),e(p).siswa.length?(g(),b(ka,{key:0},{default:r(()=>[a[12]||(a[12]=i("thead",null,[i("tr",null,[i("th",{class:"text-center",rowspan:"2",style:{"vertical-align":"middle"}},"No"),i("th",{class:"text-center",rowspan:"2",style:{"vertical-align":"middle"}},"Nama Peserta Didik"),i("th",{class:"text-center",rowspan:"2",style:{"vertical-align":"middle"}},"Nilai Akhir"),i("th",{class:"text-center",colspan:"2"},"Capaian Kompetensi")]),i("tr",null,[i("th",{class:"text-center"},"Kompetensi yang telah dicapai"),i("th",{class:"text-center"},"Kompetensi yang perlu ditingkatkan")])],-1)),i("tbody",null,[(g(!0),B(ga,null,pa(e(p).siswa,(t,h)=>(g(),B("tr",null,[i("td",ya,I(h+1),1),i("td",null,[n(u,{item:t},null,8,["item"])]),i("td",Va,I(e(m).angka[t.anggota_rombel.anggota_rombel_id]),1),i("td",null,[n(c,{modelValue:e(m).kompeten[t.anggota_rombel.anggota_rombel_id],"onUpdate:modelValue":y=>e(m).kompeten[t.anggota_rombel.anggota_rombel_id]=y,placeholder:"Kompetensi yang telah dicapai",class:"py-2 px-2"},null,8,["modelValue","onUpdate:modelValue"])]),i("td",null,[n(c,{modelValue:e(m).inkompeten[t.anggota_rombel.anggota_rombel_id],"onUpdate:modelValue":y=>e(m).inkompeten[t.anggota_rombel.anggota_rombel_id]=y,placeholder:"Kompetensi yang perlu ditingkatkan"},null,8,["modelValue","onUpdate:modelValue"])])]))),256))])]),_:1})):F("",!0),n(J),e(j)?(g(),b(R,{key:1,class:"d-flex justify-end flex-wrap gap-3 pt-5 overflow-visible"},{default:r(()=>[n(G,{variant:"elevated",type:"submit",loading:e(U),disabled:e(U)},{default:r(()=>a[13]||(a[13]=[N(" Simpan ")])),_:1},8,["loading","disabled"])]),_:1})):F("",!0)]),_:1})):(g(),b(R,{key:2},{default:r(()=>[n(X,{color:"error",class:"text-center my-4",variant:"tonal"},{default:r(()=>a[14]||(a[14]=[i("h2",{class:"mt-4 mb-4"},"Penilaian tidak aktif. Silahkan hubungi administrator!",-1)])),_:1})]),_:1})),n(o,{isDialogVisible:e(P),"onUpdate:isDialogVisible":a[6]||(a[6]=t=>k(P)?P.value=t:null),isNotifVisible:e(D),"onUpdate:isNotifVisible":a[7]||(a[7]=t=>k(D)?D.value=t:null),"confirmation-question":"Apakah Anda yakin?","confirmation-text":e(L),"confirm-color":e(V).color,"confirm-title":e(V).title,"confirm-msg":e(V).text,onConfirm:na,onClose:la},null,8,["isDialogVisible","isNotifVisible","confirmation-text","confirm-color","confirm-title","confirm-msg"])]),_:1})}}};export{ne as default};
