import{_ as K}from"./ConfirmDialog-CoWyGp8W.js";import{_ as L}from"./AppTextField-bfe1muJ5.js";import{_ as M}from"./ProfileSiswa-CNtxoAVM.js";import{_ as O}from"./AppAutocomplete-Br1PWZIT.js";import{G as q,r as u,c as x,b as a,e as i,m as e,a2 as z,F as D,o as c,t as P,ap as G,d as n,f as H,am as J,y as R,h as Q,aa as W}from"./main-BbIknAU_.js";import{d as j,a as T}from"./mixins-D9sK_GNK.js";import{$}from"./api-zDHFqD3S.js";import{V as X,a as Y,c as Z,b as U}from"./VCard-DP6R80QM.js";import{V as ee}from"./VDivider-AdngBwQk.js";import{V as ae}from"./VForm-BMhz_qEl.js";import{V as w,a as b}from"./VRow-BRHNHyL4.js";import{V as le}from"./VTable-D6I1NIoz.js";import"./VDialog-AuNDjXN_.js";import"./VOverlay-CegGukY1.js";import"./forwardRefs-DWGaNmQL.js";import"./scopeId-Cm6oLMEy.js";import"./VImg-C0bob0hg.js";import"./VLabel-BKB7GbBW.js";/* empty css                   */import"./VField-CiROKIcN.js";import"./VAvatar-DhWlB6rZ.js";import"./VSelect-B8TBIhr3.js";import"./VList-CU7bhzU4.js";import"./ssrBoot-DItPKqse.js";import"./VMenu-RccmEXkB.js";import"./VSelectionControl-BTie8rgs.js";import"./VChip-L5Rr2CRm.js";import"./VSlideGroup-BPY7Rwgf.js";import"./filter-DNqhOXQ6.js";import"./index-BxkgbwWS.js";/* empty css              */const te={class:"text-no-wrap border-right align-top"},ie={class:"py-4"},oe={class:"py-4"},re={class:"py-4"},Ie={__name:"ketidakhadiran",setup(se){q(async()=>{s.value.rombel=!0,await g({data:"rombel"}).then(()=>{s.value.rombel=!1})});const F=u({user_id:j.user_id,guru_id:j.guru_id,sekolah_id:j.sekolah_id,semester_id:T.semester_id,periode_aktif:T.nama}),o=u({aksi:"absen",rombongan_belajar_id:null,pkl_id:null,sakit:{},izin:{},alpa:{}}),k=u({rombongan_belajar_id:null,pkl_id:null}),d=u({rombel:[],pkl:[],siswa:[]}),s=u({rombel:!1,pkl:!1,body:!1}),g=async r=>{const l={...r,...F.value,...o.value};await $("/praktik-kerja-lapangan/get-data",{method:"POST",body:l,async onResponse({response:p}){let _=p._data;r.data=="rombel"&&(d.value.rombel=_),r.data=="pkl"&&(d.value.pkl=_),r.data=="siswa"&&(d.value.siswa=_.siswa,d.value.tp=_.tp,_.siswa.forEach(m=>{var h,t,f;o.value.sakit[m.peserta_didik_id]=((h=m.absensi_pkl)==null?void 0:h.sakit)??null,o.value.izin[m.peserta_didik_id]=((t=m.absensi_pkl)==null?void 0:t.izin)??null,o.value.alpa[m.peserta_didik_id]=((f=m.absensi_pkl)==null?void 0:f.alpa)??null}))}})},B=async r=>{o.value.pkl_id=null,d.value.pkl=[],r&&(s.value.pkl=!0,await g({data:"pkl"}).then(()=>{s.value.pkl=!1}))},S=async r=>{d.value.siswa=[],d.value.tp=[],r&&(s.value.body=!0,await g({data:"siswa"}).then(()=>{s.value.body=!1}))},N=u(),V=u(!1),v=u(!1),C=u(!1),y=u({color:null,title:null,text:null}),A=async()=>{var r;(r=N.value)==null||r.validate().then(({valid:l})=>{l&&I()})},I=async()=>{V.value=!0;const r={...F.value,...o.value};await $("/praktik-kerja-lapangan/save",{method:"POST",body:r,onResponse({response:l}){V.value=!1;let p=l._data;p.errors?k.value=p.errors:(E(),v.value=!0,y.value=p)}})},E=async()=>{o.value={aksi:"nilai",rombongan_belajar_id:null,pkl_id:null,sakit:{},izin:{},alpa:{}},k.value={rombongan_belajar_id:null,pkl_id:null},d.value={rombel:[],pkl:[],siswa:[]},s.value.rombel=!0,await g({data:"rombel"}).then(()=>{s.value.rombel=!1})};return(r,l)=>{const p=O,_=M,m=L,h=K;return c(),x(D,null,[a(X,{class:"mb-6"},{default:i(()=>[a(Y,{class:"pb-4"},{default:i(()=>[a(Z,null,{default:i(()=>l[4]||(l[4]=[P("Input Ketidakhadiran PKL")])),_:1})]),_:1}),a(ee),a(ae,{ref_key:"refVForm",ref:N,onSubmit:G(A,["prevent"])},{default:i(()=>[a(U,null,{default:i(()=>[a(w,null,{default:i(()=>[a(b,{cols:"12"},{default:i(()=>[a(w,{"no-gutters":""},{default:i(()=>[a(b,{cols:"12",md:"3",class:"d-flex align-items-center"},{default:i(()=>l[5]||(l[5]=[n("label",{class:"v-label text-body-2 text-high-emphasis",for:"rombongan_belajar_id"},"Rombongan Belajar",-1)])),_:1}),a(b,{cols:"12",md:"9"},{default:i(()=>[a(p,{modelValue:e(o).rombongan_belajar_id,"onUpdate:modelValue":[l[0]||(l[0]=t=>e(o).rombongan_belajar_id=t),B],placeholder:"== Pilih Rombongan Belajar == ",items:e(d).rombel,clearable:"","clear-icon":"tabler-x","item-value":"rombongan_belajar_id","item-title":"nama",loading:e(s).rombel,disabled:e(s).rombel,"error-messages":e(k).rombongan_belajar_id},null,8,["modelValue","items","loading","disabled","error-messages"])]),_:1})]),_:1})]),_:1}),a(b,{cols:"12"},{default:i(()=>[a(w,{"no-gutters":""},{default:i(()=>[a(b,{cols:"12",md:"3",class:"d-flex align-items-center"},{default:i(()=>l[6]||(l[6]=[n("label",{class:"v-label text-body-2 text-high-emphasis",for:"pkl_id"},"DUDI",-1)])),_:1}),a(b,{cols:"12",md:"9"},{default:i(()=>[a(p,{modelValue:e(o).pkl_id,"onUpdate:modelValue":[l[1]||(l[1]=t=>e(o).pkl_id=t),S],placeholder:"== Pilih DUDI == ",items:e(d).pkl,clearable:"","clear-icon":"tabler-x","item-value":"pkl_id","item-title":"nama_dudi",loading:e(s).pkl,disabled:e(s).pkl,"error-messages":e(k).pkl_id},null,8,["modelValue","items","loading","disabled","error-messages"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(s).body?(c(),H(U,{key:0,class:"text-center"},{default:i(()=>[a(J,{size:60,indeterminate:"",color:"error"})]),_:1})):R("",!0),e(d).siswa.length?(c(),x(D,{key:1},[a(le,null,{default:i(()=>[l[7]||(l[7]=n("thead",null,[n("tr",null,[n("th",null,"Nama Peserta Didik"),n("th",{class:"text-center"},"Sakit"),n("th",{class:"text-center"},"Izin"),n("th",{class:"text-center"},"Alpa")])],-1)),n("tbody",null,[(c(!0),x(D,null,Q(e(d).siswa,t=>(c(),x("tr",null,[n("td",te,[a(_,{item:t},null,8,["item"])]),n("td",ie,[a(m,{modelValue:e(o).sakit[t.peserta_didik_id],"onUpdate:modelValue":f=>e(o).sakit[t.peserta_didik_id]=f},null,8,["modelValue","onUpdate:modelValue"])]),n("td",oe,[a(m,{modelValue:e(o).izin[t.peserta_didik_id],"onUpdate:modelValue":f=>e(o).izin[t.peserta_didik_id]=f},null,8,["modelValue","onUpdate:modelValue"])]),n("td",re,[a(m,{modelValue:e(o).alpa[t.peserta_didik_id],"onUpdate:modelValue":f=>e(o).alpa[t.peserta_didik_id]=f},null,8,["modelValue","onUpdate:modelValue"])])]))),256))])]),_:1}),a(U,{class:"d-flex justify-end flex-wrap gap-3 pt-5"},{default:i(()=>[a(W,{variant:"elevated",type:"submit",loading:e(V),disabled:e(V)},{default:i(()=>l[8]||(l[8]=[P(" Simpan ")])),_:1},8,["loading","disabled"])]),_:1})],64)):R("",!0)]),_:1},512)]),_:1}),a(h,{isDialogVisible:e(C),"onUpdate:isDialogVisible":l[2]||(l[2]=t=>z(C)?C.value=t:null),isNotifVisible:e(v),"onUpdate:isNotifVisible":l[3]||(l[3]=t=>z(v)?v.value=t:null),"confirmation-question":"Apakah Anda yakin?","confirmation-text":"Tindakan ini tidak dapat dikembalikan!","confirm-color":e(y).color,"confirm-title":e(y).title,"confirm-msg":e(y).text,onConfirm:r.confirmDelete,onClose:r.confirmClose},null,8,["isDialogVisible","isNotifVisible","confirm-color","confirm-title","confirm-msg","onConfirm","onClose"])],64)}}};export{Ie as default};
