import{a as j,d as v}from"./mixins-D9sK_GNK.js";import{G as ae,r as u,c as R,b as a,e as r,m as l,a2 as G,o as c,t as A,ap as le,d as n,f as B,aa as I,v as L,y as F,am as te,F as H,h as re}from"./main-BbIknAU_.js";import{_ as se}from"./ConfirmDialog-CoWyGp8W.js";import{_ as ie}from"./AppSelect-C873-ZzL.js";import{_ as oe}from"./ProfileSiswa-CNtxoAVM.js";import{_ as ne}from"./AppAutocomplete-Br1PWZIT.js";import{_ as ue}from"./AppTextField-bfe1muJ5.js";import{$ as U}from"./api-zDHFqD3S.js";import{V as de,a as me,c as ke,b as O}from"./VCard-DP6R80QM.js";import{V as K}from"./VDivider-AdngBwQk.js";import{V as _e}from"./VForm-BMhz_qEl.js";import{V as w,a as m}from"./VRow-BRHNHyL4.js";import{V as fe}from"./VTable-D6I1NIoz.js";import"./VDialog-AuNDjXN_.js";import"./VOverlay-CegGukY1.js";import"./forwardRefs-DWGaNmQL.js";import"./scopeId-Cm6oLMEy.js";import"./VImg-C0bob0hg.js";import"./VLabel-BKB7GbBW.js";import"./VSelect-B8TBIhr3.js";import"./VList-CU7bhzU4.js";import"./ssrBoot-DItPKqse.js";import"./VAvatar-DhWlB6rZ.js";import"./VMenu-RccmEXkB.js";import"./VSelectionControl-BTie8rgs.js";import"./VChip-L5Rr2CRm.js";import"./VSlideGroup-BPY7Rwgf.js";import"./filter-DNqhOXQ6.js";/* empty css                   */import"./VField-CiROKIcN.js";import"./index-BxkgbwWS.js";/* empty css              */const ge={class:"text-center"},Qe={__name:"ekstrakurikuler",setup(ce){const M=t=>(Object.keys(t).forEach(e=>{t[e]&&typeof t[e]=="object"?(M(t[e]),Object.keys(t[e]).length===0&&delete t[e]):(t[e]===""||t[e]===null||t[e]===void 0)&&delete t[e]}),t);ae(async()=>{await q()});const d=u({ekskul:!1,rombel:!1,body:!1}),q=async()=>{d.value.ekskul=!0,await S({data:"ekstrakurikuler"}).then(()=>{d.value.ekskul=!1})},S=async t=>{const e={...t,...i.value};await U("/referensi/get-data",{method:"POST",body:e,onResponse({response:_}){var P,s;let o=_._data;if(t.data=="ekstrakurikuler"&&(k.value.ekstrakurikuler=o.data_ekskul,k.value.data_nilai=o.data_nilai),t.data=="reguler"&&(k.value.rombel=o.reguler,x.value=(P=o.ekstrakurikuler)==null?void 0:P.nama_ekskul,i.value.ekstrakurikuler_id=(s=o.ekstrakurikuler)==null?void 0:s.ekstrakurikuler_id),t.data=="kelas"){var y={},D={};o.siswa.forEach(f=>{var g,z;y[f.anggota_ekskul.anggota_rombel_id]=(g=f.anggota_ekskul.single_nilai_ekstrakurikuler)==null?void 0:g.nilai,D[f.anggota_ekskul.anggota_rombel_id]=(z=f.anggota_ekskul.single_nilai_ekstrakurikuler)==null?void 0:z.deskripsi_ekskul}),i.value.nilai_ekskul=y,i.value.deskripsi_ekskul=D,N.value=o.rombel,C.value=Object.keys(M(y)).length,k.value.siswa=o.siswa,T.value=!0}}})},i=u({semester_id:j.semester_id,user_id:v.user_id,guru_id:v.guru_id,sekolah_id:v.sekolah_id,rombongan_belajar_id:null,rombel_id_reguler:null,ekstrakurikuler_id:null,nilai_ekskul:{},deskripsi_ekskul:{}}),$=u({rombongan_belajar_id:null}),k=u({ekstrakurikuler:[],rombel:[],siswa:[],data_nilai:[]}),T=u(!1),V=u(!1),h=u(!1),b=u(!1),E=u(""),p=u({color:"",title:"",text:""}),x=u(),N=u(),C=u(!1),J=async()=>{V.value=!0;const e={...{opsi:"nilai-ekskul"},...i.value};await U("/penilaian/simpan",{method:"POST",body:e,onResponse({response:_}){let o=_._data;V.value=!1,o.errors?$.value=o.errors:(b.value=!0,p.value=o)}})},Q=async t=>{t&&(d.value.rombel=!0,await S({data:"reguler"}).then(()=>{d.value.rombel=!1}))},W=async t=>{t&&(C.value=!1,d.value.body=!0,await S({data:"kelas"}).then(()=>{d.value.body=!1}))},X=(t,e)=>{var _={1:"Sangat Aktif",2:"Aktif",3:"Cukup aktif",4:"Tidak aktif"};i.value.deskripsi_ekskul[e]=t?`${_[t]} dalam kegiatan ${x.value}`:""},Y=()=>{d.value={ekskul:!1,rombel:!1,body:!1},i.value={semester_id:j.semester_id,user_id:v.user_id,guru_id:v.guru_id,sekolah_id:v.sekolah_id,rombongan_belajar_id:null,rombel_id_reguler:null,ekstrakurikuler_id:null,nilai_ekskul:{},deskripsi_ekskul:{}},$.value={rombongan_belajar_id:null},k.value={ekstrakurikuler:[],rombel:[],siswa:[],data_nilai:[]},T.value=!1,V.value=!1,h.value=!1,b.value=!1,E.value="",p.value={color:"",title:"",text:""},x.value=void 0,N.value=void 0,C.value=!1,q()},Z=async()=>{h.value=!0,E.value=`Seluruh Nilai ${x.value} di Kelas ${N.value} akan dihapus!`,console.log("resetNilai")},ee=async()=>{const e={...{data:"nilai-ekskul"},...i.value};await U("/penilaian/destroy",{method:"POST",body:e,onResponse({response:_}){let o=_._data;b.value=!0,p.value=o}})};return(t,e)=>{const _=ue,o=ne,y=oe,D=ie,P=se;return c(),R("div",null,[a(de,{class:"mb-6"},{default:r(()=>[a(me,{class:"pb-4"},{default:r(()=>[a(ke,null,{default:r(()=>e[4]||(e[4]=[A("Nilai Ekstrakurikuler")])),_:1})]),_:1}),a(K),a(_e,{onSubmit:le(J,["prevent"])},{default:r(()=>[a(O,null,{default:r(()=>[a(w,null,{default:r(()=>[a(m,{cols:"12"},{default:r(()=>[a(w,{"no-gutters":""},{default:r(()=>[a(m,{cols:"12",md:"3",class:"d-flex align-items-center"},{default:r(()=>e[5]||(e[5]=[n("label",{class:"v-label text-body-2 text-high-emphasis",for:"semester_id"},"Tahun Pelajaran",-1)])),_:1}),a(m,{cols:"12",md:"9"},{default:r(()=>[a(_,{id:"semester_id",value:("$semester"in t?t.$semester:l(j)).nama,disabled:""},null,8,["value"])]),_:1})]),_:1})]),_:1}),a(m,{cols:"12"},{default:r(()=>[a(w,{"no-gutters":""},{default:r(()=>[a(m,{cols:"12",md:"3",class:"d-flex align-items-center"},{default:r(()=>e[6]||(e[6]=[n("label",{class:"v-label text-body-2 text-high-emphasis",for:"rombongan_belajar_id"},"Ekstrakurikuler",-1)])),_:1}),a(m,{cols:"12",md:"9"},{default:r(()=>[a(o,{id:"rombongan_belajar_id",modelValue:l(i).rombongan_belajar_id,"onUpdate:modelValue":[e[0]||(e[0]=s=>l(i).rombongan_belajar_id=s),Q],placeholder:"== Pilih Ekstrakurikuler ==",items:l(k).ekstrakurikuler,clearable:"","clear-icon":"tabler-x","item-value":"rombongan_belajar_id","item-title":"nama_ekskul","error-messages":l($).rombongan_belajar_id,loading:l(d).ekskul,disabled:l(d).ekskul},null,8,["modelValue","items","error-messages","loading","disabled"])]),_:1})]),_:1})]),_:1}),a(m,{cols:"12"},{default:r(()=>[a(w,{"no-gutters":""},{default:r(()=>[a(m,{cols:"12",md:"3",class:"d-flex align-items-center"},{default:r(()=>e[7]||(e[7]=[n("label",{class:"v-label text-body-2 text-high-emphasis",for:"rombel_id_reguler"},"Rombongan Belajar",-1)])),_:1}),a(m,{cols:"12",md:"9"},{default:r(()=>[a(o,{id:"rombel_id_reguler",modelValue:l(i).rombel_id_reguler,"onUpdate:modelValue":[e[1]||(e[1]=s=>l(i).rombel_id_reguler=s),W],placeholder:"== Pilih Rombongan Belajar ==",items:l(k).rombel,clearable:"","clear-icon":"tabler-x","item-value":"rombongan_belajar_id","item-title":"nama","error-messages":l($).rombel_id_reguler,loading:l(d).rombel,disabled:l(d).rombel},null,8,["modelValue","items","error-messages","loading","disabled"])]),_:1})]),_:1})]),_:1}),l(C)?(c(),B(m,{key:0,cols:"12"},{default:r(()=>[a(w,{"no-gutters":""},{default:r(()=>[a(m,{cols:"12",md:"3",class:"d-flex align-items-center"},{default:r(()=>e[8]||(e[8]=[n("label",{class:"v-label text-body-2 text-high-emphasis"},"Reset Nilai Ekstrakurikuler",-1)])),_:1}),a(m,{cols:"12",md:"9"},{default:r(()=>[a(I,{onClick:Z,color:"error",variant:"tonal"},{default:r(()=>[A(L(`Reset Nilai ${l(x)} kelas ${l(N)}`),1)]),_:1})]),_:1})]),_:1})]),_:1})):F("",!0)]),_:1})]),_:1}),l(d).body?(c(),B(O,{key:0,class:"text-center"},{default:r(()=>[a(te,{size:60,indeterminate:"",color:"error",class:"my-10"})]),_:1})):F("",!0),l(k).siswa.length?(c(),R(H,{key:1},[a(K),a(fe,{class:"text-no-wrap"},{default:r(()=>[e[9]||(e[9]=n("thead",null,[n("tr",null,[n("th",{class:"text-center",width:"20%"},"Nama Peserta Didik"),n("th",{class:"text-center",width:"10%"},"Kelas"),n("th",{class:"text-center",width:"20%"},"Predikat"),n("th",{class:"text-center",width:"50%"},"Deskripsi")])],-1)),n("tbody",null,[(c(!0),R(H,null,re(l(k).siswa,s=>{var f;return c(),R("tr",null,[n("td",null,[a(y,{item:s},null,8,["item"])]),n("td",ge,L((f=s.kelas)==null?void 0:f.nama),1),n("td",null,[a(D,{modelValue:l(i).nilai_ekskul[s.anggota_ekskul.anggota_rombel_id],"onUpdate:modelValue":[g=>l(i).nilai_ekskul[s.anggota_ekskul.anggota_rombel_id]=g,g=>X(l(i).nilai_ekskul[s.anggota_ekskul.anggota_rombel_id],s.anggota_ekskul.anggota_rombel_id)],placeholder:"== Pilih Predikat ==",items:l(k).data_nilai,clearable:"","clear-icon":"tabler-x"},null,8,["modelValue","onUpdate:modelValue","items"])]),n("td",null,[a(_,{modelValue:l(i).deskripsi_ekskul[s.anggota_ekskul.anggota_rombel_id],"onUpdate:modelValue":g=>l(i).deskripsi_ekskul[s.anggota_ekskul.anggota_rombel_id]=g},null,8,["modelValue","onUpdate:modelValue"])])])}),256))])]),_:1})],64)):F("",!0),a(K),l(T)?(c(),B(O,{key:2,class:"d-flex justify-end flex-wrap gap-3 pt-5 overflow-visible"},{default:r(()=>[a(I,{variant:"elevated",type:"submit",loading:l(V),disabled:l(V)},{default:r(()=>e[10]||(e[10]=[A(" Simpan ")])),_:1},8,["loading","disabled"])]),_:1})):F("",!0)]),_:1})]),_:1}),a(P,{isDialogVisible:l(h),"onUpdate:isDialogVisible":e[2]||(e[2]=s=>G(h)?h.value=s:null),isNotifVisible:l(b),"onUpdate:isNotifVisible":e[3]||(e[3]=s=>G(b)?b.value=s:null),"confirmation-question":"Apakah Anda yakin?","confirmation-text":l(E),"confirm-color":l(p).color,"confirm-title":l(p).title,"confirm-msg":l(p).text,onConfirm:ee,onClose:Y},null,8,["isDialogVisible","isNotifVisible","confirmation-text","confirm-color","confirm-title","confirm-msg"])])}}};export{Qe as default};
