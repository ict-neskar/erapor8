import{r as A}from"./validators-CXK_eVNV.js";import{r as n,G as K,c as Y,d as r,m as a,v as k,b as t,e as s,F as z,i as J,j as Q,a as W,o as h,H as c,f as y,t as _,ap as X,aa as Z,y as ee,a8 as u,aq as ae}from"./main-Ba5E192h.js";import{_ as te}from"./AppSelect-CZ3YcZJq.js";import{_ as se}from"./AppTextField-C7kSSQsT.js";import{u as D,a as oe,b as re}from"./misc-mask-light-nPG7z34c.js";import{a as L}from"./bg_login-oNs3_qaJ.js";import{l as N}from"./index-DWlaDcMd.js";import{u as le}from"./useAbility-D2IbbpQn.js";import{$ as ie}from"./api-DV11byyd.js";import{u as ne,c as ue}from"./createUrl-Dx8y2st0.js";import{V as q,a as d}from"./VRow-BwW1PfoV.js";import{V as B}from"./VImg-BD46ZmSh.js";import{V as me,b as w}from"./VCard-Av5KF9XZ.js";import{V as de}from"./VForm-D50gy_Td.js";import{V as pe}from"./VCheckbox-CAndNq2a.js";import"./VLabel-BtGXOH7p.js";import"./VSelect-A1cRPDhv.js";import"./forwardRefs-DWGaNmQL.js";import"./VList-BVPheIBU.js";import"./ssrBoot-SBUkp28z.js";import"./VAvatar-Cnp5qM21.js";import"./VDivider-xKTMVaVZ.js";import"./VOverlay-B8TKvbjl.js";import"./scopeId-FMl0qGlW.js";import"./VMenu-BZlhnuPC.js";import"./VSelectionControl-RkTZifSY.js";import"./VChip-BbopsKiC.js";import"./VSlideGroup-BqtQ8Q2P.js";import"./VField-D2ajgn9J.js";import"./index-BxkgbwWS.js";/* empty css              */const ce="/build/assets/auth-v2-login-illustration-bordered-dark-cDkPk8mY.png",fe="/build/assets/auth-v2-login-illustration-bordered-light-CIHqcIVA.png",ge={href:"javascript:void(0)"},he={class:"auth-logo d-flex align-center gap-x-3"},_e=["src"],Ve={class:"auth-title"},be={class:"position-relative bg-background w-100 me-0"},ve={class:"d-flex align-center justify-center w-100 h-100",style:{"padding-inline":"6.25rem"}},ke=["src"],ye={class:"text-h2 mb-1"},we=["src"],xe={class:"d-flex align-center flex-wrap justify-space-between my-6"},sa={__name:"login",setup(Se){const U=D(L,L,fe,ce,!0),j=D(re,oe),x=n(),l=n({email:"",password:"",semester_id:"",remember:!1}),S=J(),M=Q(),$=le(),V=n({email:void 0,password:void 0}),f=n(!1),T=n([]),I=n(""),F=()=>{N(`<strong>Selamat Datang ${I.value}</strong>
    <br>Anda telah berhasil masuk sebagai <strong>${T.value}</strong>. Sekarang Anda dapat mulai berselancar di Aplikasi e-Rapor SMK!`,{closeOnClick:!1,autoClose:5e3,position:N.POSITION.TOP_RIGHT,dangerouslyHTMLString:!0})},p=n(!1),O=async()=>{p.value=!0;try{const o=await ie("/auth/login",{method:"POST",body:{email:l.value.email,password:l.value.password,semester_id:l.value.semester_id},onResponseError({response:G}){V.value=G._data.errors,p.value=!1}}),{accessToken:e,userData:m,sekolah:v,semester:g,userAbility:i,roles:R}=o;I.value=m.name,u("userAbilityRules").value=i,$.update(i),u("userData").value=m,u("accessToken").value=e,u("sekolah").value=v,u("semester").value=g,u("roles").value=R,u("profilePhotoPath").value=m.profile_photo_path,T.value=R.join(", "),p.value=!1,await ae(()=>{M.replace(S.query.to?String(S.query.to):"/").then(()=>{F()})})}catch(o){console.error(o)}},E=()=>{var o;(o=x.value)==null||o.validate().then(({valid:e})=>{e&&O()})},C=n(!1),P=n([]),b=n();K(async()=>{await H()});const H=async()=>{try{let e=(await ne(ue("/auth/semester"))).data.value;P.value=e.semester,l.value.semester_id=e.semester_id,C.value=e.allowRegister,b.value=e.bg_login}catch(o){console.error(o)}};return(o,e)=>{const m=se,v=te,g=W("RouterLink");return h(),Y(z,null,[r("a",ge,[r("div",he,[r("img",{src:a(c).app.logo,height:"24"},null,8,_e),r("h1",Ve,k(a(c).app.title),1)])]),t(q,{"no-gutters":"",class:"auth-wrapper bg-surface"},{default:s(()=>[t(d,{md:"8",class:"d-none d-md-flex"},{default:s(()=>[r("div",be,[r("div",ve,[a(b)?(h(),y(B,{key:0,"max-width":"613",src:a(b),class:"auth-illustration mt-16 mb-2"},null,8,["src"])):(h(),y(B,{key:1,"max-width":"613",src:a(U),class:"auth-illustration mt-16 mb-2"},null,8,["src"]))]),r("img",{class:"auth-footer-mask flip-in-rtl",src:a(j),alt:"auth-footer-mask",height:"280",width:"100"},null,8,ke)])]),_:1}),t(d,{cols:"12",md:"4",class:"auth-card-v2 d-flex align-center justify-center"},{default:s(()=>[t(me,{flat:"","max-width":500,class:"mt-sm-0 pa-6"},{default:s(()=>[t(w,{class:"text-center"},{default:s(()=>[r("h1",ye,[r("img",{src:a(c).app.logo,height:"28"},null,8,we),_(" "+k(a(c).app.title),1)]),r("p",null,"Versi "+k(a(c).app.version),1),e[5]||(e[5]=r("p",{class:"mb-0"},"Silahkan login untuk dapat mengakses Aplikasi",-1))]),_:1}),t(w,null,{default:s(()=>[t(de,{ref_key:"refVForm",ref:x,onSubmit:X(E,["prevent"])},{default:s(()=>[t(q,null,{default:s(()=>[t(d,{cols:"12"},{default:s(()=>[t(m,{modelValue:a(l).email,"onUpdate:modelValue":e[0]||(e[0]=i=>a(l).email=i),"error-messages":a(V).email,autofocus:"",label:"Email/NUPTK/NISN",placeholder:"Email/NUPTK/NISN",rules:["requiredValidator"in o?o.requiredValidator:a(A)]},null,8,["modelValue","error-messages","rules"])]),_:1}),t(d,{cols:"12"},{default:s(()=>[t(m,{modelValue:a(l).password,"onUpdate:modelValue":e[1]||(e[1]=i=>a(l).password=i),"error-messages":a(V).password,label:"Password",placeholder:"············",type:a(f)?"text":"password",autocomplete:"password","append-inner-icon":a(f)?"tabler-eye-off":"tabler-eye","onClick:appendInner":e[2]||(e[2]=i=>f.value=!a(f)),rules:["requiredValidator"in o?o.requiredValidator:a(A)]},null,8,["modelValue","error-messages","type","append-inner-icon","rules"])]),_:1}),t(d,{cols:"12"},{default:s(()=>[t(v,{items:a(P),"item-title":"nama","item-value":"semester_id",label:"Tahun Pelajaran",modelValue:a(l).semester_id,"onUpdate:modelValue":e[3]||(e[3]=i=>a(l).semester_id=i),placeholder:"Select Item"},null,8,["items","modelValue"]),r("div",xe,[t(pe,{modelValue:a(l).remember,"onUpdate:modelValue":e[4]||(e[4]=i=>a(l).remember=i),label:"Simpan Login"},null,8,["modelValue"]),t(g,{class:"text-primary",to:{name:"lupa-password"}},{default:s(()=>e[6]||(e[6]=[_(" Lupa Password? ")])),_:1})]),t(Z,{block:"",type:"submit",loading:a(p),disabled:a(p)},{default:s(()=>e[7]||(e[7]=[_(" Login ")])),_:1},8,["loading","disabled"])]),_:1}),a(C)?(h(),y(d,{key:0,cols:"12",class:"text-center"},{default:s(()=>[e[9]||(e[9]=r("span",null,"Pengguna Baru?",-1)),t(g,{class:"text-primary ms-1",to:{name:"register"}},{default:s(()=>e[8]||(e[8]=[_(" Register Disini ")])),_:1})]),_:1})):ee("",!0)]),_:1})]),_:1},512)]),_:1}),t(w)]),_:1})]),_:1})]),_:1})],64)}}};export{sa as default};
