import{a as N,d as V,t as z}from"./mixins-B3UHDqO3.js";import{_ as M}from"./ProfileSiswa-Oaws0S5b.js";import{_ as E}from"./AppSelect-Cd9HFhsW.js";import{_ as O}from"./AppTextField-BTba3qr2.js";import{$ as q}from"./api-KcMzrp4S.js";import{V as G,c as H,a as J,b as R}from"./VCard-2_qp3Vvc.js";import{V as S}from"./VDivider-DOshNxjC.js";import{V as y,a as p}from"./VRow-90jB0EEo.js";import{r as j,f as $,e as r,o as l,b as a,t as D,d as s,m as i,aa as Q,y as K,c as n,am as W,F as _,h,v as f}from"./main-BLR2YNPc.js";import{V as X}from"./VTable-DC5yuf29.js";import"./VImg-C5whf5xb.js";import"./VAvatar-BZJqyIb4.js";import"./VLabel-QfOIbUGb.js";import"./VSelect-DTXlVIl9.js";import"./forwardRefs-DWGaNmQL.js";import"./VList-DhBNZzgQ.js";import"./ssrBoot-Cfszeb4X.js";import"./VOverlay-CiGj4qAf.js";import"./scopeId-LkyyTvVZ.js";import"./VMenu-IOUSI9rL.js";import"./VSelectionControl-Cco01M7z.js";import"./VChip-CM7CTnjc.js";import"./VSlideGroup-CtUoo4jB.js";/* empty css                   */import"./VField-BZSU_Yhz.js";import"./index-BxkgbwWS.js";/* empty css              */const Y={key:0},Z={class:"text-center"},ee={class:"text-center",rowspan:"3"},ae={key:0,class:"text-center"},te={key:1,class:"text-center"},le={key:0,class:"text-center"},se={class:"text-center"},re={class:"text-center"},ne={class:"text-center"},oe={key:1,class:"text-center"},ie={class:"text-center"},de={class:"text-center"},me={class:"text-center"},Fe={__name:"unduh-legger",setup(ue){const d=j({tingkat:null,rombongan_belajar_id:null,semester_id:N.semester_id,user_id:V.user_id,guru_id:V.guru_id,sekolah_id:V.sekolah_id,merdeka:!1,is_ppa:!1}),m=j({rombel:[],siswa:[],pembelajaran:[]}),c=j({rombel:!1,body:!1}),P=async t=>{const e={...t,...d.value};await q("/monitoring/get-data",{method:"POST",body:e,onResponse({response:g}){let u=g._data;t.data=="rombel"&&(m.value.rombel=u),t.data=="legger"&&(m.value.siswa=u.data_siswa,m.value.pembelajaran=u.pembelajaran,d.value.merdeka=u.merdeka,d.value.is_ppa=u.is_ppa)}})},L=async t=>{d.value.rombongan_belajar_id=null,m.value.rombel=[],m.value.siswa=[],t&&(c.value.rombel=!0,await P({data:"rombel"}).then(()=>{c.value.rombel=!1}))},U=async t=>{m.value.siswa=[],t&&(c.value.body=!0,await P({data:"legger"}).then(()=>{c.value.body=!1}))},A=()=>{if(d.value.rombongan_belajar_id){if(d.value.merdeka||d.value.is_ppa)var t=`/downloads/leger-nilai-kurmer/${d.value.rombongan_belajar_id}/${d.value.sekolah_id}/${d.value.semester_id}`;else var t=`/downloads/leger-nilai-rapor/${d.value.rombongan_belajar_id}`;window.open(t,"_blank").focus()}},x=(t,e)=>{const g=t.find(u=>u.anggota_rombel_id===e);return(g==null?void 0:g.nilai)??"-"},T=(t,e)=>{const g=t.find(u=>u.anggota_rombel_id===e.anggota_rombel_id);return(g==null?void 0:g.nilai)??"-"},F=(t,e,g,u)=>{t=t*w(g),e=e*w(u);var k=(t+e)/100;return isNaN(k)?k="-":k=Math.ceil(k),k},w=t=>t??50;return(t,e)=>{const g=O,u=E,k=M;return l(),$(G,{class:"mb-6"},{default:r(()=>[a(J,{class:"pb-4"},{default:r(()=>[a(H,null,{default:r(()=>e[2]||(e[2]=[D("Monitoring Â» Unduh Legger")])),_:1})]),_:1}),a(S),a(R,null,{default:r(()=>[a(y,null,{default:r(()=>[a(p,{cols:"12"},{default:r(()=>[a(y,{"no-gutters":""},{default:r(()=>[a(p,{cols:"12",md:"3",class:"d-flex align-items-center"},{default:r(()=>e[3]||(e[3]=[s("label",{class:"v-label text-body-2 text-high-emphasis",for:"semester_id"},"Tahun Pelajaran",-1)])),_:1}),a(p,{cols:"12",md:"9"},{default:r(()=>[a(g,{id:"semester_id",value:("$semester"in t?t.$semester:i(N)).nama,disabled:""},null,8,["value"])]),_:1})]),_:1})]),_:1}),a(p,{cols:"12"},{default:r(()=>[a(y,{"no-gutters":""},{default:r(()=>[a(p,{cols:"12",md:"3",class:"d-flex align-items-center"},{default:r(()=>e[4]||(e[4]=[s("label",{class:"v-label text-body-2 text-high-emphasis",for:"tingkat"},"Tingkat Kelas",-1)])),_:1}),a(p,{cols:"12",md:"9"},{default:r(()=>[a(u,{modelValue:i(d).tingkat,"onUpdate:modelValue":[e[0]||(e[0]=o=>i(d).tingkat=o),L],placeholder:"== Pilih Tingkat kelas ==",items:"tingkatKelas"in t?t.tingkatKelas:i(z),clearable:"","clear-icon":"tabler-x"},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1}),a(p,{cols:"12"},{default:r(()=>[a(y,{"no-gutters":""},{default:r(()=>[a(p,{cols:"12",md:"3",class:"d-flex align-items-center"},{default:r(()=>e[5]||(e[5]=[s("label",{class:"v-label text-body-2 text-high-emphasis",for:"rombonganBelajarId"},"Rombongan Belajar",-1)])),_:1}),a(p,{cols:"12",md:"9"},{default:r(()=>[a(u,{modelValue:i(d).rombongan_belajar_id,"onUpdate:modelValue":[e[1]||(e[1]=o=>i(d).rombongan_belajar_id=o),U],placeholder:"== Pilih Rombongan Belajar == ",items:i(m).rombel,clearable:"","clear-icon":"tabler-x","item-value":"rombongan_belajar_id","item-title":"nama",loading:i(c).rombel,disabled:i(c).rombel},null,8,["modelValue","items","loading","disabled"])]),_:1})]),_:1})]),_:1}),i(m).siswa.length?(l(),$(p,{key:0,cols:"12"},{default:r(()=>[a(y,{"no-gutters":""},{default:r(()=>[a(p,{cols:"12",md:"3",class:"d-flex align-items-center"},{default:r(()=>e[6]||(e[6]=[s("label",{class:"v-label text-body-2 text-high-emphasis"},"Unduh Legger",-1)])),_:1}),a(p,{cols:"12",md:"9"},{default:r(()=>[a(Q,{"prepend-icon":"tabler-file-type-xls",onClick:A},{default:r(()=>e[7]||(e[7]=[D(" Unduh Legger ")])),_:1})]),_:1})]),_:1})]),_:1})):K("",!0)]),_:1})]),_:1}),i(c).body?(l(),n(_,{key:0},[a(S),a(R,{class:"text-center"},{default:r(()=>[a(W,{size:60,indeterminate:"",color:"error",class:"my-10"})]),_:1})],64)):(l(),n(_,{key:1},[i(m).siswa.length?(l(),$(X,{key:0,class:"text-no-wrap"},{default:r(()=>[s("thead",null,[i(d).merdeka||i(d).is_ppa?(l(),n("tr",Y,[e[8]||(e[8]=s("th",{class:"text-center"},"Peserta Didik",-1)),(l(!0),n(_,null,h(i(m).pembelajaran,(o,v)=>(l(),n("th",Z,f(o.nama_mata_pelajaran),1))),256)),e[9]||(e[9]=s("th",{class:"text-center align-middle",rowspan:"3"},"S",-1)),e[10]||(e[10]=s("th",{class:"text-center align-middle",rowspan:"3"},"I",-1)),e[11]||(e[11]=s("th",{class:"text-center align-middle",rowspan:"3"},"A",-1))])):(l(),n(_,{key:1},[e[15]||(e[15]=s("th",{class:"text-center"},"Peserta Didik",-1)),(l(!0),n(_,null,h(i(m).pembelajaran,(o,v)=>(l(),n("th",ee,f(o.nama_mata_pelajaran),1))),256)),e[16]||(e[16]=s("th",{class:"text-center align-middle",rowspan:"3"},"S",-1)),e[17]||(e[17]=s("th",{class:"text-center align-middle",rowspan:"3"},"I",-1)),e[18]||(e[18]=s("th",{class:"text-center align-middle",rowspan:"3"},"A",-1)),s("tr",null,[(l(!0),n(_,null,h(i(m).pembelajaran,(o,v)=>(l(),n(_,null,[e[12]||(e[12]=s("th",{class:"text-center"},"P",-1)),e[13]||(e[13]=s("th",{class:"text-center"},"K",-1)),e[14]||(e[14]=s("th",{class:"text-center"},"R",-1))],64))),256))])],64))]),s("tbody",null,[(l(!0),n(_,null,h(i(m).siswa,o=>{var v,C,B;return l(),n("tr",null,[s("td",null,[a(k,{item:o},null,8,["item"])]),i(d).merdeka?(l(!0),n(_,{key:0},h(i(m).pembelajaran,(b,I)=>(l(),n(_,null,[b.rombongan_belajar.jenis_rombel=="1"?(l(),n("td",ae,f(x(b.all_nilai_akhir_kurmer,o.anggota_rombel.anggota_rombel_id)),1)):(l(),n("td",te,f(T(b.all_nilai_akhir_kurmer,o.anggota_pilihan)),1))],64))),256)):(l(!0),n(_,{key:1},h(t.data_pembelajaran,(b,I)=>(l(),n(_,null,[b.rombongan_belajar.jenis_rombel=="1"?(l(),n(_,{key:0},[t.is_ppa?(l(),n("td",le,f(x(b.all_nilai_akhir_pengetahuan,o.anggota_rombel.anggota_rombel_id)),1)):(l(),n(_,{key:1},[s("td",se,f(x(b.all_nilai_akhir_pengetahuan,o.anggota_rombel.anggota_rombel_id)),1),s("td",re,f(x(b.all_nilai_akhir_keterampilan,o.anggota_rombel.anggota_rombel_id)),1),s("td",ne,f(F(x(b.all_nilai_akhir_pengetahuan,o.anggota_rombel.anggota_rombel_id),x(b.all_nilai_akhir_keterampilan,o.anggota_rombel.anggota_rombel_id),w(b.rasio_p),w(b.rasio_k))),1)],64))],64)):(l(),n("td",oe,f(T(b.all_nilai_akhir_kurmer,o.anggota_pilihan)),1))],64))),256)),s("td",ie,f(((v=o.anggota_rombel.absensi)==null?void 0:v.sakit)??"-"),1),s("td",de,f(((C=o.anggota_rombel.absensi)==null?void 0:C.izin)??"-"),1),s("td",me,f(((B=o.anggota_rombel.absensi)==null?void 0:B.alpa)??"-"),1)])}),256))])]),_:1})):K("",!0)],64))]),_:1})}}};export{Fe as default};
