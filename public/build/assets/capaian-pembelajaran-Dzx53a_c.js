import{d as u,a as c,t as z}from"./mixins-B3UHDqO3.js";import{_ as ua}from"./ConfirmDialog-FUvEvqZ3.js";import{_ as pa}from"./DefaultDialog-Cl7rm6nB.js";import{_ as _a}from"./AppTextarea-CYZiotoS.js";import{_ as fa}from"./TablePagination-BGwk3hCt.js";import{_ as ga}from"./AppTextField-BTba3qr2.js";import{_ as ba}from"./AppSelect-Cd9HFhsW.js";import{u as ca,c as va}from"./createUrl-Ck_LlMGD.js";import{$ as y}from"./api-KcMzrp4S.js";import{V as ka,a as ja,c as Va,b as E}from"./VCard-2_qp3Vvc.js";import{V as q}from"./VDivider-DOshNxjC.js";import{V as v,a as r}from"./VRow-90jB0EEo.js";import{V as ya}from"./VSpacer-C30FMztp.js";import{r as m,G as xa,w as I,c as N,b as l,e as t,m as e,a2 as B,o as j,t as P,d as g,aa as G,v as Da,f as C,$ as L}from"./main-BLR2YNPc.js";import{V as ha}from"./VDataTableServer-B7CylN9o.js";import{V as H}from"./VChip-CM7CTnjc.js";import{V as Pa}from"./VTooltip-DDHSUGx9.js";import"./VDialog-Hzphy_2H.js";import"./VOverlay-CiGj4qAf.js";import"./forwardRefs-DWGaNmQL.js";import"./scopeId-LkyyTvVZ.js";import"./VImg-C5whf5xb.js";import"./DialogCloseBtn-CBIlXrXd.js";import"./VLabel-QfOIbUGb.js";import"./VTextarea-CXGUfcsA.js";/* empty css                   */import"./VField-BZSU_Yhz.js";import"./VSelect-DTXlVIl9.js";import"./VList-DhBNZzgQ.js";import"./ssrBoot-Cfszeb4X.js";import"./VAvatar-BZJqyIb4.js";import"./VMenu-IOUSI9rL.js";import"./VSelectionControl-Cco01M7z.js";import"./index-BxkgbwWS.js";/* empty css              */import"./VTable-DC5yuf29.js";import"./filter-95PybUkX.js";import"./VSlideGroup-CtUoo4jB.js";const Ta={class:"me-3 d-flex gap-3"},wa={class:"app-user-search-filter d-flex align-center flex-wrap gap-4"},Ca={style:{"inline-size":"15.625rem"}},Ra={key:0},Ua={key:1},ve={__name:"capaian-pembelajaran",setup(Fa){const s=m({tingkat:null,rombongan_belajar_id:null,pembelajaran_id:null,page:1,itemsPerPage:10,searchQuery:"",sortby:"updated_at",sortbydesc:"DESC"}),J=[{key:"mata_pelajaran_id",title:"Mata Pelajaran"},{key:"fase",title:"fase",align:"center"},{key:"elemen",title:"elemen",align:"center",sortable:!1},{key:"deskripsi",title:"Deskripsi"},{key:"tp_count",title:"jml tp",align:"center",sortable:!1},{key:"status",title:"Status",sortable:!1,align:"center"},{key:"actions",title:"Aksi",align:"center",sortable:!1,nowrap:!0}],M=m([]),R=m(0),U=m([]),T=m([]),F=m(!1);xa(async()=>{await S()}),I(s,async()=>{await S()},{deep:!0}),I(()=>s.value.searchQuery,()=>{s.value.page=1});const W=o=>{var a,i;s.value.sortby=(a=o[0])==null?void 0:a.key,s.value.sortbydesc=(i=o[0])==null?void 0:i.order},S=async()=>{F.value=!0;try{let a=(await ca(va("/referensi/capaian-pembelajaran",{query:{user_id:u.user_id,guru_id:u.guru_id,sekolah_id:u.sekolah_id,semester_id:c.semester_id,periode_aktif:c.nama,tingkat:s.value.tingkat,rombongan_belajar_id:s.value.rombongan_belajar_id,q:s.value.searchQuery,page:s.value.page,per_page:s.value.itemsPerPage,sortby:s.value.sortby,sortbydesc:s.value.sortbydesc}}))).data;M.value=a.value.data.data,R.value=a.value.data.total}catch(o){console.error(o)}finally{F.value=!1}},p=m({tingkat:null,rombongan_belajar_id:null,pembelajaran_id:null}),_=m(!1),f=m(!1),X=async o=>{_.value=!0,U.value=[],T.value=[],p.value.rombongan_belajar_id=null,p.value.pembelajaran_id=null,s.value.tingkat=o,o?await y("/referensi/get-data",{method:"POST",body:{data:"rombel",add_cp:1,tingkat:o,user_id:u.user_id,guru_id:u.guru_id,sekolah_id:u.sekolah_id,semester_id:c.semester_id,periode_aktif:c.nama},onResponse({response:a}){let i=a._data;_.value=!1,U.value=i}}):_.value=!1},Y=async o=>{T.value=[],f.value=!0,p.value.pembelajaran_id=null,s.value.rombongan_belajar_id=o,o?await y("/referensi/get-data",{method:"POST",body:{data:"mapel",rombongan_belajar_id:o,user_id:u.user_id,guru_id:u.guru_id,sekolah_id:u.sekolah_id,semester_id:c.semester_id,periode_aktif:c.nama},onResponse({response:a}){let i=a._data;f.value=!1,T.value=i.mapel}}):f.value=!1},Z=async o=>{s.value.pembelajaran_id=o},$={semester_id:c.semester_id,user_id:u.user_id,guru_id:u.guru_id,sekolah_id:u.sekolah_id},d=m({tingkat:null,rombongan_belajar_id:null,mata_pelajaran_id:null,elemen:null,capaian_pembelajaran:null}),b=m({tingkat:null,rombongan_belajar_id:null,mata_pelajaran_id:null,elemen:null,capaian_pembelajaran:null}),K=m([]),O=m([]),V=m(!1),aa=()=>{V.value=!0},w=m(!1),x=m(!1),D=m({color:null,title:null,text:null}),Q=m(),A=m({}),ea=async(o,a)=>{A.value={cp_id:o,aktif:a},w.value=!0,Q.value=a?"Tindakan ini akan menonaktifkan data Capaian Pembelajaran!":"Tindakan ini akan mengaktifkan data Capaian Pembelajaran!"},la=async o=>{o&&await y("/referensi/capaian-pembelajaran/update",{method:"POST",body:A.value,onResponse({response:a}){let i=a._data;A.value=null,V.value=!1,x.value=!0,D.value=i}})},ta=async()=>{await S()},na=async()=>{const o={...$,...d.value};await y("/referensi/capaian-pembelajaran/save",{method:"POST",body:o,onResponse({response:a}){let i=a._data;i.errors?b.value=i.errors:(V.value=!1,x.value=!0,D.value=i,d.value={tingkat:null,rombongan_belajar_id:null,mata_pelajaran_id:null,elemen:null,capaian_pembelajaran:null},b.value={tingkat:null,rombongan_belajar_id:null,mata_pelajaran_id:null,elemen:null,capaian_pembelajaran:null})}})},oa=async o=>{o&&await na()},ia=async o=>{if(o){_.value=!0;const i={...{data:"rombel"},...$,...d.value};await y("/referensi/get-data",{method:"POST",body:i,onResponse({response:k}){let h=k._data;K.value=h,_.value=!1}})}},sa=async o=>{if(o){f.value=!0;const i={...{data:"mapel"},...$,...d.value};await y("/referensi/get-data",{method:"POST",body:i,onResponse({response:k}){let h=k._data;O.value=h.mapel,f.value=!1}})}};return(o,a)=>{const i=ba,k=ga,h=fa,ra=_a,ma=pa,da=ua;return j(),N("div",null,[l(ka,{class:"mb-6"},{default:t(()=>[l(ja,{class:"pb-4"},{default:t(()=>[l(Va,null,{default:t(()=>a[14]||(a[14]=[P("Referensi Capaian Pembelajaran")])),_:1})]),_:1}),l(q),l(E,null,{default:t(()=>[l(v,null,{default:t(()=>[l(r,{cols:"12",sm:"4"},{default:t(()=>[l(i,{modelValue:e(p).tingkat,"onUpdate:modelValue":[a[0]||(a[0]=n=>e(p).tingkat=n),X],placeholder:"== Filter Tingkat ==",items:"tingkatKelas"in o?o.tingkatKelas:e(z),clearable:"","clear-icon":"tabler-x"},null,8,["modelValue","items"])]),_:1}),l(r,{cols:"12",sm:"4"},{default:t(()=>[l(i,{modelValue:e(p).rombongan_belajar_id,"onUpdate:modelValue":[a[1]||(a[1]=n=>e(p).rombongan_belajar_id=n),Y],placeholder:"== Filter Rombel == ",items:e(U),clearable:"","clear-icon":"tabler-x","item-value":"rombongan_belajar_id","item-title":"nama",loading:e(_),disabled:e(_)},null,8,["modelValue","items","loading","disabled"])]),_:1}),l(r,{cols:"12",sm:"4"},{default:t(()=>[l(i,{modelValue:e(p).pembelajaran_id,"onUpdate:modelValue":[a[2]||(a[2]=n=>e(p).pembelajaran_id=n),Z],placeholder:"== Filter Mapel ==",items:e(T),clearable:"","clear-icon":"tabler-x","item-value":"pembelajaran_id","item-title":"nama_mata_pelajaran",loading:e(f),disabled:e(f)},null,8,["modelValue","items","loading","disabled"])]),_:1})]),_:1})]),_:1}),l(E,{class:"d-flex flex-wrap gap-4"},{default:t(()=>[g("div",Ta,[l(i,{modelValue:e(s).itemsPerPage,"onUpdate:modelValue":a[3]||(a[3]=n=>e(s).itemsPerPage=n),items:[{value:10,title:"10"},{value:25,title:"25"},{value:50,title:"50"},{value:100,title:"100"}],style:{"inline-size":"6.25rem"}},null,8,["modelValue"])]),l(ya),g("div",wa,[g("div",Ca,[l(k,{modelValue:e(s).searchQuery,"onUpdate:modelValue":a[4]||(a[4]=n=>e(s).searchQuery=n),placeholder:"Cari Data"},null,8,["modelValue"])]),l(G,{"prepend-icon":"tabler-plus",onClick:aa},{default:t(()=>a[15]||(a[15]=[P(" Tambah Data ")])),_:1})])]),_:1}),l(q),l(ha,{items:e(M),"server-items-length":e(R),headers:J,options:e(s),loading:e(F),"loading-text":"Loading...","onUpdate:sortBy":W},{"item.mata_pelajaran_id":t(({item:n})=>[P(Da(n.mata_pelajaran.nama),1)]),"item.status":t(({item:n})=>[n.aktif?(j(),C(H,{key:0,size:"x-small",color:"success",variant:"elevated"},{default:t(()=>a[16]||(a[16]=[P(" Aktif ")])),_:1})):(j(),C(H,{key:1,size:"x-small",color:"error",variant:"elevated"},{default:t(()=>a[17]||(a[17]=[P(" Non Aktif ")])),_:1}))]),"item.actions":t(({item:n})=>[l(G,{icon:n.aktif?"tabler-x":"tabler-check",color:n.aktif?"error":"success",onClick:Sa=>ea(n.cp_id,n.aktif)},{default:t(()=>[n.aktif?(j(),C(L,{key:0,icon:"tabler-x"})):(j(),C(L,{key:1,icon:"tabler-check"})),l(Pa,{location:"top",activator:"parent",transition:"scale-transition"},{default:t(()=>[n.aktif?(j(),N("span",Ra,"Non Aktifkan")):(j(),N("span",Ua,"Aktifkan"))]),_:2},1024)]),_:2},1032,["icon","color","onClick"])]),bottom:t(()=>[l(h,{page:e(s).page,"onUpdate:page":a[5]||(a[5]=n=>e(s).page=n),"items-per-page":e(s).itemsPerPage,"total-items":e(R)},null,8,["page","items-per-page","total-items"])]),_:1},8,["items","server-items-length","options","loading"])]),_:1}),l(ma,{isDialogVisible:e(V),"onUpdate:isDialogVisible":a[11]||(a[11]=n=>B(V)?V.value=n:null),"dialog-title":"Tambah Data Capaian Pembelajaran",errors:e(b),onConfirm:oa},{content:t(()=>[l(v,null,{default:t(()=>[l(r,{cols:"12"},{default:t(()=>[l(v,{"no-gutters":""},{default:t(()=>[l(r,{cols:"12",md:"3",class:"d-flex align-items-center"},{default:t(()=>a[18]||(a[18]=[g("label",{class:"v-label text-body-2 text-high-emphasis",for:"semester_id"},"Tahun Pelajaran",-1)])),_:1}),l(r,{cols:"12",md:"9"},{default:t(()=>[l(k,{id:"semester_id",value:("$semester"in o?o.$semester:e(c)).nama,disabled:""},null,8,["value"])]),_:1})]),_:1})]),_:1}),l(r,{cols:"12"},{default:t(()=>[l(v,{"no-gutters":""},{default:t(()=>[l(r,{cols:"12",md:"3",class:"d-flex align-items-center"},{default:t(()=>a[19]||(a[19]=[g("label",{class:"v-label text-body-2 text-high-emphasis",for:"tingkat"},"Tingkat Kelas",-1)])),_:1}),l(r,{cols:"12",md:"9"},{default:t(()=>[l(i,{modelValue:e(d).tingkat,"onUpdate:modelValue":[a[6]||(a[6]=n=>e(d).tingkat=n),ia],placeholder:"== Pilih Tingkat kelas ==",items:"tingkatKelas"in o?o.tingkatKelas:e(z),clearable:"","clear-icon":"tabler-x","error-messages":e(b).tingkat},null,8,["modelValue","items","error-messages"])]),_:1})]),_:1})]),_:1}),l(r,{cols:"12"},{default:t(()=>[l(v,{"no-gutters":""},{default:t(()=>[l(r,{cols:"12",md:"3",class:"d-flex align-items-center"},{default:t(()=>a[20]||(a[20]=[g("label",{class:"v-label text-body-2 text-high-emphasis",for:"rombongan_belajar_id"},"Rombongan Belajar",-1)])),_:1}),l(r,{cols:"12",md:"9"},{default:t(()=>[l(i,{modelValue:e(d).rombongan_belajar_id,"onUpdate:modelValue":[a[7]||(a[7]=n=>e(d).rombongan_belajar_id=n),sa],placeholder:"== Pilih Rombongan Belajar == ",items:e(K),clearable:"","clear-icon":"tabler-x","item-value":"rombongan_belajar_id","item-title":"nama",loading:e(_),disabled:e(_),"error-messages":e(b).rombongan_belajar_id},null,8,["modelValue","items","loading","disabled","error-messages"])]),_:1})]),_:1})]),_:1}),l(r,{cols:"12"},{default:t(()=>[l(v,{"no-gutters":""},{default:t(()=>[l(r,{cols:"12",md:"3",class:"d-flex align-items-center"},{default:t(()=>a[21]||(a[21]=[g("label",{class:"v-label text-body-2 text-high-emphasis",for:"mata_pelajaran_id"},"Mata Pelajaran",-1)])),_:1}),l(r,{cols:"12",md:"9"},{default:t(()=>[l(i,{modelValue:e(d).mata_pelajaran_id,"onUpdate:modelValue":a[8]||(a[8]=n=>e(d).mata_pelajaran_id=n),placeholder:"== Pilih Mata Pelajaran ==",items:e(O),clearable:"","clear-icon":"tabler-x","item-value":"mata_pelajaran_id","item-title":"nama_mata_pelajaran",loading:e(f),disabled:e(f),"error-messages":e(b).mata_pelajaran_id},null,8,["modelValue","items","loading","disabled","error-messages"])]),_:1})]),_:1})]),_:1}),l(r,{cols:"12"},{default:t(()=>[l(v,{"no-gutters":""},{default:t(()=>[l(r,{cols:"12",md:"3",class:"d-flex align-items-center"},{default:t(()=>a[22]||(a[22]=[g("label",{class:"v-label text-body-2 text-high-emphasis",for:"elemen"},"Elemen",-1)])),_:1}),l(r,{cols:"12",md:"9"},{default:t(()=>[l(k,{id:"elemen",modelValue:e(d).elemen,"onUpdate:modelValue":a[9]||(a[9]=n=>e(d).elemen=n),placeholder:"Elemen","persistent-placeholder":"","error-messages":e(b).elemen},null,8,["modelValue","error-messages"])]),_:1})]),_:1})]),_:1}),l(r,{cols:"12"},{default:t(()=>[l(v,{"no-gutters":""},{default:t(()=>[l(r,{cols:"12",md:"3",class:"d-flex align-items-center"},{default:t(()=>a[23]||(a[23]=[g("label",{class:"v-label text-body-2 text-high-emphasis",for:"capaian_pembelajaran"},"Deskripsi Capaian Pembelajaran",-1)])),_:1}),l(r,{cols:"12",md:"9"},{default:t(()=>[l(ra,{modelValue:e(d).capaian_pembelajaran,"onUpdate:modelValue":a[10]||(a[10]=n=>e(d).capaian_pembelajaran=n),placeholder:"Deskripsi Capaian Pembelajaran","auto-grow":"","error-messages":e(b).capaian_pembelajaran},null,8,["modelValue","error-messages"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["isDialogVisible","errors"]),l(da,{isDialogVisible:e(w),"onUpdate:isDialogVisible":a[12]||(a[12]=n=>B(w)?w.value=n:null),isNotifVisible:e(x),"onUpdate:isNotifVisible":a[13]||(a[13]=n=>B(x)?x.value=n:null),"confirmation-question":"Apakah Anda yakin?","confirmation-text":e(Q),"confirm-color":e(D).color,"confirm-title":e(D).title,"confirm-msg":e(D).text,onConfirm:la,onClose:ta},null,8,["isDialogVisible","isNotifVisible","confirmation-text","confirm-color","confirm-title","confirm-msg"])])}}};export{ve as default};
