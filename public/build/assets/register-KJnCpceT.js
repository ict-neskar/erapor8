import{r as b,e as F}from"./validators-CXK_eVNV.js";import{aQ as L,r as p,aq as R,c as E,b as s,e as t,m as e,f as T,F as O,j as $,a as U,o as k,d as l,H as f,v,am as H,t as w,ap as G,aa as z}from"./main-BLR2YNPc.js";import{_ as K}from"./AppTextField-BTba3qr2.js";import{a as q}from"./bg_login-oNs3_qaJ.js";import{u as B,a as Q,b as Z}from"./misc-mask-light-BpKDCja0.js";import{l as S}from"./index-D8gvXGwE.js";import{u as J,c as W}from"./createUrl-Ck_LlMGD.js";import{$ as X}from"./api-KcMzrp4S.js";import{V as _,a as u}from"./VRow-90jB0EEo.js";import{V as Y}from"./VImg-C5whf5xb.js";import{V as ee,b as C}from"./VCard-2_qp3Vvc.js";import{V as ae}from"./VForm-BNrtY43f.js";import"./VLabel-QfOIbUGb.js";/* empty css                   */import"./VField-BZSU_Yhz.js";import"./forwardRefs-DWGaNmQL.js";import"./index-BxkgbwWS.js";/* empty css              */import"./VAvatar-BZJqyIb4.js";const se="/build/assets/auth-v2-register-illustration-bordered-dark-DATv6AkE.png",re="/build/assets/auth-v2-register-illustration-bordered-light-efkpyIZr.png",te={class:"auth-logo d-flex align-center gap-x-3"},le=["src"],oe={class:"auth-title"},ie={class:"position-relative bg-background w-100 me-0"},ne={class:"d-flex align-center justify-center w-100 h-100",style:{"padding-inline":"100px"}},de=["src"],ue={class:"text-h2 mb-1"},me=["src"],De={__name:"register",setup(pe){const I=B(q,q,re,se,!0),A=B(Z,Q),y=$();L(async()=>{await D()});const h=p(!0),m=p(!1),D=async()=>{try{let a=(await J(W("/auth/allow-register"))).data.value;a.sekolah?a.allowRegister?h.value=!1:await R(()=>{y.replace({to:"$404"})}):h.value=!1}catch(r){console.error(r)}},x=p(),o=p({npsn:"",email:"",password:""}),n=p({npsn:void 0,email:void 0,password:void 0}),g=p(!1),N=()=>{S(`<strong>Registrasi Berhasil</strong>
    <br>Anda telah berhasil register. Sekarang Anda dapat mulai berselancar di Aplikasi e-Rapor SMK!`,{closeOnClick:!1,autoClose:5e3,position:S.POSITION.TOP_RIGHT,dangerouslyHTMLString:!0})},P=async()=>{var r,a,c;m.value=!0;try{const d=await X("/auth/register",{method:"POST",body:{npsn:o.value.npsn,email:o.value.email,password:o.value.password},onResponseError({response:j}){n.value=j._data.errors,m.value=!1}}),{error:i,errors:V,message:ce}=d;i?(m.value=!1,n.value.npsn=(r=V.npsn)==null?void 0:r.join(", "),n.value.email=(a=V.email)==null?void 0:a.join(", "),n.value.password=(c=V.password)==null?void 0:c.join(", ")):(m.value=!1,await R(()=>{y.replace("/login").then(()=>{N()})}))}catch(d){console.error(d)}},M=()=>{var r;(r=x.value)==null||r.validate().then(({valid:a})=>{a&&P()})};return(r,a)=>{const c=U("RouterLink"),d=K;return k(),E(O,null,[s(c,{to:"/"},{default:t(()=>[l("div",te,[l("img",{src:e(f).app.logo,height:"24"},null,8,le),l("h1",oe,v(e(f).app.title),1)])]),_:1}),e(h)?(k(),T(_,{key:0,"no-gutters":"",class:"auth-wrapper bg-surface text-center"},{default:t(()=>[s(u,{cols:"12"},{default:t(()=>[s(H,{size:60,indeterminate:"",color:"error",class:"mt-16"})]),_:1})]),_:1})):(k(),T(_,{key:1,"no-gutters":"",class:"auth-wrapper bg-surface"},{default:t(()=>[s(u,{md:"8",class:"d-none d-md-flex"},{default:t(()=>[l("div",ie,[l("div",ne,[s(Y,{"max-width":"500",src:e(I),class:"auth-illustration mt-16 mb-2"},null,8,["src"])]),l("img",{class:"auth-footer-mask",src:e(A),alt:"auth-footer-mask",height:"280",width:"100"},null,8,de)])]),_:1}),s(u,{cols:"12",md:"4",class:"auth-card-v2 d-flex align-center justify-center",style:{"background-color":"rgb(var(--v-theme-surface))"}},{default:t(()=>[s(ee,{flat:"","max-width":500,class:"mt-12 mt-sm-0 pa-4"},{default:t(()=>[s(C,{class:"text-center"},{default:t(()=>[l("h1",ue,[l("img",{src:e(f).app.logo,height:"28"},null,8,me),w(" "+v(e(f).app.title),1)]),l("p",null,"Versi "+v(e(f).app.version),1),a[4]||(a[4]=l("p",{class:"mb-0"},"Silahkan register untuk dapat mengakses Aplikasi",-1))]),_:1}),s(C,null,{default:t(()=>[s(e(ae),{ref_key:"refVForm",ref:x,onSubmit:G(M,["prevent"])},{default:t(()=>[s(_,null,{default:t(()=>[s(u,{cols:"12"},{default:t(()=>[s(d,{modelValue:e(o).npsn,"onUpdate:modelValue":a[0]||(a[0]=i=>e(o).npsn=i),rules:["requiredValidator"in r?r.requiredValidator:e(b)],autofocus:"",label:"NPSN",placeholder:"NPSN","error-messages":e(n).npsn,required:""},null,8,["modelValue","rules","error-messages"])]),_:1}),s(u,{cols:"12"},{default:t(()=>[s(d,{modelValue:e(o).email,"onUpdate:modelValue":a[1]||(a[1]=i=>e(o).email=i),rules:["requiredValidator"in r?r.requiredValidator:e(b),"emailValidator"in r?r.emailValidator:e(F)],label:"Email",type:"email",placeholder:"Email Admin Dapodik","error-messages":e(n).email,required:""},null,8,["modelValue","rules","error-messages"])]),_:1}),s(u,{cols:"12"},{default:t(()=>[s(d,{modelValue:e(o).password,"onUpdate:modelValue":a[2]||(a[2]=i=>e(o).password=i),rules:["requiredValidator"in r?r.requiredValidator:e(b)],label:"Password",placeholder:"············",type:e(g)?"text":"password",autocomplete:"password","append-inner-icon":e(g)?"tabler-eye-off":"tabler-eye","onClick:appendInner":a[3]||(a[3]=i=>g.value=!e(g)),"error-messages":e(n).password,required:""},null,8,["modelValue","rules","type","append-inner-icon","error-messages"]),s(z,{block:"",type:"submit",class:"mt-6",loading:e(m),disabled:e(m)},{default:t(()=>a[5]||(a[5]=[w(" Register ")])),_:1},8,["loading","disabled"])]),_:1}),s(u,{cols:"12",class:"text-center text-base"},{default:t(()=>[a[7]||(a[7]=l("span",{class:"d-inline-block"},"Telah terdaftar?",-1)),s(c,{class:"text-primary ms-1 d-inline-block",to:{name:"login"}},{default:t(()=>a[6]||(a[6]=[w(" Login Disini ")])),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1}))],64)}}};export{De as default};
