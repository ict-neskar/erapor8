import{_ as me}from"./AnggotaRombelDialog-xpuPPbUX.js";import{_ as de}from"./AppAutocomplete-BQpxGdUG.js";import{_ as le}from"./AppSelect-D2mvpW-q.js";import{_ as oe}from"./AppTextField-CpIb7EwY.js";import{$ as M}from"./api-bn4q6wV9.js";import{V as ne,a as ce,c as pe,b as ge}from"./VCard-B6efkknt.js";import{V as ve,a as fe,b as be}from"./VToolbarItems-DPCvjbTO.js";import{r as d,o as B,f as J,e as s,b as e,aa as G,$ as N,t as U,v as T,d as r,c as F,am as _e,F as ke,h as Ve,x as ye,m as n,y as je,a3 as he,bd as Pe,bj as xe,az as we,aC as Te,aB as De,aT as Se,a6 as Ce,ae as Ue,bk as $e,aD as Le,aF as Ae,aH as Re,aP as W,Q as Be,cn as qe,bo as Ie,co as Ke,bx as Ne,w as O,G as se,cp as ze,Y as Fe,a7 as Me,aJ as Ge,ao as Oe,aj as Qe,q as X,bp as Ee,aq as Ye,a2 as C}from"./main-WcaAB0Vb.js";import{V as re}from"./VSpacer-D5re_Lnp.js";import{V as He}from"./VTable-Dxydgzys.js";import{V as Je}from"./VChip-LzakvH-4.js";import{V as ie}from"./VAvatar-C5PogN-2.js";import{V as We}from"./VDialog-B8hMcs5D.js";import{_ as Xe}from"./TablePagination-CeIL7nGF.js";import{u as Ze,c as ea}from"./createUrl-5K3jXwP3.js";import{d as aa,a as H,$ as ta}from"./mixins-CyMBM5fU.js";import{V as Z}from"./VDivider-DIWjfe5J.js";import{V as la}from"./VDataTableServer-CDhIvN-W.js";import{V as oa}from"./VImg-BR-W7-GF.js";import{V as na}from"./VMenu-BI4mPtMf.js";import{V as sa,a as ee,b as ae}from"./VList-BTYRvNWn.js";import{m as ra,V as te}from"./VOverlay-Baakzd79.js";import{f as ia}from"./forwardRefs-DWGaNmQL.js";import{u as ua}from"./scopeId-UpMB3NtI.js";const ma={key:0},da={class:"text-center",colspan:"8"},ca={class:"text-center"},pa={class:"text-center"},ga={class:"text-center"},va={key:2},fa={__name:"PembelajaranDialog",props:{isDialogVisible:{type:Boolean,required:!0},isLoading:{type:Boolean,required:!0},dialogTitle:{type:String,required:!0},form:{type:Object,required:!0},listData:{type:Array,required:!0},listGuru:{type:Array,required:!0},listKelompok:{type:Array,required:!0}},emits:["update:isDialogVisible","save","refresh"],setup(a,{emit:b}){const p=a,l=v=>{y("update:isDialogVisible",v)},y=b,D=async()=>{y("save")},g=d([]),$=async v=>{g.value[v]=!0,await M("/referensi/rombongan-belajar/hapus-pembelajaran",{method:"POST",body:{pembelajaran_id:v},onResponse(){g.value[v]=!1,y("refresh")}})};return(v,c)=>{const _=oe,j=le,x=de;return B(),J(We,{"model-value":p.isDialogVisible,"onUpdate:modelValue":l,fullscreen:"",scrim:!1,transition:"dialog-bottom-transition"},{default:s(()=>[e(ne,null,{default:s(()=>[e(ve,{color:"primary",class:"sticky-header"},{default:s(()=>[e(G,{icon:"",variant:"plain",onClick:c[0]||(c[0]=i=>l(!1))},{default:s(()=>[e(N,{color:"white",icon:"tabler-x"})]),_:1}),e(fe,null,{default:s(()=>[U(T(a.dialogTitle),1)]),_:1}),e(re),e(be,null,{default:s(()=>[e(G,{variant:"text",onClick:D},{default:s(()=>[e(N,{icon:"tabler-device-floppy",class:"me-2"}),c[1]||(c[1]=U(" Simpan "))]),_:1})]),_:1})]),_:1}),e(He,{class:"permission-table mb-6"},{default:s(()=>[c[3]||(c[3]=r("thead",null,[r("tr",null,[r("th",{class:"text-center"},"No"),r("th",{class:"text-center"},"Mata Pelajaran"),r("th",{class:"text-center"},"ID Mapel"),r("th",{class:"text-center"},"Guru Mapel (Dapodik)"),r("th",{class:"text-center"},"Guru Pengajar"),r("th",{class:"text-center"},"Kelompok"),r("th",{class:"text-center"},"Nomor Urut"),r("th",{class:"text-center"},"Reset")])],-1)),r("tbody",null,[a.isLoading?(B(),F("tr",ma,[r("td",da,[e(_e,{size:60,indeterminate:"",color:"error",class:"my-10"})])])):a.listData.length?(B(!0),F(ke,{key:1},Ve(a.listData,(i,h)=>(B(),F("tr",{class:ye({"bg-light-warning":i.induk_pembelajaran_id})},[r("td",ca,T(h+1),1),r("td",null,[e(_,{style:{"inline-size":"15.5rem"},modelValue:a.form.nama[i.pembelajaran_id],"onUpdate:modelValue":m=>a.form.nama[i.pembelajaran_id]=m},null,8,["modelValue","onUpdate:modelValue"])]),r("td",null,[e(_,{style:{"inline-size":"7rem"},modelValue:i.mata_pelajaran_id,"onUpdate:modelValue":m=>i.mata_pelajaran_id=m,disabled:""},null,8,["modelValue","onUpdate:modelValue"])]),r("td",null,[e(j,{modelValue:i.guru_id,"onUpdate:modelValue":m=>i.guru_id=m,items:a.listGuru,"item-title":"nama_lengkap","item-value":"guru_id",disabled:""},{selection:s(({item:m})=>[e(Je,null,{prepend:s(()=>[e(ie,{start:"",image:m.raw.photo},null,8,["image"])]),default:s(()=>[r("span",null,T(m.raw.nama_lengkap),1)]),_:2},1024)]),_:2},1032,["modelValue","onUpdate:modelValue","items"])]),r("td",null,[e(x,{style:{"inline-size":"15.5rem"},items:a.listGuru,placeholder:"== Pilih Guru Pengajar ==","item-title":"nama_lengkap","item-value":"guru_id",modelValue:a.form.guru_pengajar_id[i.pembelajaran_id],"onUpdate:modelValue":m=>a.form.guru_pengajar_id[i.pembelajaran_id]=m,clearable:""},null,8,["items","modelValue","onUpdate:modelValue"])]),r("td",null,[e(x,{items:a.listKelompok,placeholder:"== Pilih Kelompok ==","item-title":"nama_kelompok","item-value":"kelompok_id",modelValue:a.form.kelompok_id[i.pembelajaran_id],"onUpdate:modelValue":m=>a.form.kelompok_id[i.pembelajaran_id]=m,clearable:""},null,8,["items","modelValue","onUpdate:modelValue"])]),r("td",pa,[e(_,{style:{"inline-size":"4rem"},modelValue:a.form.no_urut[i.pembelajaran_id],"onUpdate:modelValue":m=>a.form.no_urut[i.pembelajaran_id]=m},null,8,["modelValue","onUpdate:modelValue"])]),r("td",ga,[i.kelompok_id&&i.no_urut?(B(),J(G,{key:0,loading:n(g)[i.pembelajaran_id],disabled:n(g)[i.pembelajaran_id],color:"error",icon:"tabler-trash",onClick:m=>$(i.pembelajaran_id)},null,8,["loading","disabled","onClick"])):je("",!0)])],2))),256)):(B(),F("tr",va,c[2]||(c[2]=[r("td",{class:"text-center",colspan:"8"},"Tidak ada untuk ditampilkan",-1)])))])]),_:1})]),_:1})]),_:1},8,["model-value"])}}};function ba(a){const b=W(a());let p=-1;function l(){clearInterval(p)}function y(){l(),Ye(()=>b.value=a())}function D(g){const $=g?getComputedStyle(g):{transitionDuration:.2},v=parseFloat($.transitionDuration)*1e3||200;if(l(),b.value<=0)return;const c=performance.now();p=window.setInterval(()=>{const _=performance.now()-c+v;b.value=Math.max(a()-_,0),b.value<=0&&l()},v)}return Ee(l),{clear:l,time:b,start:D,reset:y}}const _a=he({multiLine:Boolean,text:String,timer:[Boolean,String],timeout:{type:[Number,String],default:5e3},vertical:Boolean,...Pe({location:"bottom"}),...xe(),...we(),...Te(),...De(),...Se(ra({transition:"v-snackbar-transition"}),["persistent","noClickAnimation","scrim","scrollStrategy"])},"VSnackbar"),ka=Ce()({name:"VSnackbar",props:_a(),emits:{"update:modelValue":a=>!0},setup(a,b){let{slots:p}=b;const l=Ue(a,"modelValue"),{positionClasses:y}=$e(a),{scopeId:D}=ua(),{themeClasses:g}=Le(a),{colorClasses:$,colorStyles:v,variantClasses:c}=Ae(a),{roundedClasses:_}=Re(a),j=ba(()=>Number(a.timeout)),x=d(),i=d(),h=W(!1),m=W(0),K=d(),k=Be(qe,void 0);Ie(()=>!!k,()=>{const u=Ke();Ne(()=>{K.value=u.mainStyles.value})}),O(l,S),O(()=>a.timeout,S),se(()=>{l.value&&S()});let L=-1;function S(){j.reset(),window.clearTimeout(L);const u=Number(a.timeout);if(!l.value||u===-1)return;const t=ze(i.value);j.start(t),L=window.setTimeout(()=>{l.value=!1},u)}function z(){j.reset(),window.clearTimeout(L)}function P(){h.value=!0,z()}function q(){h.value=!1,S()}function Q(u){m.value=u.touches[0].clientY}function E(u){Math.abs(m.value-u.changedTouches[0].clientY)>50&&(l.value=!1)}function A(){h.value&&q()}const Y=Fe(()=>a.location.split(" ").reduce((u,t)=>(u[`v-snackbar--${t}`]=!0,u),{}));return Me(()=>{const u=te.filterProps(a),t=!!(p.default||p.text||a.text);return e(te,X({ref:x,class:["v-snackbar",{"v-snackbar--active":l.value,"v-snackbar--multi-line":a.multiLine&&!a.vertical,"v-snackbar--timer":!!a.timer,"v-snackbar--vertical":a.vertical},Y.value,y.value,a.class],style:[K.value,a.style]},u,{modelValue:l.value,"onUpdate:modelValue":f=>l.value=f,contentProps:X({class:["v-snackbar__wrapper",g.value,$.value,_.value,c.value],style:[v.value],onPointerenter:P,onPointerleave:q},u.contentProps),persistent:!0,noClickAnimation:!0,scrim:!1,scrollStrategy:"none",_disableGlobalStack:!0,onTouchstartPassive:Q,onTouchend:E,onAfterLeave:A},D),{default:()=>{var f,I;return[Ge(!1,"v-snackbar"),a.timer&&!h.value&&e("div",{key:"timer",class:"v-snackbar__timer"},[e(Oe,{ref:i,color:typeof a.timer=="string"?a.timer:"info",max:a.timeout,"model-value":j.time.value},null)]),t&&e("div",{key:"content",class:"v-snackbar__content",role:"status","aria-live":"polite"},[((f=p.text)==null?void 0:f.call(p))??a.text,(I=p.default)==null?void 0:I.call(p)]),p.actions&&e(Qe,{defaults:{VBtn:{variant:"text",ripple:!1,slim:!0}}},{default:()=>[e("div",{class:"v-snackbar__actions"},[p.actions({isActive:l})])]})]},activator:p.activator})}),ia({},x)}}),Va={class:"d-flex gap-2 align-center"},ya={class:"d-flex align-center flex-wrap gap-4"},ja={class:"d-flex align-center gap-x-4"},ha={class:"d-flex flex-column"},Pa={class:"text-base"},xa={class:"text-sm"},Ja={__name:"RombonganBelajar",props:{cardTitle:{type:String,required:!0},jenisRombel:{type:Number,required:!0}},setup(a){const b=a,p=[{title:"Nama",key:"nama",sortable:!0,nowrap:!0},{title:"Wali Kelas",key:"wali_kelas",sortable:!1},{title:"Tingkat",key:"tingkat",align:"center",sortable:!0},{title:"Program/Kompetensi Keahlian",key:"jurusan_sp",sortable:!1},{title:"Kurikulum",key:"kurikulum",sortable:!1},{title:"aksi",key:"aksi",align:"center",sortable:!1}],l=d({page:1,itemsPerPage:10,searchQuery:"",selectedRole:null,sortby:"tingkat",sortbydesc:"ASC"}),y=d(!1),D=d([]),g=d(0),$=u=>{var t,f;l.value.sortby=(t=u[0])==null?void 0:t.key,l.value.sortbydesc=(f=u[0])==null?void 0:f.order},v=async()=>{y.value=!0;try{let t=(await Ze(ea("/referensi/rombongan-belajar",{query:{jenis_rombel:b.jenisRombel,sekolah_id:aa.sekolah_id,semester_id:H.semester_id,periode_aktif:H.nama,q:l.value.searchQuery,page:l.value.page,per_page:l.value.itemsPerPage,sortby:l.value.sortby,sortbydesc:l.value.sortbydesc}}))).data.value;D.value=t.data.data,g.value=t.data.total}catch(u){console.error(u)}finally{y.value=!1}};se(async()=>{await v()}),O(l,async()=>{await v()},{deep:!0}),O(()=>l.value.searchQuery,()=>{l.value.page=1});const c=d(),_=d(!1),j=d(!1),x=d(""),i=d([]),h=d([]),m=d([]),K=d([]),k=d(!1),L=d(""),S=d(""),z=async u=>{k.value=!0,c.value=u,j.value=!0,await M("/referensi/rombongan-belajar/anggota-rombel",{method:"POST",body:{rombongan_belajar_id:c.value},onResponse({request:t,response:f,options:I}){let w=f._data;x.value=`Anggota Rombel Kelas ${w.rombel.nama}`,h.value=w.data,k.value=!1}})},P=d({pembelajaran_id:{},nama:{},guru_pengajar_id:{},kelompok_id:{},no_urut:{}}),q=async u=>{k.value=!0,c.value=u,_.value=!0,await M("/referensi/rombongan-belajar/pembelajaran",{method:"POST",body:{rombongan_belajar_id:c.value,sekolah_id:ta.sekolah_id,semester_id:H.semester_id},onResponse({request:t,response:f,options:I}){let w=f._data;x.value=`Pembelajaran Kelas ${w.rombel.nama}`,i.value=w.data,w.data.forEach(V=>{P.value.pembelajaran_id[V.pembelajaran_id]=V.pembelajaran_id,P.value.nama[V.pembelajaran_id]=V.nama_mata_pelajaran,P.value.guru_pengajar_id[V.pembelajaran_id]=V.guru_pengajar_id,P.value.kelompok_id[V.pembelajaran_id]=V.kelompok_id,P.value.no_urut[V.pembelajaran_id]=V.no_urut}),m.value=w.guru,K.value=w.kelompok,k.value=!1}})},Q=async()=>{L.value="Pembelajaran berhasil dihapus",S.value="bottom",A.value=!0,q(c.value)},E=async()=>{z(c.value)},A=d(!1),Y=async()=>{await M("/referensi/rombongan-belajar/simpan-pembelajaran",{method:"POST",body:P.value,onResponse(){L.value="Pembelajaran berhasil disimpan",S.value="top",A.value=!0,q(c.value)}})};return(u,t)=>{const f=le,I=oe,w=Xe,V=fa,ue=me;return B(),J(ne,null,{default:s(()=>[e(ce,{class:"pb-4"},{default:s(()=>[e(pe,null,{default:s(()=>[U(T(b.cardTitle),1)]),_:1})]),_:1}),e(Z),e(ge,{class:"d-flex flex-wrap gap-4"},{default:s(()=>[r("div",Va,[e(f,{modelValue:n(l).itemsPerPage,"onUpdate:modelValue":t[0]||(t[0]=o=>n(l).itemsPerPage=o),items:[{value:10,title:"10"},{value:25,title:"25"},{value:50,title:"50"},{value:100,title:"100"}],style:{"inline-size":"15.5rem"}},null,8,["modelValue"])]),e(re),r("div",ya,[e(I,{modelValue:n(l).searchQuery,"onUpdate:modelValue":t[1]||(t[1]=o=>n(l).searchQuery=o),placeholder:"Cari data",style:{"inline-size":"15.625rem"}},null,8,["modelValue"])])]),_:1}),e(Z),e(la,{page:n(l).page,"onUpdate:page":t[3]||(t[3]=o=>n(l).page=o),"items-per-page":n(l).itemsPerPage,"items-per-page-options":[{value:10,title:"10"},{value:20,title:"20"},{value:50,title:"50"}],items:n(D),"server-items-length":n(g),"items-length":n(g),headers:p,"items-per-page-text":"Item",options:n(l),loading:n(y),"loading-text":"Loading...","onUpdate:sortBy":$,"header-props":{class:"text-no-wrap"}},{"item.wali_kelas":s(({item:o})=>[r("div",ja,[e(ie,{size:"34",variant:o.wali_kelas.photo?void 0:"tonal",color:o.wali_kelas.photo?void 0:"success"},{default:s(()=>[e(oa,{src:o.wali_kelas.photo},null,8,["src"])]),_:2},1032,["variant","color"]),r("div",ha,[r("h6",Pa,T(o.wali_kelas.nama_lengkap),1),r("div",xa,T(o.wali_kelas.email),1)])])]),"item.jurusan_sp":s(({item:o})=>{var R;return[U(T((R=o.jurusan_sp)==null?void 0:R.nama_jurusan_sp),1)]}),"item.kurikulum":s(({item:o})=>{var R;return[U(T((R=o.kurikulum)==null?void 0:R.nama_kurikulum),1)]}),"item.aksi":s(({item:o})=>[e(G,{icon:"",variant:"text",color:"medium-emphasis"},{default:s(()=>[e(N,{icon:"tabler-dots-vertical"}),e(na,{activator:"parent"},{default:s(()=>[e(sa,null,{default:s(()=>[e(ee,{onClick:R=>z(o.rombongan_belajar_id)},{prepend:s(()=>[e(N,{icon:"tabler-users-group"})]),default:s(()=>[e(ae,null,{default:s(()=>t[12]||(t[12]=[U("Anggota Rombel")])),_:1})]),_:2},1032,["onClick"]),e(ee,{onClick:R=>q(o.rombongan_belajar_id)},{prepend:s(()=>[e(N,{icon:"tabler-list"})]),default:s(()=>[e(ae,null,{default:s(()=>t[13]||(t[13]=[U("Pembelajaran")])),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),bottom:s(()=>[e(w,{page:n(l).page,"onUpdate:page":t[2]||(t[2]=o=>n(l).page=o),"items-per-page":n(l).itemsPerPage,"total-items":n(g)},null,8,["page","items-per-page","total-items"])]),_:1},8,["page","items-per-page","items","server-items-length","items-length","options","loading"]),e(V,{isDialogVisible:n(_),"onUpdate:isDialogVisible":t[4]||(t[4]=o=>C(_)?_.value=o:null),isLoading:n(k),"onUpdate:isLoading":t[5]||(t[5]=o=>C(k)?k.value=o:null),"dialog-title":n(x),listData:n(i),"onUpdate:listData":t[6]||(t[6]=o=>C(i)?i.value=o:null),form:n(P),"onUpdate:form":t[7]||(t[7]=o=>C(P)?P.value=o:null),"list-guru":n(m),"list-kelompok":n(K),onSave:Y,onRefresh:Q},null,8,["isDialogVisible","isLoading","dialog-title","listData","form","list-guru","list-kelompok"]),e(ue,{isDialogVisible:n(j),"onUpdate:isDialogVisible":t[8]||(t[8]=o=>C(j)?j.value=o:null),isLoading:n(k),"onUpdate:isLoading":t[9]||(t[9]=o=>C(k)?k.value=o:null),"dialog-title":n(x),listData:n(h),"onUpdate:listData":t[10]||(t[10]=o=>C(h)?h.value=o:null),onRefresh:E},null,8,["isDialogVisible","isLoading","dialog-title","listData"]),e(ka,{modelValue:n(A),"onUpdate:modelValue":t[11]||(t[11]=o=>C(A)?A.value=o:null),color:"success",location:n(S)},{default:s(()=>[U(T(n(L)),1)]),_:1},8,["modelValue","location"])]),_:1})}}};export{Ja as _};
