import{d as K,a as I,$ as V}from"./mixins-D9sK_GNK.js";import{_ as E}from"./AlertDialog-ceVDBxZt.js";import{_ as j}from"./DialogCloseBtn-BgUVzq6p.js";import{u as F,c as L}from"./createUrl-DDCDdC1v.js";import"./api-zDHFqD3S.js";import{V as w,a as h}from"./VRow-BRHNHyL4.js";import{V as z}from"./VDialog-AuNDjXN_.js";import{b as c,V as p}from"./VCard-DP6R80QM.js";import{r as o,G,c as y,b as a,e as l,m as r,f as u,y as $,a2 as S,o as s,am as b,d as e,v as d,F as J,h as q,t as n}from"./main-BbIknAU_.js";import{V as T}from"./VTable-D6I1NIoz.js";import{V as B}from"./VAlert-DUdVz0cu.js";import"./index-BxkgbwWS.js";/* empty css              */import"./VOverlay-CegGukY1.js";import"./forwardRefs-DWGaNmQL.js";import"./scopeId-Cm6oLMEy.js";import"./VImg-C0bob0hg.js";import"./VAvatar-DhWlB6rZ.js";const H={width:"60%"},O={class:"text-white"},W={class:"text-center"},Y={class:"text-center"},Q={key:1},X={class:"text-center"},ye={__name:"erapor",setup(Z){const k=o(!0),_=o(!1),x=o({color:"",title:"",text:""});G(async()=>{await N()});const M=o(),A=o([]),g=o(0),D=o(),v=o(""),N=async()=>{try{let t=(await F(L("/sinkronisasi/erapor",{query:{sekolah_id:K.sekolah_id,semester_id:I.semester_id,user_id:K.user_id}}))).data.value;M.value=t.last_sync,A.value=t.table_sync,g.value=t.jumlah,D.value=t.error,v.value=t.message}catch(i){console.error(i)}finally{k.value=!1}},f=o(!1);g.value>1e3&&(f.value=!0),o(!1);const P=()=>{N()};return(i,t)=>{const R=j,U=E;return s(),y("div",null,[a(w,null,{default:l(()=>[a(h,{cols:"6",xl:"8",md:"8",sm:"6"},{default:l(()=>[r(k)?(s(),u(p,{key:0},{default:l(()=>[a(c,{class:"text-center"},{default:l(()=>[a(b,{size:60,indeterminate:"",color:"error"})]),_:1})]),_:1})):(s(),u(p,{key:1},{default:l(()=>[a(T,{class:"text-no-wrap"},{default:l(()=>[e("tbody",null,[e("tr",null,[t[3]||(t[3]=e("td",{rowspan:"3",width:"10%",style:{"border-right":"1px solid #dddddd"}},[e("img",{src:"/images/logo/logo-small.png",alt:"Logo e-Rapor SMK",style:{"max-width":"100px"}})],-1)),t[4]||(t[4]=e("td",{width:"30%"},"   NPSN Sekolah",-1)),e("td",H,d(("$sekolah"in i?i.$sekolah:r(V)).npsn),1)]),e("tr",null,[t[5]||(t[5]=e("td",null,"Nama Sekolah",-1)),e("td",null,d(("$sekolah"in i?i.$sekolah:r(V)).nama),1)]),e("tr",null,[t[6]||(t[6]=e("td",null,"Desa Kelurahan Sekolah",-1)),e("td",null,d(("$sekolah"in i?i.$sekolah:r(V)).alamat),1)])])]),_:1})]),_:1}))]),_:1}),a(h,{cols:"6",xl:"4",md:"4",sm:"6"},{default:l(()=>[r(k)?(s(),u(p,{key:0},{default:l(()=>[a(c,{class:"text-center"},{default:l(()=>[a(b,{size:60,indeterminate:"",color:"error"})]),_:1})]),_:1})):(s(),u(p,{key:1},{default:l(()=>[a(c,{class:"text-center"},{default:l(()=>t[7]||(t[7]=[e("p",null,"FITUR INI SEMENTARA DI NON AKTIFKAN",-1)])),_:1})]),_:1}))]),_:1})]),_:1}),r(k)?$("",!0):(s(),u(w,{key:0},{default:l(()=>[a(h,{cols:"12"},{default:l(()=>[a(B,{color:"secondary",class:"text-center"},{default:l(()=>t[8]||(t[8]=[e("h3",{class:"text-white"},"DATA YANG MENGALAMI PERUBAHAN",-1)])),_:1}),r(D)?(s(),u(B,{key:0,color:"error",class:"text-center mt-4"},{default:l(()=>[e("h3",O,d(r(v)),1)]),_:1})):$("",!0)]),_:1})]),_:1})),a(w,null,{default:l(()=>[a(h,{cols:"12"},{default:l(()=>[r(k)?(s(),u(p,{key:0},{default:l(()=>[a(c,{class:"text-center"},{default:l(()=>[a(b,{size:60,indeterminate:"",color:"error"})]),_:1})]),_:1})):(s(),u(p,{key:1},{default:l(()=>[a(T,{class:"text-no-wrap"},{default:l(()=>[t[11]||(t[11]=e("thead",null,[e("tr",null,[e("th",{class:"text-center",width:"5%"},"No"),e("th",{width:"80%"},"Data"),e("th",{class:"text-center",width:"15%"},"Jml Data")])],-1)),e("tbody",null,[r(g)?(s(!0),y(J,{key:0},q(r(A),(m,C)=>(s(),y("tr",{key:C},[e("td",W,d(C+1),1),e("td",null,d(m.data),1),e("td",Y,d(m.count),1)]))),128)):(s(),y("tr",Q,t[9]||(t[9]=[e("td",{colspan:"3",class:"text-center"},"Tidak ada data yang mengalami perubahan",-1)])))]),e("tfoot",null,[e("tr",null,[t[10]||(t[10]=e("th",{colspan:"2",class:"text-right"},"Jumlah",-1)),e("th",X,d(r(g)),1)])])]),_:1})]),_:1}))]),_:1})]),_:1}),a(z,{modelValue:r(f),"onUpdate:modelValue":t[1]||(t[1]=m=>S(f)?f.value=m:null),width:"800"},{default:l(()=>[a(R,{onClick:t[0]||(t[0]=m=>f.value=!r(f))}),a(p,{title:"Informasi"},{default:l(()=>[a(c,null,{default:l(()=>t[12]||(t[12]=[e("p",null,[n("Terdeteksi jumlah data yang akan dikirim melebihi 1.000 row. Sangat disarankan melakukan pengiriman data melalui "),e("code",null,"Command Prompt"),n(" untuk menghindari kegagalan pengiriman data.")],-1),e("p",null,[n("Cara melakukan pengiriman data melalui "),e("code",null,"Command Prompt"),n(":")],-1),e("p",null,[n("Untuk Pengguna "),e("strong",null,"Windows")],-1),e("ol",{style:{"padding-left":"20px"}},[e("li",null,"Buka CMD"),e("li",null,[n("Ketik: "),e("code",null,"cd c:\\eRaporSMK\\dataweb"),n(" [enter]")]),e("li",null,[n("Ketik: "),e("code",null,"php artisan kirim:erapor"),n(" [enter]")]),e("li",null,"Ketikkan email administrator"),e("li",null,"Tunggu hingga proses pengiriman data selesai.")],-1),e("p",null,[n("Untuk Pengguna "),e("strong",null,"Linux")],-1),e("ol",{style:{"padding-left":"20px"}},[e("li",null,[n("Buka Aplikasi Putty dan login ke "),e("code",null,"shh")]),e("li",null,[n("Ketik: "),e("code",null,[n("cd /var/www/html/dataweb"),e("sup",null,"*")]),n(" [enter]")]),e("li",null,[n("Ketik: "),e("code",null,"php artisan kirim:erapor"),n(" [enter]")]),e("li",null,"Ketikkan email administrator"),e("li",null,"Tunggu hingga proses pengiriman data selesai.")],-1),e("p",null,[n("Keterangan: "),e("br"),n(" * : Sesuaikan dengan direktori root folder aplikasi e-Rapor SMK di install "),e("br"),n(" Untuk mengirimkan seluruh data yang tersimpan di database tanpa filter apapun, jalankan perintah: "),e("code",null,"php artisan kirim:erapor --force")],-1)])),_:1})]),_:1})]),_:1},8,["modelValue"]),a(U,{isDialogVisible:r(_),"onUpdate:isDialogVisible":t[2]||(t[2]=m=>S(_)?_.value=m:null),"confirm-color":r(x).color,"confirm-title":r(x).title,"confirm-msg":r(x).text,onConfirm:P},null,8,["isDialogVisible","confirm-color","confirm-title","confirm-msg"])])}}};export{ye as default};
