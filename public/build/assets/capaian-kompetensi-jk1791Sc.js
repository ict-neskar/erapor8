import{_ as re}from"./ConfirmDialog-CY_9uydO.js";import{_ as ie}from"./AppTextarea-6QKYtdrt.js";import{_ as se}from"./ProfileSiswa-BoXX9sbX.js";import{_ as me}from"./DefaultForm-CqauJFGV.js";import{r as m,G as de,f as c,e as r,o as g,b as n,t as B,m as t,am as q,ap as ue,a2 as k,d as i,aa as G,y as F,c as $,h as pe,F as ge,v as I}from"./main-BpmS5yjl.js";import{$ as T}from"./api-CqoQuUrQ.js";import{a as H,d as R}from"./mixins-CToSDW15.js";import{V as _e,c as fe,a as be,b as K}from"./VCard-CHmpSx-c.js";import{V as J}from"./VDivider-gWeRf3Xl.js";import{V as ce}from"./VForm-BtS5s1QD.js";import{V as Q,a as w}from"./VRow-BacuoGYF.js";import{V as X}from"./VAlert-DvtwwTIG.js";import{V as ke}from"./VTable-DH5oZuZ_.js";import"./VDialog-DmAehLsX.js";import"./VOverlay-yY7p8is2.js";import"./forwardRefs-DWGaNmQL.js";import"./scopeId-DiP191uI.js";import"./VImg-1iDcvPVu.js";import"./VLabel-D6Y69236.js";import"./VTextarea-CFufzxXw.js";/* empty css                   */import"./VField-Cktymv3Q.js";import"./VAvatar-CwdAusxZ.js";import"./AppAutocomplete-CoTPRzAH.js";import"./VSelect-D2E-ncti.js";import"./AppTextField-BYQvWqvk.js";import"./VList-CAazeH9Z.js";import"./ssrBoot-C9ygE__7.js";import"./VMenu-RpUw0xGr.js";import"./VSelectionControl-Bjw4k3ug.js";import"./VChip-Ce3c0jwR.js";import"./VSlideGroup-ZqIn0ESw.js";import"./filter-B41lvxns.js";import"./AppSelect-DbfGRlpP.js";import"./index-BxkgbwWS.js";/* empty css              */const ve={key:0,class:"text-center"},ye={class:"text-center"},Ve={class:"text-center"},na={__name:"capaian-kompetensi",setup(he){const A=m(!0),E=m(!0),Y=async()=>{try{const o=await T("/setting/status-penilaian",{method:"POST",body:{sekolah_id:R.sekolah_id,semester_id:H.semester_id}});E.value=o}catch(o){console.error(o)}finally{A.value=!1}};de(async()=>{await Y()});const _=m({tingkat:void 0,rombongan_belajar_id:void 0,pembelajaran_id:void 0,mata_pelajaran_id:void 0}),x=m({tingkat:null,rombongan_belajar_id:null,pembelajaran_id:null}),p=m({rombel:[],mapel:[],siswa:[]}),f=m({body:!1,rombel:!1,mapel:!1}),j=m(!1),N=m(0),v={opsi:"capaian-kompetensi",semester_id:H.semester_id,user_id:R.user_id,guru_id:R.guru_id,sekolah_id:R.sekolah_id,merdeka:!1},s=m({angka:{},kompeten:{},inkompeten:{}}),C=m(!1),O=async o=>{const e={...o,...v};await T("/referensi/get-data",{method:"POST",body:e,onResponse({response:d}){p.value.siswa=[],j.value=!1;let u=d._data;o.data=="rombel"&&(p.value.rombel=u),o.data=="mapel"&&(p.value.mapel=u.mapel,v.merdeka=u.merdeka,C.value=!!u.rombel.kunci_nilai)}})},Z=async o=>{_.value.rombongan_belajar_id=null,_.value.pembelajaran_id=null,o&&(f.value.rombel=!0,await O({data:"rombel",nilai:1,tingkat:o}).then(()=>{f.value.rombel=!1}))},ee=async o=>{_.value.pembelajaran_id=null,o&&(f.value.mapel=!0,await O({data:"mapel",nilai:1,rombongan_belajar_id:o}).then(()=>{f.value.mapel=!1}))},M=o=>o.charAt(0).toLowerCase()+o.slice(1),z=o=>{var e=/\+([a-z\d\/+]*\-?)/gi,d,u,b,a;return o.replace(e,function(l,h){for(d=Buffer(h,"base64"),u=d.length>>1<<1,b="",a=1,a;a<u;a=a+2)b+=String.fromCharCode(d.readUInt16BE(a-1));return b})},ae=async o=>{if(p.value.siswa=[],o){const e={..._.value,...v};f.value.body=!0,j.value=!1,await T("/penilaian/get-capaian-kompetensi",{method:"POST",body:e,onResponse({response:d}){var b;let u=d._data;p.value.siswa=u.data_siswa,N.value=u.show_reset,j.value=!!((b=u.data_siswa)!=null&&b.length),f.value.body=!1,u.data_siswa.forEach(a=>{if(s.value.angka[a.anggota_rombel.anggota_rombel_id]=a.anggota_rombel.nilai_akhir_mapel?a.anggota_rombel.nilai_akhir_mapel.nilai:"",a.anggota_rombel.deskripsi_mata_pelajaran)s.value.kompeten[a.anggota_rombel.anggota_rombel_id]=a.anggota_rombel.deskripsi_mata_pelajaran.deskripsi_pengetahuan,s.value.inkompeten[a.anggota_rombel.anggota_rombel_id]=a.anggota_rombel.deskripsi_mata_pelajaran.deskripsi_keterampilan;else if(a.anggota_rombel.single_deskripsi_mata_pelajaran)s.value.kompeten[a.anggota_rombel.anggota_rombel_id]=a.anggota_rombel.single_deskripsi_mata_pelajaran.deskripsi_pengetahuan,s.value.inkompeten[a.anggota_rombel.anggota_rombel_id]=a.anggota_rombel.single_deskripsi_mata_pelajaran.deskripsi_keterampilan;else{var l=[],h=[];a.anggota_rombel.tp_kompeten.length?(a.anggota_rombel.tp_kompeten.forEach(y=>{l.push(z(M(y.tp.deskripsi)))}),s.value.kompeten[a.anggota_rombel.anggota_rombel_id]="Menunjukkan penguasaan yang baik dalam "+l.join(", ")):s.value.kompeten[a.anggota_rombel.anggota_rombel_id]=null,a.anggota_rombel.tp_inkompeten.length?(a.anggota_rombel.tp_inkompeten.forEach(y=>{h.push(z(M(y.tp.deskripsi)))}),s.value.inkompeten[a.anggota_rombel.anggota_rombel_id]="Perlu ditingkatkan dalam "+h.join(", ")):s.value.inkompeten[a.anggota_rombel.anggota_rombel_id]=null}})}})}},U=m(!1),D=m(!1),P=m(!1),L=m(""),V=m({color:"",title:"",text:""}),te=async()=>{U.value=!0;const o={...v,..._.value,...s.value};await T("/penilaian/simpan",{method:"POST",body:o,onResponse({response:e}){let d=e._data;U.value=!1,d.errors?x.value=d.errors:(D.value=!0,V.value=d)}})},S=m(!1),W=()=>{S.value=!0,_.value={tingkat:null,rombongan_belajar_id:null,pembelajaran_id:null,mata_pelajaran_id:null},x.value={tingkat:null,rombongan_belajar_id:null,pembelajaran_id:null},p.value={rombel:[],mapel:[],siswa:[]},j.value=!1,N.value=0,s.value={angka:{},kompeten:{},inkompeten:{}}},le=()=>{W()},oe=()=>{P.value=!0,L.value="Tindakan ini tidak dapat dikembalikan!",V.value={color:"warning",title:"a",text:"b"}},ne=async()=>{v.opsi="reset-kompetensi";const o={...v,..._.value,...s.value};await T("/penilaian/simpan",{method:"POST",body:o,onResponse({response:e}){let d=e._data;v.opsi="capaian-kompetensi",V.value=d,D.value=!0,W()}})};return(o,e)=>{const d=me,u=se,b=ie,a=re;return g(),c(_e,{class:"mb-6"},{default:r(()=>[n(be,{class:"pb-4"},{default:r(()=>[n(fe,null,{default:r(()=>e[8]||(e[8]=[B("Capaian Kompetensi")])),_:1})]),_:1}),n(J),t(A)?(g(),c(K,{key:0,class:"text-center"},{default:r(()=>[n(q,{size:60,indeterminate:"",color:"error",class:"my-10"})]),_:1})):t(E)?(g(),c(ce,{key:1,onSubmit:ue(te,["prevent"])},{default:r(()=>[n(K,null,{default:r(()=>[n(Q,null,{default:r(()=>[n(d,{form:t(_),"onUpdate:form":e[0]||(e[0]=l=>k(_)?_.value=l:null),errors:t(x),"onUpdate:errors":e[1]||(e[1]=l=>k(x)?x.value=l:null),arrayData:t(p),"onUpdate:arrayData":e[2]||(e[2]=l=>k(p)?p.value=l:null),loading:t(f),"onUpdate:loading":e[3]||(e[3]=l=>k(f)?f.value=l:null),resetForm:t(S),"onUpdate:resetForm":e[4]||(e[4]=l=>k(S)?S.value=l:null),isKunci:t(C),"onUpdate:isKunci":e[5]||(e[5]=l=>k(C)?C.value=l:null),onTingkat:Z,onRombongan_belajar_id:ee,onPembelajaran_id:ae},null,8,["form","errors","arrayData","loading","resetForm","isKunci"]),t(N)?(g(),c(w,{key:0,cols:"12"},{default:r(()=>[n(Q,{"no-gutters":""},{default:r(()=>[n(w,{cols:"12",md:"3",class:"d-flex align-items-center"},{default:r(()=>e[9]||(e[9]=[i("label",{class:"v-label text-body-2 text-high-emphasis"},"Reset Capaian Kompetensi",-1)])),_:1}),n(w,{cols:"12",md:"9"},{default:r(()=>[n(G,{variant:"tonal",color:"error",onClick:oe},{default:r(()=>e[10]||(e[10]=[B(" Reset Capaian Kompetensi ")])),_:1})]),_:1})]),_:1})]),_:1})):F("",!0)]),_:1}),t(f).body?(g(),$("div",ve,[n(q,{size:60,indeterminate:"",color:"error",class:"my-10"})])):F("",!0),t(C)?(g(),c(X,{key:1,color:"error",class:"text-center my-4",variant:"tonal"},{default:r(()=>e[11]||(e[11]=[i("h2",{class:"mt-4 mb-4"},"Penilaian tidak aktif. Silahkan hubungi Wali Kelas!",-1)])),_:1})):F("",!0)]),_:1}),t(p).siswa.length?(g(),c(ke,{key:0},{default:r(()=>[e[12]||(e[12]=i("thead",null,[i("tr",null,[i("th",{class:"text-center",rowspan:"2",style:{"vertical-align":"middle"}},"No"),i("th",{class:"text-center",rowspan:"2",style:{"vertical-align":"middle"}},"Nama Peserta Didik"),i("th",{class:"text-center",rowspan:"2",style:{"vertical-align":"middle"}},"Nilai Akhir"),i("th",{class:"text-center",colspan:"2"},"Capaian Kompetensi")]),i("tr",null,[i("th",{class:"text-center"},"Kompetensi yang telah dicapai"),i("th",{class:"text-center"},"Kompetensi yang perlu ditingkatkan")])],-1)),i("tbody",null,[(g(!0),$(ge,null,pe(t(p).siswa,(l,h)=>(g(),$("tr",null,[i("td",ye,I(h+1),1),i("td",null,[n(u,{item:l},null,8,["item"])]),i("td",Ve,I(t(s).angka[l.anggota_rombel.anggota_rombel_id]),1),i("td",null,[n(b,{modelValue:t(s).kompeten[l.anggota_rombel.anggota_rombel_id],"onUpdate:modelValue":y=>t(s).kompeten[l.anggota_rombel.anggota_rombel_id]=y,placeholder:"Kompetensi yang telah dicapai",class:"py-2 px-2"},null,8,["modelValue","onUpdate:modelValue"])]),i("td",null,[n(b,{modelValue:t(s).inkompeten[l.anggota_rombel.anggota_rombel_id],"onUpdate:modelValue":y=>t(s).inkompeten[l.anggota_rombel.anggota_rombel_id]=y,placeholder:"Kompetensi yang perlu ditingkatkan"},null,8,["modelValue","onUpdate:modelValue"])])]))),256))])]),_:1})):F("",!0),n(J),t(j)?(g(),c(K,{key:1,class:"d-flex justify-end flex-wrap gap-3 pt-5 overflow-visible"},{default:r(()=>[n(G,{variant:"elevated",type:"submit",loading:t(U),disabled:t(U)},{default:r(()=>e[13]||(e[13]=[B(" Simpan ")])),_:1},8,["loading","disabled"])]),_:1})):F("",!0)]),_:1})):(g(),c(K,{key:2},{default:r(()=>[n(X,{color:"error",class:"text-center my-4",variant:"tonal"},{default:r(()=>e[14]||(e[14]=[i("h2",{class:"mt-4 mb-4"},"Penilaian tidak aktif. Silahkan hubungi administrator!",-1)])),_:1})]),_:1})),n(a,{isDialogVisible:t(P),"onUpdate:isDialogVisible":e[6]||(e[6]=l=>k(P)?P.value=l:null),isNotifVisible:t(D),"onUpdate:isNotifVisible":e[7]||(e[7]=l=>k(D)?D.value=l:null),"confirmation-question":"Apakah Anda yakin?","confirmation-text":t(L),"confirm-color":t(V).color,"confirm-title":t(V).title,"confirm-msg":t(V).text,onConfirm:ne,onClose:le},null,8,["isDialogVisible","isNotifVisible","confirmation-text","confirm-color","confirm-title","confirm-msg"])]),_:1})}}};export{na as default};
