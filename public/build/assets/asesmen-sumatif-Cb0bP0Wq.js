import{_ as te}from"./ConfirmDialog-DJg6T0Ss.js";import{_ as le}from"./AppTextField-BYuq6zq8.js";import{_ as ne,a as ie}from"./DefaultForm-D6NoUxT3.js";import{_ as oe}from"./AppSelect-DlsWZOle.js";import{r as f,f as D,e as m,a as re,o as g,b as n,t as c,m as a,a2 as V,d as r,c as k,am as se,y as N,h as F,F as h,aa as me,ao as ue,v as R}from"./main-Dl0rUCYh.js";import{$ as B}from"./api-CiS_WuT0.js";import{a as de,d as E}from"./mixins-1QYt5fru.js";import{V as pe,c as _e,a as fe,b as M}from"./VCard-cOUOYXWj.js";import{V as q}from"./VDivider-DE02SI82.js";import{V as L,a as I}from"./VRow-BWoXzrFX.js";import{V as ge}from"./VAlert-B2ccayhE.js";import{V as be}from"./VTable-DOTAg6_r.js";import{V as ke}from"./VForm-C8sZwdRj.js";import{V as ve}from"./VTooltip-D7VnGqnv.js";import"./VDialog-DALwxD56.js";import"./VOverlay-DA1Ejrlc.js";import"./forwardRefs-DWGaNmQL.js";import"./VImg-DiBI_SCk.js";import"./VLabel-BTSq7zPr.js";import"./VAvatar-AahfVeEd.js";import"./VList-DLdPu79M.js";import"./VMenu-DmZE3Mnu.js";import"./VSelectionControl-Bmf3QYSu.js";import"./VChip-pgoMLksa.js";import"./index-BxkgbwWS.js";/* empty css              */const ce={key:0,class:"text-center"},Ve={class:"text-center"},ye={class:"text-center"},xe={style:{"inline-size":"4rem"}},Xe={__name:"asesmen-sumatif",setup(je){const _=f({tingkat:null,rombongan_belajar_id:null,pembelajaran_id:null,teknik_penilaian_id:null}),u=f({tp:{},sumatif:{}}),v=f({tingkat:null,rombongan_belajar_id:null,pembelajaran_id:null,teknik_penilaian_id:null}),s=f({rombel:[],mapel:[],teknik:[],siswa:[],tp:[]}),d=f({rombel:!1,mapel:!1,teknik_penilaian_id:!1,body:!1}),w=f(!1),y=f(!1),U=f(!1),x=f(!1),O=f(""),j=f({color:"",title:"",text:""}),G=async()=>{y.value=!0;const l={...T,..._.value,...u.value};await B("/penilaian/simpan",{method:"POST",body:l,onResponse({response:e}){let i=e._data;y.value=!1,i.errors?v.value=i.errors:(x.value=!0,j.value=i)}})},T={opsi:"",semester_id:de.semester_id,user_id:E.user_id,guru_id:E.guru_id,sekolah_id:E.sekolah_id},H=()=>{_.value={tingkat:null,rombongan_belajar_id:null,pembelajaran_id:null,teknik_penilaian_id:null},u.value={tp:{},sumatif:{}},v.value={tingkat:null,rombongan_belajar_id:null,pembelajaran_id:null,teknik_penilaian_id:null},s.value={rombel:[],mapel:[],teknik:[],siswa:[],tp:[]},d.value={rombel:!1,mapel:!1,teknik_penilaian_id:!1,body:!1},w.value=!1,y.value=!1,U.value=!1,x.value=!1,O.value="",j.value={color:"",title:"",text:""},T.opsi=""},S=async l=>{const e={...l,...T};await B("/referensi/get-data",{method:"POST",body:e,onResponse({response:i}){let o=i._data;l.data=="rombel"&&(s.value.rombel=o),l.data=="mapel"&&(s.value.mapel=o.mapel),l.data=="teknik"&&(s.value.teknik=o)}})},K=async l=>{_.value.rombongan_belajar_id=null,_.value.pembelajaran_id=null,l&&(d.value.rombel=!0,await S({data:"rombel",nilai:1,tingkat:l}).then(()=>{d.value.rombel=!1}))},Q=async l=>{_.value.pembelajaran_id=null,l&&(d.value.mapel=!0,await S({data:"mapel",nilai:1,rombongan_belajar_id:l}).then(()=>{d.value.mapel=!1}))},W=async l=>{_.value.teknik_penilaian_id=null,l&&(d.value.teknik_penilaian_id=!0,await S({data:"teknik"}).then(()=>{d.value.teknik_penilaian_id=!1}))},A=f(!1),$=f(!1),X=async l=>{l&&(d.value.body=!0,await B("/penilaian/get-cp",{method:"POST",body:{pembelajaran_id:_.value.pembelajaran_id,rombongan_belajar_id:_.value.rombongan_belajar_id,teknik_penilaian_id:_.value.teknik_penilaian_id},onResponse({response:e}){let i=e._data;$.value=i.show_cp,s.value.siswa=i.data_siswa,s.value.tp=i.data_tp,A.value=!1,w.value=!1,i.show_cp&&!i.data_tp.length&&(A.value=!0),s.value.siswa.length&&(w.value=!0),s.value.siswa.forEach(o=>{$.value?(T.opsi="nilai-tp",o.anggota_rombel.nilai_tp.length&&o.anggota_rombel.nilai_tp.forEach(p=>{u.value.tp[o.anggota_rombel.anggota_rombel_id+"#"+p.tp_id]=p.nilai})):(T.opsi="nilai-sumatif",o.anggota_rombel.nilai_sumatif.length&&o.anggota_rombel.nilai_sumatif.forEach(p=>{u.value.sumatif[o.anggota_rombel.anggota_rombel_id+"#"+p.jenis]=p.nilai}))}),d.value.body=!1}}))},Y=()=>{H()},Z=l=>{var e=0,i=0;l.forEach(function(p,J){e+=p,i++});var o=e/i;return o.toFixed(0)},z=(l,e)=>{var i=0,o=u.value.sumatif[`${l}#non-tes`],p=u.value.sumatif[`${l}#tes`];o&&p?i=Z([parseInt(o),parseInt(p)]):o&&!p?i=o:!o&&p&&(i=p),u.value.sumatif[`${l}#na`]=i};return(l,e)=>{const i=ne,o=oe,p=re("router-link"),J=ie,C=le,ee=te;return g(),D(pe,{class:"mb-6"},{default:m(()=>[n(fe,{class:"pb-4"},{default:m(()=>[n(_e,null,{default:m(()=>e[7]||(e[7]=[c("Input Asesmen")])),_:1})]),_:1}),n(q),n(ke,{onSubmit:ue(G,["prevent"])},{default:m(()=>[n(M,null,{default:m(()=>[n(L,null,{default:m(()=>[n(i,{form:a(_),"onUpdate:form":e[0]||(e[0]=t=>V(_)?_.value=t:null),errors:a(v),"onUpdate:errors":e[1]||(e[1]=t=>V(v)?v.value=t:null),arrayData:a(s),"onUpdate:arrayData":e[2]||(e[2]=t=>V(s)?s.value=t:null),loading:a(d),"onUpdate:loading":e[3]||(e[3]=t=>V(d)?d.value=t:null),onTingkat:K,onRombongan_belajar_id:Q,onPembelajaran_id:W},null,8,["form","errors","arrayData","loading"]),n(I,{cols:"12"},{default:m(()=>[n(L,{"no-gutters":""},{default:m(()=>[n(I,{cols:"12",md:"3",class:"d-flex align-items-center"},{default:m(()=>e[8]||(e[8]=[r("label",{class:"v-label text-body-2 text-high-emphasis",for:"teknik_penilaian_id"},"Jenis Asesmen",-1)])),_:1}),n(I,{cols:"12",md:"9"},{default:m(()=>[n(o,{modelValue:a(_).teknik_penilaian_id,"onUpdate:modelValue":[e[4]||(e[4]=t=>a(_).teknik_penilaian_id=t),X],placeholder:"== Pilih Jenis Asesmen ==",items:a(s).teknik,clearable:"","clear-icon":"tabler-x","item-value":"teknik_penilaian_id","item-title":"nama","error-messages":a(v).teknik_penilaian_id,loading:a(d).teknik_penilaian_id,disabled:a(d).teknik_penilaian_id},null,8,["modelValue","items","error-messages","loading","disabled"])]),_:1})]),_:1})]),_:1})]),_:1}),a(d).body?(g(),k("div",ce,[n(se,{size:60,indeterminate:"",color:"error",class:"my-10"})])):N("",!0),a(A)?(g(),D(ge,{key:1,color:"error",class:"text-center my-4",variant:"tonal"},{default:m(()=>[e[11]||(e[11]=r("h2",{class:"mt-4 mb-4"},"Tidak ditemukan data Tujuan Pembelajaran",-1)),r("p",null,[e[10]||(e[10]=c(" Silahkan tambah data Tujuan Pembelajaran terlebih dahulu ")),n(p,{to:{name:"referensi-tujuan-pembelajaran"}},{default:m(()=>e[9]||(e[9]=[c("disini")])),_:1})])]),_:1})):N("",!0)]),_:1}),a(s).siswa.length?(g(),D(be,{key:0,class:"text-no-wrap"},{default:m(()=>[r("thead",null,[r("tr",null,[e[15]||(e[15]=r("th",{class:"text-center"},"No.",-1)),e[16]||(e[16]=r("th",{class:"text-center"},"Nama Peserta Didik",-1)),a($)?(g(!0),k(h,{key:0},F(a(s).tp,(t,P)=>(g(),k("th",Ve,[c(R(`TP ${P+1}`)+" ",1),n(ve,{location:"top",activator:"parent",transition:"scale-transition"},{default:m(()=>[c(R(t.deskripsi),1)]),_:2},1024)]))),256)):(g(),k(h,{key:1},[e[12]||(e[12]=r("th",{class:"text-center"},"Non Tes",-1)),e[13]||(e[13]=r("th",{class:"text-center"},"Tes",-1)),e[14]||(e[14]=r("th",{class:"text-center"},"NA Sumatif Akhir Semester",-1))],64))])]),r("tbody",null,[(g(!0),k(h,null,F(a(s).siswa,(t,P)=>(g(),k("tr",null,[r("td",ye,R(P+1),1),r("td",null,[n(J,{item:t},null,8,["item"])]),a($)?(g(!0),k(h,{key:0},F(a(s).tp,(b,Te)=>(g(),k("td",null,[r("div",xe,[n(C,{type:"number",modelValue:a(u).tp[t.anggota_rombel.anggota_rombel_id+"#"+b.tp_id],"onUpdate:modelValue":ae=>a(u).tp[t.anggota_rombel.anggota_rombel_id+"#"+b.tp_id]=ae},null,8,["modelValue","onUpdate:modelValue"])])]))),256)):(g(),k(h,{key:1},[r("td",null,[n(C,{type:"number",modelValue:a(u).sumatif[t.anggota_rombel.anggota_rombel_id+"#non-tes"],"onUpdate:modelValue":[b=>a(u).sumatif[t.anggota_rombel.anggota_rombel_id+"#non-tes"]=b,b=>z(t.anggota_rombel.anggota_rombel_id,"#non-tes")]},null,8,["modelValue","onUpdate:modelValue"])]),r("td",null,[n(C,{type:"number",modelValue:a(u).sumatif[t.anggota_rombel.anggota_rombel_id+"#tes"],"onUpdate:modelValue":[b=>a(u).sumatif[t.anggota_rombel.anggota_rombel_id+"#tes"]=b,b=>z(t.anggota_rombel.anggota_rombel_id,"#tes")]},null,8,["modelValue","onUpdate:modelValue"])]),r("td",null,[n(C,{type:"number",modelValue:a(u).sumatif[t.anggota_rombel.anggota_rombel_id+"#na"],"onUpdate:modelValue":b=>a(u).sumatif[t.anggota_rombel.anggota_rombel_id+"#na"]=b,disabled:""},null,8,["modelValue","onUpdate:modelValue"])])],64))]))),256))])]),_:1})):N("",!0),n(q),a(w)?(g(),D(M,{key:1,class:"d-flex justify-end flex-wrap gap-3 pt-5 overflow-visible"},{default:m(()=>[n(me,{variant:"elevated",type:"submit",loading:a(y),disabled:a(y)},{default:m(()=>e[17]||(e[17]=[c(" Simpan ")])),_:1},8,["loading","disabled"])]),_:1})):N("",!0)]),_:1}),n(ee,{isDialogVisible:a(U),"onUpdate:isDialogVisible":e[5]||(e[5]=t=>V(U)?U.value=t:null),isNotifVisible:a(x),"onUpdate:isNotifVisible":e[6]||(e[6]=t=>V(x)?x.value=t:null),"confirmation-question":"Apakah Anda yakin?","confirmation-text":a(O),"confirm-color":a(j).color,"confirm-title":a(j).title,"confirm-msg":a(j).text,onClose:Y},null,8,["isDialogVisible","isNotifVisible","confirmation-text","confirm-color","confirm-title","confirm-msg"])]),_:1})}}};export{Xe as default};
