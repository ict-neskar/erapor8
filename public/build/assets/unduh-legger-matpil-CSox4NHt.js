import{_ as $}from"./ProfileSiswa-CNtxoAVM.js";import{d as h,a as v}from"./mixins-D9sK_GNK.js";import{u as P,c as B}from"./createUrl-DDCDdC1v.js";import{V as L,c as T,a as F,b as R}from"./VCard-DP6R80QM.js";import{G as S,r as x,f as w,e as g,o as a,b as p,aa as U,t as V,m as _,c as r,am as A,F as i,d as o,h as k,y as I,v as u}from"./main-BbIknAU_.js";import{V as M}from"./VDivider-AdngBwQk.js";import{V as q}from"./VTable-D6I1NIoz.js";import"./VImg-C0bob0hg.js";import"./VAvatar-DhWlB6rZ.js";import"./index-BxkgbwWS.js";const z={key:0},E={class:"text-center"},G={class:"text-center",rowspan:"3"},K={key:0,class:"text-center"},H={key:1,class:"text-center"},J={key:0,class:"text-center"},O={class:"text-center"},Q={class:"text-center"},W={class:"text-center"},X={key:1,class:"text-center"},de={__name:"unduh-legger-matpil",setup(Y){S(async()=>{await j()});const f=x({body:!1}),l=x({user_id:h.user_id,guru_id:h.guru_id,sekolah_id:h.sekolah_id,semester_id:v.semester_id,periode_aktif:v.nama,aksi:"unduh-legger",rapor_pts:!1,merdeka:!1,is_ppa:!1,rombongan_belajar_id:null}),m=x({siswa:[],pembelajaran:[]}),j=async()=>{f.value.body=!0;try{let e=(await P(B("/walas",{query:{user_id:l.value.user_id,guru_id:l.value.guru_id,sekolah_id:l.value.sekolah_id,semester_id:l.value.semester_id,periode_aktif:l.value.nama,aksi:l.value.aksi,pilihan:1}}))).data.value;l.value.rombongan_belajar_id=e.rombel.rombongan_belajar_id,l.value.merdeka=e.merdeka,l.value.is_ppa=e.is_ppa,m.value.siswa=e.data_siswa,m.value.pembelajaran=e.pembelajaran}catch(n){console.error(n)}finally{f.value.body=!1}},C=()=>{if(l.value.rombongan_belajar_id){if(l.value.merdeka||l.value.is_ppa)var n=`/downloads/leger-nilai-kurmer/${l.value.rombongan_belajar_id}/${l.value.sekolah_id}/${l.value.semester_id}`;else var n=`/downloads/leger-nilai-rapor/${l.value.rombongan_belajar_id}`;window.open(n,"_blank").focus()}},c=(n,e)=>{const d=n.find(s=>s.anggota_rombel_id===e);return(d==null?void 0:d.nilai)??"-"},y=(n,e)=>{const d=n.find(s=>s.anggota_rombel_id===e.anggota_rombel_id);return(d==null?void 0:d.nilai)??"-"},N=(n,e,d,s)=>{n=n*b(d),e=e*b(s);var t=(n+e)/100;return isNaN(t)?t="-":t=Math.ceil(t),t},b=n=>n??50;return(n,e)=>{const d=$;return a(),w(L,{class:"mb-6"},{default:g(()=>[p(F,{class:"pb-4"},{append:g(()=>[p(U,{"prepend-icon":"tabler-file-type-xls",onClick:C},{default:g(()=>e[1]||(e[1]=[V(" Unduh Legger ")])),_:1})]),default:g(()=>[p(T,null,{default:g(()=>e[0]||(e[0]=[V("Unduh Legger")])),_:1})]),_:1}),_(f).body?(a(),r(i,{key:0},[p(M),p(R,{class:"text-center"},{default:g(()=>[p(A,{size:60,indeterminate:"",color:"error",class:"my-10"})]),_:1})],64)):(a(),r(i,{key:1},[_(m).siswa.length?(a(),w(q,{key:0,class:"text-no-wrap"},{default:g(()=>[o("thead",null,[_(l).merdeka||_(l).is_ppa?(a(),r("tr",z,[e[2]||(e[2]=o("th",{class:"text-center"},"Peserta Didik",-1)),(a(!0),r(i,null,k(_(m).pembelajaran,(s,t)=>(a(),r("th",E,u(s.nama_mata_pelajaran),1))),256))])):(a(),r(i,{key:1},[e[6]||(e[6]=o("th",{class:"text-center"},"Peserta Didik",-1)),(a(!0),r(i,null,k(_(m).pembelajaran,(s,t)=>(a(),r("th",G,u(s.nama_mata_pelajaran),1))),256)),e[7]||(e[7]=o("th",{class:"text-center align-middle",rowspan:"3"},"S",-1)),e[8]||(e[8]=o("th",{class:"text-center align-middle",rowspan:"3"},"I",-1)),e[9]||(e[9]=o("th",{class:"text-center align-middle",rowspan:"3"},"A",-1)),o("tr",null,[(a(!0),r(i,null,k(_(m).pembelajaran,(s,t)=>(a(),r(i,null,[e[3]||(e[3]=o("th",{class:"text-center"},"P",-1)),e[4]||(e[4]=o("th",{class:"text-center"},"K",-1)),e[5]||(e[5]=o("th",{class:"text-center"},"R",-1))],64))),256))])],64))]),o("tbody",null,[(a(!0),r(i,null,k(_(m).siswa,s=>(a(),r("tr",null,[o("td",null,[p(d,{item:s},null,8,["item"])]),_(l).merdeka?(a(!0),r(i,{key:0},k(_(m).pembelajaran,(t,D)=>(a(),r(i,null,[t.rombongan_belajar.jenis_rombel=="1"?(a(),r("td",K,u(c(t.all_nilai_akhir_kurmer,s.anggota_rombel.anggota_rombel_id)),1)):(a(),r("td",H,u(y(t.all_nilai_akhir_kurmer,s.anggota_pilihan)),1))],64))),256)):(a(!0),r(i,{key:1},k(n.data_pembelajaran,(t,D)=>(a(),r(i,null,[t.rombongan_belajar.jenis_rombel=="1"?(a(),r(i,{key:0},[n.is_ppa?(a(),r("td",J,u(c(t.all_nilai_akhir_pengetahuan,s.anggota_rombel.anggota_rombel_id)),1)):(a(),r(i,{key:1},[o("td",O,u(c(t.all_nilai_akhir_pengetahuan,s.anggota_rombel.anggota_rombel_id)),1),o("td",Q,u(c(t.all_nilai_akhir_keterampilan,s.anggota_rombel.anggota_rombel_id)),1),o("td",W,u(N(c(t.all_nilai_akhir_pengetahuan,s.anggota_rombel.anggota_rombel_id),c(t.all_nilai_akhir_keterampilan,s.anggota_rombel.anggota_rombel_id),b(t.rasio_p),b(t.rasio_k))),1)],64))],64)):(a(),r("td",X,u(y(t.all_nilai_akhir_kurmer,s.anggota_pilihan)),1))],64))),256))]))),256))])]),_:1})):I("",!0)],64))]),_:1})}}};export{de as default};
