import{a as $,d as h}from"./mixins-D9sK_GNK.js";import{r,G as q,f as _,e as t,o as u,b as a,t as C,m as l,am as B,c as b,d as s,y as g,F as D,h as G,aa as K,ap as H,a2 as A,v as J}from"./main-BbIknAU_.js";import{_ as Q}from"./ConfirmDialog-CoWyGp8W.js";import{_ as W}from"./ProfileSiswa-CNtxoAVM.js";import{_ as X}from"./AppAutocomplete-Br1PWZIT.js";import{_ as Y}from"./AppTextField-bfe1muJ5.js";import{$ as R}from"./api-zDHFqD3S.js";import{V as Z,c as ee,a as ae,b as v}from"./VCard-DP6R80QM.js";import{V as N}from"./VDivider-AdngBwQk.js";import{V as w,a as f}from"./VRow-BRHNHyL4.js";import{V as te}from"./VTable-D6I1NIoz.js";import{V as le}from"./VForm-BMhz_qEl.js";import"./VDialog-AuNDjXN_.js";import"./VOverlay-CegGukY1.js";import"./forwardRefs-DWGaNmQL.js";import"./scopeId-Cm6oLMEy.js";import"./VImg-C0bob0hg.js";import"./VAvatar-DhWlB6rZ.js";import"./VLabel-BKB7GbBW.js";import"./VSelect-B8TBIhr3.js";import"./VList-CU7bhzU4.js";import"./ssrBoot-DItPKqse.js";import"./VMenu-RccmEXkB.js";import"./VSelectionControl-BTie8rgs.js";import"./VChip-L5Rr2CRm.js";import"./VSlideGroup-BPY7Rwgf.js";import"./filter-DNqhOXQ6.js";/* empty css                   */import"./VField-CiROKIcN.js";import"./index-BxkgbwWS.js";/* empty css              */const ie={class:"text-center"},Fe={__name:"penilaian",setup(ne){const o=r({semester_id:$.semester_id,user_id:h.user_id,guru_id:h.guru_id,sekolah_id:h.sekolah_id,periode_aktif:$.nama,data:null,nilai:{},rencana_ukk_id:null}),P=r({rencana_ukk_id:void 0}),m=r({body:!1,table:!1}),S=r(!1),c=r(!1),T=r([]),V=r([]),y=r(!1),p=r(!1),k=r({color:null,title:null,text:null});q(async()=>{o.value.data="rencana",m.value.body=!0,await x().then(()=>{m.value.body=!1})});const x=async()=>{await R("/ukk",{method:"POST",body:o.value,onResponse({response:i}){let e=i._data;o.value.data==="rencana"&&(T.value=e.rencana_ukk),V.value=e.data_siswa,e.data_siswa.forEach(d=>{o.value.nilai[`${d.peserta_didik_id}#${d.nilai_ukk.anggota_rombel_id}`]=d.nilai_ukk.nilai})}})},F=async i=>{o.value.data="siswa",o.value.rencana_ukk_id=i,m.value.table=!0,console.log(i),await x().then(()=>{m.value.table=!1,S.value=!0})},z=async()=>{c.value=!0,o.value.data="nilai",await R("/ukk/save",{method:"POST",body:o.value,onResponse({response:i}){let e=i._data;c.value=!1,e.errors?P.value=e.errors:(p.value=!0,k.value=e)}})},j=i=>{var e="";if(i.nilai_ukk&&i.nilai_ukk.nilai){var d=i.nilai_ukk.nilai;d>=70?e="Kompeten":e="Belum Kompeten"}return e},U=i=>{var e=null;return i.nilai_ukk.nilai&&(e=`/cetak/sertifikat/${i.nilai_ukk.anggota_rombel_id}/${i.nilai_ukk.rencana_ukk_id}`),e},E=async()=>{o.value.data="rencana",await x()};return(i,e)=>{const d=Y,I=X,L=W,M=Q;return u(),_(Z,{class:"mb-6"},{default:t(()=>[a(ae,{class:"pb-4"},{default:t(()=>[a(ee,null,{default:t(()=>e[3]||(e[3]=[C("Input Nilai UKK")])),_:1})]),_:1}),a(N),a(le,{onSubmit:H(z,["prevent"])},{default:t(()=>[l(m).body?(u(),_(v,{key:0,class:"text-center"},{default:t(()=>[a(B,{size:60,indeterminate:"",color:"error",class:"my-10"})]),_:1})):(u(),b(D,{key:1},[a(v,null,{default:t(()=>[a(w,null,{default:t(()=>[a(f,{cols:"12"},{default:t(()=>[a(w,{"no-gutters":""},{default:t(()=>[a(f,{cols:"12",md:"3",class:"d-flex align-items-center"},{default:t(()=>e[4]||(e[4]=[s("label",{class:"v-label text-body-2 text-high-emphasis",for:"semester_id"},"Tahun Pelajaran",-1)])),_:1}),a(f,{cols:"12",md:"9"},{default:t(()=>[a(d,{id:"semester_id",value:("$semester"in i?i.$semester:l($)).nama,disabled:""},null,8,["value"])]),_:1})]),_:1})]),_:1}),a(f,{cols:"12"},{default:t(()=>[a(w,{"no-gutters":""},{default:t(()=>[a(f,{cols:"12",md:"3",class:"d-flex align-items-center"},{default:t(()=>e[5]||(e[5]=[s("label",{class:"v-label text-body-2 text-high-emphasis",for:"rencana_ukk_id"},"Paket Kompetensi",-1)])),_:1}),a(f,{cols:"12",md:"9"},{default:t(()=>[a(I,{modelValue:l(o).rencana_ukk_id,"onUpdate:modelValue":[e[0]||(e[0]=n=>l(o).rencana_ukk_id=n),F],placeholder:"== Pilih Paket Kompetensi ==",items:l(T),clearable:"","clear-icon":"tabler-x","item-value":"rencana_ukk_id","item-title":"nama","error-messages":l(P).rencana_ukk_id},null,8,["modelValue","items","error-messages"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),l(m).table?(u(),_(v,{key:0,class:"text-center"},{default:t(()=>[a(B,{size:60,indeterminate:"",color:"error",class:"my-10"})]),_:1})):g("",!0),a(N),l(V).length?(u(),b(D,{key:1},[a(te,{class:"text-no-wrap"},{default:t(()=>[e[7]||(e[7]=s("thead",null,[s("tr",null,[s("th",null,"Nama Peserta Didik"),s("th",{class:"text-center"},"Nilai"),s("th",{class:"text-center"},"Kesimpan"),s("th",{class:"text-center"},"Cetak")])],-1)),s("tbody",null,[(u(!0),b(D,null,G(l(V),n=>(u(),b("tr",null,[s("td",null,[a(L,{item:n},null,8,["item"])]),s("td",null,[a(d,{modelValue:l(o).nilai[`${n.peserta_didik_id}#${n.nilai_ukk.anggota_rombel_id}`],"onUpdate:modelValue":O=>l(o).nilai[`${n.peserta_didik_id}#${n.nilai_ukk.anggota_rombel_id}`]=O},null,8,["modelValue","onUpdate:modelValue"])]),s("td",null,J(j(n)),1),s("td",ie,[U(n)?(u(),_(K,{key:0,"prepend-icon":"tabler-printer",color:"success",size:"small",href:U(n),target:"_blank"},{default:t(()=>e[6]||(e[6]=[C("Cetak")])),_:2},1032,["href"])):g("",!0)])]))),256))])]),_:1}),a(N)],64)):g("",!0),l(S)?(u(),_(v,{key:2,class:"d-flex justify-end flex-wrap gap-3 pt-5 overflow-visible"},{default:t(()=>[a(K,{variant:"elevated",type:"submit",loading:l(c),disabled:l(c)},{default:t(()=>e[8]||(e[8]=[C(" Simpan ")])),_:1},8,["loading","disabled"])]),_:1})):g("",!0)],64))]),_:1}),a(M,{isDialogVisible:l(y),"onUpdate:isDialogVisible":e[1]||(e[1]=n=>A(y)?y.value=n:null),isNotifVisible:l(p),"onUpdate:isNotifVisible":e[2]||(e[2]=n=>A(p)?p.value=n:null),"confirmation-question":"Apakah Anda yakin?","confirmation-text":"","confirm-color":l(k).color,"confirm-title":l(k).title,"confirm-msg":l(k).text,onClose:E},null,8,["isDialogVisible","isNotifVisible","confirm-color","confirm-title","confirm-msg"])]),_:1})}}};export{Fe as default};
