import{i as q,b as z}from"./validators-CXK_eVNV.js";import{G,r as m,c as k,b as a,e as o,m as e,a2 as N,F as V,o as b,t as T,ap as H,d as s,f as J,am as Q,y as R,h as B,aa as W,v as X}from"./main-4ibPTuoX.js";import{_ as Y}from"./ConfirmDialog-BLscZHWo.js";import{_ as Z}from"./AppTextField-Bdwte880.js";import{_ as ee}from"./ProfileSiswa-BlSG8edM.js";import{_ as ae}from"./AppAutocomplete-CQHIUyq3.js";import{d as w,a as S}from"./mixins-BjVJEZvR.js";import{$ as A}from"./api-Bkbcc4ec.js";import{V as le,a as te,c as ie,b as C}from"./VCard-CswHtBsG.js";import{V as oe}from"./VDivider-DBczu0Ow.js";import{V as re}from"./VForm-BUGxzJlr.js";import{V as U,a as g}from"./VRow-C9aDKUvo.js";import{V as se}from"./VTable-CFJBDt5I.js";import{V as I}from"./VTextarea-jhTeNlp4.js";import"./VDialog-BkAb0UEZ.js";import"./VOverlay-Dt1Dy2Gr.js";import"./forwardRefs-DWGaNmQL.js";import"./scopeId-DgdHYkHx.js";import"./VImg-B9UUOYt7.js";import"./VLabel-B0eCB5jg.js";/* empty css                   */import"./VField-DDWomVtf.js";import"./VAvatar-DuOErqu_.js";import"./VSelect-CJIVueWh.js";import"./VList-DRMF5v6F.js";import"./ssrBoot-CGBhTCaE.js";import"./VMenu-HPtXLDMp.js";import"./VSelectionControl-Dw3cA4UE.js";import"./VChip-ClHLREYK.js";import"./VSlideGroup-DECG9arN.js";import"./filter-CCPSJzNa.js";import"./index-BxkgbwWS.js";/* empty css              */const ne=["rowspan"],de={class:"align-top"},me={class:"align-top"},ue={class:"py-4"},pe={colspan:"3",class:"py-4"},He={__name:"penilaian",setup(_e){G(async()=>{d.value.rombel=!0,await y({data:"rombel"}).then(()=>{d.value.rombel=!1})});const P=m({user_id:w.user_id,guru_id:w.guru_id,sekolah_id:w.sekolah_id,semester_id:S.semester_id,periode_aktif:S.nama}),i=m({aksi:"nilai",rombongan_belajar_id:null,pkl_id:null,nilai:{},deskripsi:{},catatan:{}}),v=m({rombongan_belajar_id:null,pkl_id:null}),n=m({rombel:[],pkl:[],siswa:[],tp:[]}),d=m({rombel:!1,pkl:!1,body:!1}),y=async t=>{const l={...t,...P.value,...i.value};await A("/praktik-kerja-lapangan/get-data",{method:"POST",body:l,async onResponse({response:u}){let _=u._data;t.data=="rombel"&&(n.value.rombel=_),t.data=="pkl"&&(n.value.pkl=_),t.data=="siswa"&&(n.value.siswa=_.siswa,n.value.tp=_.tp,_.siswa.forEach(f=>{f.nilai_pkl.forEach(c=>{i.value.nilai[`${c.tp_id}#${f.peserta_didik_id}`]=c.nilai,i.value.deskripsi[`${c.tp_id}#${f.peserta_didik_id}`]=c.deskripsi}),i.value.catatan[f.peserta_didik_id]=f.pd_pkl.catatan}))}})},E=async t=>{i.value.pkl_id=null,n.value.pkl=[],t&&(d.value.pkl=!0,await y({data:"pkl"}).then(()=>{d.value.pkl=!1}))},L=async t=>{n.value.siswa=[],n.value.tp=[],t&&(d.value.body=!0,await y({data:"siswa"}).then(()=>{d.value.body=!1}))},F=m(),h=m(!1),$=m(!1),D=m(!1),x=m({color:null,title:null,text:null}),K=async()=>{var t;(t=F.value)==null||t.validate().then(({valid:l})=>{l&&M()})},M=async()=>{h.value=!0;const t={...P.value,...i.value};await A("/praktik-kerja-lapangan/save",{method:"POST",body:t,onResponse({response:l}){h.value=!1;let u=l._data;u.errors?v.value=u.errors:(O(),$.value=!0,x.value=u)}})},O=async()=>{i.value={aksi:"nilai",rombongan_belajar_id:null,pkl_id:null,nilai:{},deskripsi:{},catatan:{}},v.value={rombongan_belajar_id:null,pkl_id:null},n.value={rombel:[],pkl:[],siswa:[],tp:[]},d.value.rombel=!0,await y({data:"rombel"}).then(()=>{d.value.rombel=!1})};return(t,l)=>{const u=ae,_=ee,f=Z,c=Y;return b(),k(V,null,[a(le,{class:"mb-6"},{default:o(()=>[a(te,{class:"pb-4"},{default:o(()=>[a(ie,null,{default:o(()=>l[4]||(l[4]=[T("Input Penilaian PKL")])),_:1})]),_:1}),a(oe),a(re,{ref_key:"refVForm",ref:F,onSubmit:H(K,["prevent"])},{default:o(()=>[a(C,null,{default:o(()=>[a(U,null,{default:o(()=>[a(g,{cols:"12"},{default:o(()=>[a(U,{"no-gutters":""},{default:o(()=>[a(g,{cols:"12",md:"3",class:"d-flex align-items-center"},{default:o(()=>l[5]||(l[5]=[s("label",{class:"v-label text-body-2 text-high-emphasis",for:"rombongan_belajar_id"},"Rombongan Belajar",-1)])),_:1}),a(g,{cols:"12",md:"9"},{default:o(()=>[a(u,{modelValue:e(i).rombongan_belajar_id,"onUpdate:modelValue":[l[0]||(l[0]=r=>e(i).rombongan_belajar_id=r),E],placeholder:"== Pilih Rombongan Belajar == ",items:e(n).rombel,clearable:"","clear-icon":"tabler-x","item-value":"rombongan_belajar_id","item-title":"nama",loading:e(d).rombel,disabled:e(d).rombel,"error-messages":e(v).rombongan_belajar_id},null,8,["modelValue","items","loading","disabled","error-messages"])]),_:1})]),_:1})]),_:1}),a(g,{cols:"12"},{default:o(()=>[a(U,{"no-gutters":""},{default:o(()=>[a(g,{cols:"12",md:"3",class:"d-flex align-items-center"},{default:o(()=>l[6]||(l[6]=[s("label",{class:"v-label text-body-2 text-high-emphasis",for:"pkl_id"},"DUDI",-1)])),_:1}),a(g,{cols:"12",md:"9"},{default:o(()=>[a(u,{modelValue:e(i).pkl_id,"onUpdate:modelValue":[l[1]||(l[1]=r=>e(i).pkl_id=r),L],placeholder:"== Pilih DUDI == ",items:e(n).pkl,clearable:"","clear-icon":"tabler-x","item-value":"pkl_id","item-title":"nama_dudi",loading:e(d).pkl,disabled:e(d).pkl,"error-messages":e(v).pkl_id},null,8,["modelValue","items","loading","disabled","error-messages"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(d).body?(b(),J(C,{key:0,class:"text-center"},{default:o(()=>[a(Q,{size:60,indeterminate:"",color:"error"})]),_:1})):R("",!0),e(n).siswa.length?(b(),k(V,{key:1},[a(se,null,{default:o(()=>[l[7]||(l[7]=s("thead",null,[s("tr",null,[s("th",null,"Nama Peserta Didik"),s("th",null,"Tujuan Pembelajaran"),s("th",{class:"text-center"},"Nilai"),s("th",{class:"text-center"},"Deskripsi")])],-1)),s("tbody",null,[(b(!0),k(V,null,B(e(n).siswa,r=>(b(),k(V,null,[s("tr",null,[s("td",{class:"text-no-wrap border-right align-top",rowspan:e(n).tp.length+2},[a(_,{item:r},null,8,["item"])],8,ne)]),(b(!0),k(V,null,B(e(n).tp,p=>(b(),k("tr",null,[s("td",de,X(p.deskripsi),1),s("td",me,[a(f,{modelValue:e(i).nilai[`${p.tp_id}#${r.peserta_didik_id}`],"onUpdate:modelValue":j=>e(i).nilai[`${p.tp_id}#${r.peserta_didik_id}`]=j,rules:["integerValidator"in t?t.integerValidator:e(q),("betweenValidator"in t?t.betweenValidator:e(z))(e(i).nilai[`${p.tp_id}#${r.peserta_didik_id}`],0,100)],placeholder:"0-100"},null,8,["modelValue","onUpdate:modelValue","rules"])]),s("td",ue,[a(I,{label:"Deskripsi",modelValue:e(i).deskripsi[`${p.tp_id}#${r.peserta_didik_id}`],"onUpdate:modelValue":j=>e(i).deskripsi[`${p.tp_id}#${r.peserta_didik_id}`]=j},null,8,["modelValue","onUpdate:modelValue"])])]))),256)),s("tr",null,[s("td",pe,[a(I,{placeholder:"Catatan PKL...",modelValue:e(i).catatan[r.peserta_didik_id],"onUpdate:modelValue":p=>e(i).catatan[r.peserta_didik_id]=p},null,8,["modelValue","onUpdate:modelValue"])])])],64))),256))])]),_:1}),a(C,{class:"d-flex justify-end flex-wrap gap-3 pt-5"},{default:o(()=>[a(W,{variant:"elevated",type:"submit",loading:e(h),disabled:e(h)},{default:o(()=>l[8]||(l[8]=[T(" Simpan ")])),_:1},8,["loading","disabled"])]),_:1})],64)):R("",!0)]),_:1},512)]),_:1}),a(c,{isDialogVisible:e(D),"onUpdate:isDialogVisible":l[2]||(l[2]=r=>N(D)?D.value=r:null),isNotifVisible:e($),"onUpdate:isNotifVisible":l[3]||(l[3]=r=>N($)?$.value=r:null),"confirmation-question":"Apakah Anda yakin?","confirmation-text":"Tindakan ini tidak dapat dikembalikan!","confirm-color":e(x).color,"confirm-title":e(x).title,"confirm-msg":e(x).text,onConfirm:t.confirmDelete,onClose:t.confirmClose},null,8,["isDialogVisible","isNotifVisible","confirm-color","confirm-title","confirm-msg","onConfirm","onClose"])],64)}}};export{He as default};
