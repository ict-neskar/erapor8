import{_ as ue}from"./AnggotaRombelDialog-DKQF-yyX.js";import{_ as me}from"./AppAutocomplete-Cj-BYPX6.js";import{_ as ae}from"./AppSelect-D1gjRk4-.js";import{_ as te}from"./AppTextField-DGISkcON.js";import{$ as M}from"./api-CAM2bx0j.js";import{V as le,a as de,c as ce,b as pe}from"./VCard-DRBiftP4.js";import{V as ve,a as ge,b as fe}from"./VToolbarItems-DIy-tFz2.js";import{r as d,o as R,f as Y,e as n,b as e,aa as F,$ as q,t as S,v as j,d as r,c as G,am as be,F as ke,h as _e,m as s,y as Ve,a3 as ye,bd as he,bj as Pe,ay as xe,aB as je,aA as we,aS as Te,a6 as De,ae as Se,bk as Ce,aC as Ue,aE as $e,aG as Ae,aO as H,Q as Le,cj as Re,bo as Be,ck as Ie,bx as qe,w as O,G as oe,cl as Ke,Y as Ne,a7 as Ge,aI as Me,an as Fe,aj as Oe,q as W,bp as Qe,ap as ze,a2 as L}from"./main-DOWoIBhU.js";import{V as se}from"./VSpacer-D5BlabPF.js";import{V as Ee}from"./VTable-C1nYsmx8.js";import{V as Ye}from"./VChip-Tdr48uqn.js";import{V as ne}from"./VAvatar-B-Z9vLfD.js";import{V as He}from"./VDialog-BP5oy-x4.js";import{_ as We}from"./TablePagination-fG2MYBNV.js";import{u as Je,c as Xe}from"./createUrl-CexWNLWx.js";import{d as Ze,a as E,$ as ea}from"./mixins-I8SXeutZ.js";import{V as J}from"./VDivider-DgEwy873.js";import{V as aa}from"./VDataTableServer-BNn81j7f.js";import{V as ta}from"./VImg-DYyAcwaz.js";import{V as la}from"./VMenu-DeAbbdJl.js";import{V as oa,a as X,b as Z}from"./VList-DWH4RJSa.js";import{m as sa,u as na,V as ee}from"./VOverlay-Cnf91z5i.js";import{f as ra}from"./forwardRefs-DWGaNmQL.js";const ia={key:0},ua={class:"text-center",colspan:"8"},ma={class:"text-center"},da={class:"text-center"},ca={key:2},pa={__name:"PembelajaranDialog",props:{isDialogVisible:{type:Boolean,required:!0},isLoading:{type:Boolean,required:!0},dialogTitle:{type:String,required:!0},listData:{type:Array,required:!0},listGuru:{type:Array,required:!0},listKelompok:{type:Array,required:!0}},emits:["update:isDialogVisible","save","refresh"],setup(l,{emit:f}){const c=l,t=v=>{y("update:isDialogVisible",v)},y=f,w=async()=>{y("save")},p=d([]),C=async v=>{p.value[v]=!0,await M("/referensi/rombongan-belajar/hapus-pembelajaran",{method:"POST",body:{pembelajaran_id:v},onResponse(){p.value[v]=!1,y("refresh")}})};return(v,m)=>{const b=te,h=ae,x=me;return R(),Y(He,{"model-value":c.isDialogVisible,"onUpdate:modelValue":t,fullscreen:"",scrim:!1,transition:"dialog-bottom-transition"},{default:n(()=>[e(le,null,{default:n(()=>[e(ve,{color:"primary",class:"sticky-header"},{default:n(()=>[e(F,{icon:"",variant:"plain",onClick:m[0]||(m[0]=i=>t(!1))},{default:n(()=>[e(q,{color:"white",icon:"tabler-x"})]),_:1}),e(ge,null,{default:n(()=>[S(j(l.dialogTitle),1)]),_:1}),e(se),e(fe,null,{default:n(()=>[e(F,{variant:"text",onClick:w},{default:n(()=>[e(q,{icon:"tabler-device-floppy",class:"me-2"}),m[1]||(m[1]=S(" Simpan "))]),_:1})]),_:1})]),_:1}),e(Ee,{class:"permission-table mb-6"},{default:n(()=>[m[3]||(m[3]=r("thead",null,[r("tr",null,[r("th",{class:"text-center"},"No"),r("th",{class:"text-center"},"Mata Pelajaran"),r("th",{class:"text-center"},"ID Mapel"),r("th",{class:"text-center"},"Guru Mapel (Dapodik)"),r("th",{class:"text-center"},"Guru Pengajar"),r("th",{class:"text-center"},"Kelompok"),r("th",{class:"text-center"},"Nomor Urut"),r("th",{class:"text-center"},"Reset")])],-1)),r("tbody",null,[l.isLoading?(R(),G("tr",ia,[r("td",ua,[e(be,{size:60,indeterminate:"",color:"error",class:"my-10"})])])):l.listData.length?(R(!0),G(ke,{key:1},_e(l.listData,(i,P)=>(R(),G("tr",null,[r("td",ma,j(P+1),1),r("td",null,[e(b,{modelValue:i.nama_mata_pelajaran,"onUpdate:modelValue":u=>i.nama_mata_pelajaran=u},null,8,["modelValue","onUpdate:modelValue"])]),r("td",null,[e(b,{modelValue:i.mata_pelajaran_id,"onUpdate:modelValue":u=>i.mata_pelajaran_id=u,disabled:""},null,8,["modelValue","onUpdate:modelValue"])]),r("td",null,[e(h,{modelValue:i.guru_id,"onUpdate:modelValue":u=>i.guru_id=u,items:l.listGuru,"item-title":"nama_lengkap","item-value":"guru_id",disabled:""},{selection:n(({item:u})=>[e(Ye,null,{prepend:n(()=>[e(ne,{start:"",image:u.raw.photo},null,8,["image"])]),default:n(()=>[r("span",null,j(u.raw.nama_lengkap),1)]),_:2},1024)]),_:2},1032,["modelValue","onUpdate:modelValue","items"])]),r("td",null,[e(x,{items:l.listGuru,placeholder:"== Pilih Guru Pengajar ==","item-title":"nama_lengkap","item-value":"guru_id",modelValue:i.guru_pengajar_id,"onUpdate:modelValue":u=>i.guru_pengajar_id=u},null,8,["items","modelValue","onUpdate:modelValue"])]),r("td",null,[e(x,{items:l.listKelompok,placeholder:"== Pilih Kelompok ==","item-title":"nama_kelompok","item-value":"kelompok_id",modelValue:i.kelompok_id,"onUpdate:modelValue":u=>i.kelompok_id=u},null,8,["items","modelValue","onUpdate:modelValue"])]),r("td",null,[e(b,{modelValue:i.no_urut,"onUpdate:modelValue":u=>i.no_urut=u},null,8,["modelValue","onUpdate:modelValue"])]),r("td",da,[i.kelompok_id&&i.no_urut?(R(),Y(F,{key:0,loading:s(p)[i.pembelajaran_id],disabled:s(p)[i.pembelajaran_id],color:"error",icon:"tabler-trash",onClick:u=>C(i.pembelajaran_id)},null,8,["loading","disabled","onClick"])):Ve("",!0)])]))),256)):(R(),G("tr",ca,m[2]||(m[2]=[r("td",{class:"text-center",colspan:"8"},"Tidak ada untuk ditampilkan",-1)])))])]),_:1})]),_:1})]),_:1},8,["model-value"])}}};function va(l){const f=H(l());let c=-1;function t(){clearInterval(c)}function y(){t(),ze(()=>f.value=l())}function w(p){const C=p?getComputedStyle(p):{transitionDuration:.2},v=parseFloat(C.transitionDuration)*1e3||200;if(t(),f.value<=0)return;const m=performance.now();c=window.setInterval(()=>{const b=performance.now()-m+v;f.value=Math.max(l()-b,0),f.value<=0&&t()},v)}return Qe(t),{clear:t,time:f,start:w,reset:y}}const ga=ye({multiLine:Boolean,text:String,timer:[Boolean,String],timeout:{type:[Number,String],default:5e3},vertical:Boolean,...he({location:"bottom"}),...Pe(),...xe(),...je(),...we(),...Te(sa({transition:"v-snackbar-transition"}),["persistent","noClickAnimation","scrim","scrollStrategy"])},"VSnackbar"),fa=De()({name:"VSnackbar",props:ga(),emits:{"update:modelValue":l=>!0},setup(l,f){let{slots:c}=f;const t=Se(l,"modelValue"),{positionClasses:y}=Ce(l),{scopeId:w}=na(),{themeClasses:p}=Ue(l),{colorClasses:C,colorStyles:v,variantClasses:m}=$e(l),{roundedClasses:b}=Ae(l),h=va(()=>Number(l.timeout)),x=d(),i=d(),P=H(!1),u=H(0),B=d(),k=Le(Re,void 0);Be(()=>!!k,()=>{const a=Ie();qe(()=>{B.value=a.mainStyles.value})}),O(t,T),O(()=>l.timeout,T),oe(()=>{t.value&&T()});let U=-1;function T(){h.reset(),window.clearTimeout(U);const a=Number(l.timeout);if(!t.value||a===-1)return;const g=Ke(i.value);h.start(g),U=window.setTimeout(()=>{t.value=!1},a)}function K(){h.reset(),window.clearTimeout(U)}function I(){P.value=!0,K()}function N(){P.value=!1,T()}function Q(a){u.value=a.touches[0].clientY}function $(a){Math.abs(u.value-a.changedTouches[0].clientY)>50&&(t.value=!1)}function z(){P.value&&N()}const _=Ne(()=>l.location.split(" ").reduce((a,g)=>(a[`v-snackbar--${g}`]=!0,a),{}));return Ge(()=>{const a=ee.filterProps(l),g=!!(c.default||c.text||l.text);return e(ee,W({ref:x,class:["v-snackbar",{"v-snackbar--active":t.value,"v-snackbar--multi-line":l.multiLine&&!l.vertical,"v-snackbar--timer":!!l.timer,"v-snackbar--vertical":l.vertical},_.value,y.value,l.class],style:[B.value,l.style]},a,{modelValue:t.value,"onUpdate:modelValue":D=>t.value=D,contentProps:W({class:["v-snackbar__wrapper",p.value,C.value,b.value,m.value],style:[v.value],onPointerenter:I,onPointerleave:N},a.contentProps),persistent:!0,noClickAnimation:!0,scrim:!1,scrollStrategy:"none",_disableGlobalStack:!0,onTouchstartPassive:Q,onTouchend:$,onAfterLeave:z},w),{default:()=>{var D,V;return[Me(!1,"v-snackbar"),l.timer&&!P.value&&e("div",{key:"timer",class:"v-snackbar__timer"},[e(Fe,{ref:i,color:typeof l.timer=="string"?l.timer:"info",max:l.timeout,"model-value":h.time.value},null)]),g&&e("div",{key:"content",class:"v-snackbar__content",role:"status","aria-live":"polite"},[((D=c.text)==null?void 0:D.call(c))??l.text,(V=c.default)==null?void 0:V.call(c)]),c.actions&&e(Oe,{defaults:{VBtn:{variant:"text",ripple:!1,slim:!0}}},{default:()=>[e("div",{class:"v-snackbar__actions"},[c.actions({isActive:t})])]})]},activator:c.activator})}),ra({},x)}}),ba={class:"d-flex gap-2 align-center"},ka={class:"d-flex align-center flex-wrap gap-4"},_a={class:"d-flex align-center gap-x-4"},Va={class:"d-flex flex-column"},ya={class:"text-base"},ha={class:"text-sm"},za={__name:"RombonganBelajar",props:{cardTitle:{type:String,required:!0},jenisRombel:{type:Number,required:!0}},setup(l){const f=l,c=[{title:"Nama",key:"nama",sortable:!0,nowrap:!0},{title:"Wali Kelas",key:"wali_kelas",sortable:!1},{title:"Tingkat",key:"tingkat",align:"center",sortable:!0},{title:"Program/Kompetensi Keahlian",key:"jurusan_sp",sortable:!1},{title:"Kurikulum",key:"kurikulum",sortable:!1},{title:"aksi",key:"aksi",align:"center",sortable:!1}],t=d({page:1,itemsPerPage:10,searchQuery:"",selectedRole:null,sortby:"tingkat",sortbydesc:"ASC"}),y=d(!1),w=d([]),p=d(0),C=_=>{var a,g;t.value.sortby=(a=_[0])==null?void 0:a.key,t.value.sortbydesc=(g=_[0])==null?void 0:g.order},v=async()=>{y.value=!0;try{let a=(await Je(Xe("/referensi/rombongan-belajar",{query:{jenis_rombel:f.jenisRombel,sekolah_id:Ze.sekolah_id,semester_id:E.semester_id,periode_aktif:E.nama,q:t.value.searchQuery,page:t.value.page,per_page:t.value.itemsPerPage,sortby:t.value.sortby,sortbydesc:t.value.sortbydesc}}))).data.value;w.value=a.data.data,p.value=a.data.total}catch(_){console.error(_)}finally{y.value=!1}};oe(async()=>{await v()}),O(t,async()=>{await v()},{deep:!0}),O(()=>t.value.searchQuery,()=>{t.value.page=1});const m=d(),b=d(!1),h=d(!1),x=d(""),i=d([]),P=d([]),u=d([]),B=d([]),k=d(!1),U=d(""),T=d(""),K=async _=>{k.value=!0,m.value=_,h.value=!0,await M("/referensi/rombongan-belajar/anggota-rombel",{method:"POST",body:{rombongan_belajar_id:m.value},onResponse({request:a,response:g,options:D}){let V=g._data;x.value=`Anggota Rombel Kelas ${V.rombel.nama}`,P.value=V.data,k.value=!1}})},I=async _=>{k.value=!0,m.value=_,b.value=!0,await M("/referensi/rombongan-belajar/pembelajaran",{method:"POST",body:{rombongan_belajar_id:m.value,sekolah_id:ea.sekolah_id,semester_id:E.semester_id},onResponse({request:a,response:g,options:D}){let V=g._data;x.value=`Pembelajaran Kelas ${V.rombel.nama}`,i.value=V.data,u.value=V.guru,B.value=V.kelompok,k.value=!1}})},N=async()=>{U.value="Pembelajaran berhasil dihapus",T.value="bottom",$.value=!0,I(m.value)},Q=async()=>{K(m.value)},$=d(!1),z=async()=>{await M("/referensi/rombongan-belajar/simpan-pembelajaran",{method:"POST",body:i.value,onResponse(){U.value="Pembelajaran berhasil disimpan",T.value="top",$.value=!0,I(m.value)}})};return(_,a)=>{const g=ae,D=te,V=We,re=pa,ie=ue;return R(),Y(le,null,{default:n(()=>[e(de,{class:"pb-4"},{default:n(()=>[e(ce,null,{default:n(()=>[S(j(f.cardTitle),1)]),_:1})]),_:1}),e(J),e(pe,{class:"d-flex flex-wrap gap-4"},{default:n(()=>[r("div",ba,[e(g,{modelValue:s(t).itemsPerPage,"onUpdate:modelValue":a[0]||(a[0]=o=>s(t).itemsPerPage=o),items:[{value:10,title:"10"},{value:25,title:"25"},{value:50,title:"50"},{value:100,title:"100"}],style:{"inline-size":"15.5rem"}},null,8,["modelValue"])]),e(se),r("div",ka,[e(D,{modelValue:s(t).searchQuery,"onUpdate:modelValue":a[1]||(a[1]=o=>s(t).searchQuery=o),placeholder:"Cari data",style:{"inline-size":"15.625rem"}},null,8,["modelValue"])])]),_:1}),e(J),e(aa,{page:s(t).page,"onUpdate:page":a[3]||(a[3]=o=>s(t).page=o),"items-per-page":s(t).itemsPerPage,"items-per-page-options":[{value:10,title:"10"},{value:20,title:"20"},{value:50,title:"50"}],items:s(w),"server-items-length":s(p),"items-length":s(p),headers:c,"items-per-page-text":"Item",options:s(t),loading:s(y),"loading-text":"Loading...","onUpdate:sortBy":C,"header-props":{class:"text-no-wrap"}},{"item.wali_kelas":n(({item:o})=>[r("div",_a,[e(ne,{size:"34",variant:o.wali_kelas.photo?void 0:"tonal",color:o.wali_kelas.photo?void 0:"success"},{default:n(()=>[e(ta,{src:o.wali_kelas.photo},null,8,["src"])]),_:2},1032,["variant","color"]),r("div",Va,[r("h6",ya,j(o.wali_kelas.nama_lengkap),1),r("div",ha,j(o.wali_kelas.email),1)])])]),"item.jurusan_sp":n(({item:o})=>{var A;return[S(j((A=o.jurusan_sp)==null?void 0:A.nama_jurusan_sp),1)]}),"item.kurikulum":n(({item:o})=>{var A;return[S(j((A=o.kurikulum)==null?void 0:A.nama_kurikulum),1)]}),"item.aksi":n(({item:o})=>[e(F,{icon:"",variant:"text",color:"medium-emphasis"},{default:n(()=>[e(q,{icon:"tabler-dots-vertical"}),e(la,{activator:"parent"},{default:n(()=>[e(oa,null,{default:n(()=>[e(X,{onClick:A=>K(o.rombongan_belajar_id)},{prepend:n(()=>[e(q,{icon:"tabler-users-group"})]),default:n(()=>[e(Z,null,{default:n(()=>a[11]||(a[11]=[S("Anggota Rombel")])),_:1})]),_:2},1032,["onClick"]),e(X,{onClick:A=>I(o.rombongan_belajar_id)},{prepend:n(()=>[e(q,{icon:"tabler-list"})]),default:n(()=>[e(Z,null,{default:n(()=>a[12]||(a[12]=[S("Pembelajaran")])),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),bottom:n(()=>[e(V,{page:s(t).page,"onUpdate:page":a[2]||(a[2]=o=>s(t).page=o),"items-per-page":s(t).itemsPerPage,"total-items":s(p)},null,8,["page","items-per-page","total-items"])]),_:1},8,["page","items-per-page","items","server-items-length","items-length","options","loading"]),e(re,{isDialogVisible:s(b),"onUpdate:isDialogVisible":a[4]||(a[4]=o=>L(b)?b.value=o:null),isLoading:s(k),"onUpdate:isLoading":a[5]||(a[5]=o=>L(k)?k.value=o:null),"dialog-title":s(x),listData:s(i),"onUpdate:listData":a[6]||(a[6]=o=>L(i)?i.value=o:null),"list-guru":s(u),"list-kelompok":s(B),onSave:z,onRefresh:N},null,8,["isDialogVisible","isLoading","dialog-title","listData","list-guru","list-kelompok"]),e(ie,{isDialogVisible:s(h),"onUpdate:isDialogVisible":a[7]||(a[7]=o=>L(h)?h.value=o:null),isLoading:s(k),"onUpdate:isLoading":a[8]||(a[8]=o=>L(k)?k.value=o:null),"dialog-title":s(x),listData:s(P),"onUpdate:listData":a[9]||(a[9]=o=>L(P)?P.value=o:null),onRefresh:Q},null,8,["isDialogVisible","isLoading","dialog-title","listData"]),e(fa,{modelValue:s($),"onUpdate:modelValue":a[10]||(a[10]=o=>L($)?$.value=o:null),color:"success",location:s(T)},{default:n(()=>[S(j(s(U)),1)]),_:1},8,["modelValue","location"])]),_:1})}}};export{za as _};
