import{_ as F}from"./ConfirmDialog-CY_9uydO.js";import{_ as R}from"./AppTextField-BYQvWqvk.js";import{_ as S}from"./ProfileSiswa-BoXX9sbX.js";import{G as B,r as s,f as k,e as n,o as m,b as l,t as w,m as e,c as x,am as A,F as D,ap as E,d as i,h as P,y as C,aa as q,a2 as N}from"./main-BpmS5yjl.js";import{d as h,a as U}from"./mixins-CToSDW15.js";import{u as I,c as K}from"./createUrl-jHsYqGLm.js";import{$ as M}from"./api-CqoQuUrQ.js";import{V as O,c as j,a as G,b as T}from"./VCard-CHmpSx-c.js";import{V as L}from"./VDivider-gWeRf3Xl.js";import{V as H}from"./VForm-BtS5s1QD.js";import{V as J}from"./VTable-DH5oZuZ_.js";import"./VDialog-DmAehLsX.js";import"./VOverlay-yY7p8is2.js";import"./forwardRefs-DWGaNmQL.js";import"./scopeId-DiP191uI.js";import"./VImg-1iDcvPVu.js";import"./VLabel-D6Y69236.js";/* empty css                   */import"./VField-Cktymv3Q.js";import"./VAvatar-CwdAusxZ.js";import"./index-BxkgbwWS.js";const ba={__name:"ketidakhadiran",setup(Q){B(async()=>{await z()});const v=s({body:!1,table:!1}),d=s({user_id:h.user_id,guru_id:h.guru_id,sekolah_id:h.sekolah_id,semester_id:U.semester_id,periode_aktif:U.nama,aksi:"ketidakhadiran"}),r=s({sakit:{},izin:{},alpa:{}}),p=s({siswa:[]}),_=s(!1),y=s(!1),c=s(!1),b=s({color:null,title:null,text:null});s({dudi_id:null});const z=async()=>{v.value.body=!0;try{let a=(await I(K("/walas",{query:{user_id:d.value.user_id,guru_id:d.value.guru_id,sekolah_id:d.value.sekolah_id,semester_id:d.value.semester_id,periode_aktif:d.value.nama,aksi:d.value.aksi}}))).data.value;p.value.siswa=a.data_siswa,a.data_siswa.forEach(o=>{var u,V,t;r.value.sakit[o.anggota_rombel.anggota_rombel_id]=((u=o.anggota_rombel.absensi)==null?void 0:u.sakit)??0,r.value.izin[o.anggota_rombel.anggota_rombel_id]=((V=o.anggota_rombel.absensi)==null?void 0:V.izin)??0,r.value.alpa[o.anggota_rombel.anggota_rombel_id]=((t=o.anggota_rombel.absensi)==null?void 0:t.alpa)??0})}catch(f){console.error(f)}finally{v.value.body=!1}},$=async()=>{_.value=!0;const f={...d.value,...r.value};await M("/walas/save",{method:"POST",body:f,onResponseError({response:a}){console.log("ERROR:",a._data.errors),_.value=!1},onResponse({response:a}){_.value=!1;let o=a._data;o.errors||(c.value=!0,b.value=o)}})};return(f,a)=>{const o=S,u=R,V=F;return m(),k(O,null,{default:n(()=>[l(G,{class:"pb-4"},{default:n(()=>[l(j,null,{default:n(()=>a[2]||(a[2]=[w("Ketidakhadiran")])),_:1})]),_:1}),e(v).body?(m(),x(D,{key:0},[l(L),l(T,{class:"text-center"},{default:n(()=>[l(A,{size:60,indeterminate:"",color:"error",class:"my-10"})]),_:1})],64)):(m(),k(H,{key:1,onSubmit:E($,["prevent"])},{default:n(()=>[e(p).siswa.length?(m(),k(J,{key:0},{default:n(()=>[a[3]||(a[3]=i("thead",null,[i("tr",null,[i("th",{class:"text-center"},"Nama Peserta Didik"),i("th",{class:"text-center"},"Sakit"),i("th",{class:"text-center"},"Izin"),i("th",{class:"text-center"},"Tanpa Keterangan")])],-1)),i("tbody",null,[(m(!0),x(D,null,P(e(p).siswa,t=>(m(),x("tr",null,[i("td",null,[l(o,{item:t},null,8,["item"])]),i("td",null,[l(u,{modelValue:e(r).sakit[t.anggota_rombel.anggota_rombel_id],"onUpdate:modelValue":g=>e(r).sakit[t.anggota_rombel.anggota_rombel_id]=g},null,8,["modelValue","onUpdate:modelValue"])]),i("td",null,[l(u,{modelValue:e(r).izin[t.anggota_rombel.anggota_rombel_id],"onUpdate:modelValue":g=>e(r).izin[t.anggota_rombel.anggota_rombel_id]=g},null,8,["modelValue","onUpdate:modelValue"])]),i("td",null,[l(u,{modelValue:e(r).alpa[t.anggota_rombel.anggota_rombel_id],"onUpdate:modelValue":g=>e(r).alpa[t.anggota_rombel.anggota_rombel_id]=g},null,8,["modelValue","onUpdate:modelValue"])])]))),256))])]),_:1})):C("",!0),e(p).siswa.length?(m(),k(T,{key:1,class:"d-flex justify-end flex-wrap gap-3 pt-5 overflow-visible"},{default:n(()=>[l(q,{variant:"elevated",type:"submit",loading:e(_),disabled:e(_)},{default:n(()=>a[4]||(a[4]=[w(" Simpan ")])),_:1},8,["loading","disabled"])]),_:1})):C("",!0)]),_:1})),l(V,{isDialogVisible:e(y),"onUpdate:isDialogVisible":a[0]||(a[0]=t=>N(y)?y.value=t:null),isNotifVisible:e(c),"onUpdate:isNotifVisible":a[1]||(a[1]=t=>N(c)?c.value=t:null),"confirmation-question":"Apakah Anda yakin?","confirmation-text":"Tindakan ini tidak dapat dikembalikan!","confirm-color":e(b).color,"confirm-title":e(b).title,"confirm-msg":e(b).text},null,8,["isDialogVisible","isNotifVisible","confirm-color","confirm-title","confirm-msg"])]),_:1})}}};export{ba as default};
