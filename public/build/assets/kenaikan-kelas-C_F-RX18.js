import{_ as F}from"./ConfirmDialog-CY_9uydO.js";import{_ as R}from"./AppTextField-BYQvWqvk.js";import{_ as B}from"./AppAutocomplete-CoTPRzAH.js";import{_ as K}from"./ProfileSiswa-BoXX9sbX.js";import{G as P,r as i,f as v,e as m,o as u,b as r,t as D,m as e,c as h,am as E,F as j,ap as q,d as s,h as M,y as C,aa as O,a2 as N}from"./main-BpmS5yjl.js";import{d as w,a as $}from"./mixins-CToSDW15.js";import{u as z,c as G}from"./createUrl-jHsYqGLm.js";import{$ as I}from"./api-CqoQuUrQ.js";import{V as L,c as H,a as J,b as S}from"./VCard-CHmpSx-c.js";import{V as Q}from"./VDivider-gWeRf3Xl.js";import{V as W}from"./VForm-BtS5s1QD.js";import{V as X}from"./VTable-DH5oZuZ_.js";import"./VDialog-DmAehLsX.js";import"./VOverlay-yY7p8is2.js";import"./forwardRefs-DWGaNmQL.js";import"./scopeId-DiP191uI.js";import"./VImg-1iDcvPVu.js";import"./VLabel-D6Y69236.js";/* empty css                   */import"./VField-Cktymv3Q.js";import"./VSelect-D2E-ncti.js";import"./VList-CAazeH9Z.js";import"./ssrBoot-C9ygE__7.js";import"./VAvatar-CwdAusxZ.js";import"./VMenu-RpUw0xGr.js";import"./VSelectionControl-Bjw4k3ug.js";import"./VChip-Ce3c0jwR.js";import"./VSlideGroup-ZqIn0ESw.js";import"./filter-B41lvxns.js";import"./index-BxkgbwWS.js";const $a={__name:"kenaikan-kelas",setup(Y){P(async()=>{await T()});const y=i({body:!1}),d=i({user_id:w.user_id,guru_id:w.guru_id,sekolah_id:w.sekolah_id,semester_id:$.semester_id,periode_aktif:$.nama,aksi:"kenaikan-kelas"}),t=i({status:{},nama_kelas:{},rombongan_belajar_id:{},id_rombel:null}),_=i({siswa:[],options:[]}),p=i(!1),x=i(!1),b=i(!1),f=i({color:null,title:null,text:null}),T=async()=>{var g;y.value.body=!0;try{let l=(await z(G("/walas",{query:{user_id:d.value.user_id,guru_id:d.value.guru_id,sekolah_id:d.value.sekolah_id,semester_id:d.value.semester_id,periode_aktif:d.value.nama,aksi:d.value.aksi}}))).data.value;_.value.siswa=l.data_siswa,_.value.options=l.options,t.value.id_rombel=(g=l.rombel)==null?void 0:g.rombongan_belajar_id,l.data_siswa.forEach(n=>{var c,k,o;t.value.status[n.anggota_rombel.anggota_rombel_id]=((c=n.anggota_rombel.single_kenaikan_kelas)==null?void 0:c.status)??null,t.value.nama_kelas[n.anggota_rombel.anggota_rombel_id]=((k=n.anggota_rombel.single_kenaikan_kelas)==null?void 0:k.nama_kelas)??null,t.value.rombongan_belajar_id[n.anggota_rombel.anggota_rombel_id]=((o=n.anggota_rombel.single_kenaikan_kelas)==null?void 0:o.rombongan_belajar_id)??null})}catch(a){console.error(a)}finally{y.value.body=!1}},U=async()=>{p.value=!0;const g={...d.value,...t.value};await I("/walas/save",{method:"POST",body:g,onResponseError({response:a}){console.log("ERROR:",a._data.errors),p.value=!1},onResponse({response:a}){p.value=!1;let l=a._data;l.errors||(b.value=!0,f.value=l)}})},A=async(g,a,l)=>{};return(g,a)=>{const l=K,n=B,c=R,k=F;return u(),v(L,null,{default:m(()=>[r(J,{class:"pb-4"},{default:m(()=>[r(H,null,{default:m(()=>a[2]||(a[2]=[D("Kenaikan Kelas")])),_:1})]),_:1}),e(y).body?(u(),h(j,{key:0},[r(Q),r(S,{class:"text-center"},{default:m(()=>[r(E,{size:60,indeterminate:"",color:"error",class:"my-10"})]),_:1})],64)):(u(),v(W,{key:1,onSubmit:q(U,["prevent"])},{default:m(()=>[e(_).siswa.length?(u(),v(X,{key:0},{default:m(()=>[a[3]||(a[3]=s("thead",null,[s("tr",null,[s("th",{class:"text-center"},"Nama Peserta Didik"),s("th",{class:"text-center"},"Status Kenaikan"),s("th",{class:"text-center"},"Kelas Tujuan")])],-1)),s("tbody",null,[(u(!0),h(j,null,M(e(_).siswa,o=>(u(),h("tr",null,[s("td",null,[r(l,{item:o},null,8,["item"])]),s("td",null,[r(n,{id:"rombongan_belajar_id",modelValue:e(t).status[o.anggota_rombel.anggota_rombel_id],"onUpdate:modelValue":[V=>e(t).status[o.anggota_rombel.anggota_rombel_id]=V,V=>A(e(t).status[o.anggota_rombel.anggota_rombel_id],o.anggota_rombel.anggota_rombel_id,o.anggota_rombel.rombongan_belajar_id)],placeholder:"== Pilih Status Kenaikan ==",items:e(_).options,clearable:"","clear-icon":"tabler-x"},null,8,["modelValue","onUpdate:modelValue","items"])]),s("td",null,[r(c,{modelValue:e(t).nama_kelas[o.anggota_rombel.anggota_rombel_id],"onUpdate:modelValue":V=>e(t).nama_kelas[o.anggota_rombel.anggota_rombel_id]=V},null,8,["modelValue","onUpdate:modelValue"])])]))),256))])]),_:1})):C("",!0),e(_).siswa.length?(u(),v(S,{key:1,class:"d-flex justify-end flex-wrap gap-3 pt-5 overflow-visible"},{default:m(()=>[r(O,{variant:"elevated",type:"submit",loading:e(p),disabled:e(p)},{default:m(()=>a[4]||(a[4]=[D(" Simpan ")])),_:1},8,["loading","disabled"])]),_:1})):C("",!0)]),_:1})),r(k,{isDialogVisible:e(x),"onUpdate:isDialogVisible":a[0]||(a[0]=o=>N(x)?x.value=o:null),isNotifVisible:e(b),"onUpdate:isNotifVisible":a[1]||(a[1]=o=>N(b)?b.value=o:null),"confirmation-question":"Apakah Anda yakin?","confirmation-text":"Tindakan ini tidak dapat dikembalikan!","confirm-color":e(f).color,"confirm-title":e(f).title,"confirm-msg":e(f).text},null,8,["isDialogVisible","isNotifVisible","confirm-color","confirm-title","confirm-msg"])]),_:1})}}};export{$a as default};
