import{_ as ue}from"./AnggotaRombelDialog-CLGlZnyT.js";import{_ as me}from"./AppAutocomplete-DAT5lBen.js";import{_ as ae}from"./AppSelect-B2PHoo-x.js";import{_ as te}from"./AppTextField-BO6w-NjC.js";import{$ as M}from"./api-CbnF2F_N.js";import{V as le,a as de,c as ce,b as pe}from"./VCard-DkQKJDRB.js";import{V as ve,a as ge,b as fe}from"./VToolbarItems-CJ3fyS6d.js";import{r as d,o as R,f as E,e as n,b as e,aa as G,$ as I,t as S,v as j,d as r,c as F,am as be,F as _e,h as ke,m as s,y as Ve,a3 as ye,bd as he,bj as Pe,az as xe,aC as je,aB as Te,aT as we,a6 as De,ae as Se,bk as Ce,aD as Ue,aF as $e,aH as Le,aP as H,Q as Ae,cn as Re,bo as Be,co as qe,bx as Ie,w as O,G as oe,cp as Ke,Y as Ne,a7 as Fe,aJ as Me,ao as Ge,aj as Oe,q as J,bp as Qe,aq as ze,a2 as A}from"./main-BpzOKNoA.js";import{V as se}from"./VSpacer-D8Y2KROC.js";import{V as Ye}from"./VTable-DuVTcngC.js";import{V as Ee}from"./VChip-DVAuZVH0.js";import{V as ne}from"./VAvatar-Ddpywjbl.js";import{V as He}from"./VDialog-BIu7mksy.js";import{_ as Je}from"./TablePagination-tXgFpqyX.js";import{u as We,c as Xe}from"./createUrl-BXcv10L8.js";import{d as Ze,a as Y,$ as ea}from"./mixins-Do01Tvpi.js";import{V as W}from"./VDivider-Dhg7eMF0.js";import{V as aa}from"./VDataTableServer-Dpmy7Q46.js";import{V as ta}from"./VImg-BbE4AfBU.js";import{V as la}from"./VMenu-BjIWR5X6.js";import{V as oa,a as X,b as Z}from"./VList-CxLNrE2t.js";import{m as sa,V as ee}from"./VOverlay-CaqnmWII.js";import{f as na}from"./forwardRefs-DWGaNmQL.js";import{u as ra}from"./scopeId-D8AFld2n.js";const ia={key:0},ua={class:"text-center",colspan:"8"},ma={class:"text-center"},da={class:"text-center"},ca={key:2},pa={__name:"PembelajaranDialog",props:{isDialogVisible:{type:Boolean,required:!0},isLoading:{type:Boolean,required:!0},dialogTitle:{type:String,required:!0},listData:{type:Array,required:!0},listGuru:{type:Array,required:!0},listKelompok:{type:Array,required:!0}},emits:["update:isDialogVisible","save","refresh"],setup(l,{emit:f}){const c=l,t=v=>{y("update:isDialogVisible",v)},y=f,T=async()=>{y("save")},p=d([]),C=async v=>{p.value[v]=!0,await M("/referensi/rombongan-belajar/hapus-pembelajaran",{method:"POST",body:{pembelajaran_id:v},onResponse(){p.value[v]=!1,y("refresh")}})};return(v,m)=>{const b=te,h=ae,x=me;return R(),E(He,{"model-value":c.isDialogVisible,"onUpdate:modelValue":t,fullscreen:"",scrim:!1,transition:"dialog-bottom-transition"},{default:n(()=>[e(le,null,{default:n(()=>[e(ve,{color:"primary",class:"sticky-header"},{default:n(()=>[e(G,{icon:"",variant:"plain",onClick:m[0]||(m[0]=i=>t(!1))},{default:n(()=>[e(I,{color:"white",icon:"tabler-x"})]),_:1}),e(ge,null,{default:n(()=>[S(j(l.dialogTitle),1)]),_:1}),e(se),e(fe,null,{default:n(()=>[e(G,{variant:"text",onClick:T},{default:n(()=>[e(I,{icon:"tabler-device-floppy",class:"me-2"}),m[1]||(m[1]=S(" Simpan "))]),_:1})]),_:1})]),_:1}),e(Ye,{class:"permission-table mb-6"},{default:n(()=>[m[3]||(m[3]=r("thead",null,[r("tr",null,[r("th",{class:"text-center"},"No"),r("th",{class:"text-center"},"Mata Pelajaran"),r("th",{class:"text-center"},"ID Mapel"),r("th",{class:"text-center"},"Guru Mapel (Dapodik)"),r("th",{class:"text-center"},"Guru Pengajar"),r("th",{class:"text-center"},"Kelompok"),r("th",{class:"text-center"},"Nomor Urut"),r("th",{class:"text-center"},"Reset")])],-1)),r("tbody",null,[l.isLoading?(R(),F("tr",ia,[r("td",ua,[e(be,{size:60,indeterminate:"",color:"error",class:"my-10"})])])):l.listData.length?(R(!0),F(_e,{key:1},ke(l.listData,(i,P)=>(R(),F("tr",null,[r("td",ma,j(P+1),1),r("td",null,[e(b,{modelValue:i.nama_mata_pelajaran,"onUpdate:modelValue":u=>i.nama_mata_pelajaran=u},null,8,["modelValue","onUpdate:modelValue"])]),r("td",null,[e(b,{modelValue:i.mata_pelajaran_id,"onUpdate:modelValue":u=>i.mata_pelajaran_id=u,disabled:""},null,8,["modelValue","onUpdate:modelValue"])]),r("td",null,[e(h,{modelValue:i.guru_id,"onUpdate:modelValue":u=>i.guru_id=u,items:l.listGuru,"item-title":"nama_lengkap","item-value":"guru_id",disabled:""},{selection:n(({item:u})=>[e(Ee,null,{prepend:n(()=>[e(ne,{start:"",image:u.raw.photo},null,8,["image"])]),default:n(()=>[r("span",null,j(u.raw.nama_lengkap),1)]),_:2},1024)]),_:2},1032,["modelValue","onUpdate:modelValue","items"])]),r("td",null,[e(x,{items:l.listGuru,placeholder:"== Pilih Guru Pengajar ==","item-title":"nama_lengkap","item-value":"guru_id",modelValue:i.guru_pengajar_id,"onUpdate:modelValue":u=>i.guru_pengajar_id=u},null,8,["items","modelValue","onUpdate:modelValue"])]),r("td",null,[e(x,{items:l.listKelompok,placeholder:"== Pilih Kelompok ==","item-title":"nama_kelompok","item-value":"kelompok_id",modelValue:i.kelompok_id,"onUpdate:modelValue":u=>i.kelompok_id=u},null,8,["items","modelValue","onUpdate:modelValue"])]),r("td",null,[e(b,{modelValue:i.no_urut,"onUpdate:modelValue":u=>i.no_urut=u},null,8,["modelValue","onUpdate:modelValue"])]),r("td",da,[i.kelompok_id&&i.no_urut?(R(),E(G,{key:0,loading:s(p)[i.pembelajaran_id],disabled:s(p)[i.pembelajaran_id],color:"error",icon:"tabler-trash",onClick:u=>C(i.pembelajaran_id)},null,8,["loading","disabled","onClick"])):Ve("",!0)])]))),256)):(R(),F("tr",ca,m[2]||(m[2]=[r("td",{class:"text-center",colspan:"8"},"Tidak ada untuk ditampilkan",-1)])))])]),_:1})]),_:1})]),_:1},8,["model-value"])}}};function va(l){const f=H(l());let c=-1;function t(){clearInterval(c)}function y(){t(),ze(()=>f.value=l())}function T(p){const C=p?getComputedStyle(p):{transitionDuration:.2},v=parseFloat(C.transitionDuration)*1e3||200;if(t(),f.value<=0)return;const m=performance.now();c=window.setInterval(()=>{const b=performance.now()-m+v;f.value=Math.max(l()-b,0),f.value<=0&&t()},v)}return Qe(t),{clear:t,time:f,start:T,reset:y}}const ga=ye({multiLine:Boolean,text:String,timer:[Boolean,String],timeout:{type:[Number,String],default:5e3},vertical:Boolean,...he({location:"bottom"}),...Pe(),...xe(),...je(),...Te(),...we(sa({transition:"v-snackbar-transition"}),["persistent","noClickAnimation","scrim","scrollStrategy"])},"VSnackbar"),fa=De()({name:"VSnackbar",props:ga(),emits:{"update:modelValue":l=>!0},setup(l,f){let{slots:c}=f;const t=Se(l,"modelValue"),{positionClasses:y}=Ce(l),{scopeId:T}=ra(),{themeClasses:p}=Ue(l),{colorClasses:C,colorStyles:v,variantClasses:m}=$e(l),{roundedClasses:b}=Le(l),h=va(()=>Number(l.timeout)),x=d(),i=d(),P=H(!1),u=H(0),B=d(),_=Ae(Re,void 0);Be(()=>!!_,()=>{const a=qe();Ie(()=>{B.value=a.mainStyles.value})}),O(t,w),O(()=>l.timeout,w),oe(()=>{t.value&&w()});let U=-1;function w(){h.reset(),window.clearTimeout(U);const a=Number(l.timeout);if(!t.value||a===-1)return;const g=Ke(i.value);h.start(g),U=window.setTimeout(()=>{t.value=!1},a)}function K(){h.reset(),window.clearTimeout(U)}function q(){P.value=!0,K()}function N(){P.value=!1,w()}function Q(a){u.value=a.touches[0].clientY}function $(a){Math.abs(u.value-a.changedTouches[0].clientY)>50&&(t.value=!1)}function z(){P.value&&N()}const k=Ne(()=>l.location.split(" ").reduce((a,g)=>(a[`v-snackbar--${g}`]=!0,a),{}));return Fe(()=>{const a=ee.filterProps(l),g=!!(c.default||c.text||l.text);return e(ee,J({ref:x,class:["v-snackbar",{"v-snackbar--active":t.value,"v-snackbar--multi-line":l.multiLine&&!l.vertical,"v-snackbar--timer":!!l.timer,"v-snackbar--vertical":l.vertical},k.value,y.value,l.class],style:[B.value,l.style]},a,{modelValue:t.value,"onUpdate:modelValue":D=>t.value=D,contentProps:J({class:["v-snackbar__wrapper",p.value,C.value,b.value,m.value],style:[v.value],onPointerenter:q,onPointerleave:N},a.contentProps),persistent:!0,noClickAnimation:!0,scrim:!1,scrollStrategy:"none",_disableGlobalStack:!0,onTouchstartPassive:Q,onTouchend:$,onAfterLeave:z},T),{default:()=>{var D,V;return[Me(!1,"v-snackbar"),l.timer&&!P.value&&e("div",{key:"timer",class:"v-snackbar__timer"},[e(Ge,{ref:i,color:typeof l.timer=="string"?l.timer:"info",max:l.timeout,"model-value":h.time.value},null)]),g&&e("div",{key:"content",class:"v-snackbar__content",role:"status","aria-live":"polite"},[((D=c.text)==null?void 0:D.call(c))??l.text,(V=c.default)==null?void 0:V.call(c)]),c.actions&&e(Oe,{defaults:{VBtn:{variant:"text",ripple:!1,slim:!0}}},{default:()=>[e("div",{class:"v-snackbar__actions"},[c.actions({isActive:t})])]})]},activator:c.activator})}),na({},x)}}),ba={class:"d-flex gap-2 align-center"},_a={class:"d-flex align-center flex-wrap gap-4"},ka={class:"d-flex align-center gap-x-4"},Va={class:"d-flex flex-column"},ya={class:"text-base"},ha={class:"text-sm"},Ya={__name:"RombonganBelajar",props:{cardTitle:{type:String,required:!0},jenisRombel:{type:Number,required:!0}},setup(l){const f=l,c=[{title:"Nama",key:"nama",sortable:!0,nowrap:!0},{title:"Wali Kelas",key:"wali_kelas",sortable:!1},{title:"Tingkat",key:"tingkat",align:"center",sortable:!0},{title:"Program/Kompetensi Keahlian",key:"jurusan_sp",sortable:!1},{title:"Kurikulum",key:"kurikulum",sortable:!1},{title:"aksi",key:"aksi",align:"center",sortable:!1}],t=d({page:1,itemsPerPage:10,searchQuery:"",selectedRole:null,sortby:"tingkat",sortbydesc:"ASC"}),y=d(!1),T=d([]),p=d(0),C=k=>{var a,g;t.value.sortby=(a=k[0])==null?void 0:a.key,t.value.sortbydesc=(g=k[0])==null?void 0:g.order},v=async()=>{y.value=!0;try{let a=(await We(Xe("/referensi/rombongan-belajar",{query:{jenis_rombel:f.jenisRombel,sekolah_id:Ze.sekolah_id,semester_id:Y.semester_id,periode_aktif:Y.nama,q:t.value.searchQuery,page:t.value.page,per_page:t.value.itemsPerPage,sortby:t.value.sortby,sortbydesc:t.value.sortbydesc}}))).data.value;T.value=a.data.data,p.value=a.data.total}catch(k){console.error(k)}finally{y.value=!1}};oe(async()=>{await v()}),O(t,async()=>{await v()},{deep:!0}),O(()=>t.value.searchQuery,()=>{t.value.page=1});const m=d(),b=d(!1),h=d(!1),x=d(""),i=d([]),P=d([]),u=d([]),B=d([]),_=d(!1),U=d(""),w=d(""),K=async k=>{_.value=!0,m.value=k,h.value=!0,await M("/referensi/rombongan-belajar/anggota-rombel",{method:"POST",body:{rombongan_belajar_id:m.value},onResponse({request:a,response:g,options:D}){let V=g._data;x.value=`Anggota Rombel Kelas ${V.rombel.nama}`,P.value=V.data,_.value=!1}})},q=async k=>{_.value=!0,m.value=k,b.value=!0,await M("/referensi/rombongan-belajar/pembelajaran",{method:"POST",body:{rombongan_belajar_id:m.value,sekolah_id:ea.sekolah_id,semester_id:Y.semester_id},onResponse({request:a,response:g,options:D}){let V=g._data;x.value=`Pembelajaran Kelas ${V.rombel.nama}`,i.value=V.data,u.value=V.guru,B.value=V.kelompok,_.value=!1}})},N=async()=>{U.value="Pembelajaran berhasil dihapus",w.value="bottom",$.value=!0,q(m.value)},Q=async()=>{K(m.value)},$=d(!1),z=async()=>{await M("/referensi/rombongan-belajar/simpan-pembelajaran",{method:"POST",body:i.value,onResponse(){U.value="Pembelajaran berhasil disimpan",w.value="top",$.value=!0,q(m.value)}})};return(k,a)=>{const g=ae,D=te,V=Je,re=pa,ie=ue;return R(),E(le,null,{default:n(()=>[e(de,{class:"pb-4"},{default:n(()=>[e(ce,null,{default:n(()=>[S(j(f.cardTitle),1)]),_:1})]),_:1}),e(W),e(pe,{class:"d-flex flex-wrap gap-4"},{default:n(()=>[r("div",ba,[e(g,{modelValue:s(t).itemsPerPage,"onUpdate:modelValue":a[0]||(a[0]=o=>s(t).itemsPerPage=o),items:[{value:10,title:"10"},{value:25,title:"25"},{value:50,title:"50"},{value:100,title:"100"}],style:{"inline-size":"15.5rem"}},null,8,["modelValue"])]),e(se),r("div",_a,[e(D,{modelValue:s(t).searchQuery,"onUpdate:modelValue":a[1]||(a[1]=o=>s(t).searchQuery=o),placeholder:"Cari data",style:{"inline-size":"15.625rem"}},null,8,["modelValue"])])]),_:1}),e(W),e(aa,{page:s(t).page,"onUpdate:page":a[3]||(a[3]=o=>s(t).page=o),"items-per-page":s(t).itemsPerPage,"items-per-page-options":[{value:10,title:"10"},{value:20,title:"20"},{value:50,title:"50"}],items:s(T),"server-items-length":s(p),"items-length":s(p),headers:c,"items-per-page-text":"Item",options:s(t),loading:s(y),"loading-text":"Loading...","onUpdate:sortBy":C,"header-props":{class:"text-no-wrap"}},{"item.wali_kelas":n(({item:o})=>[r("div",ka,[e(ne,{size:"34",variant:o.wali_kelas.photo?void 0:"tonal",color:o.wali_kelas.photo?void 0:"success"},{default:n(()=>[e(ta,{src:o.wali_kelas.photo},null,8,["src"])]),_:2},1032,["variant","color"]),r("div",Va,[r("h6",ya,j(o.wali_kelas.nama_lengkap),1),r("div",ha,j(o.wali_kelas.email),1)])])]),"item.jurusan_sp":n(({item:o})=>{var L;return[S(j((L=o.jurusan_sp)==null?void 0:L.nama_jurusan_sp),1)]}),"item.kurikulum":n(({item:o})=>{var L;return[S(j((L=o.kurikulum)==null?void 0:L.nama_kurikulum),1)]}),"item.aksi":n(({item:o})=>[e(G,{icon:"",variant:"text",color:"medium-emphasis"},{default:n(()=>[e(I,{icon:"tabler-dots-vertical"}),e(la,{activator:"parent"},{default:n(()=>[e(oa,null,{default:n(()=>[e(X,{onClick:L=>K(o.rombongan_belajar_id)},{prepend:n(()=>[e(I,{icon:"tabler-users-group"})]),default:n(()=>[e(Z,null,{default:n(()=>a[11]||(a[11]=[S("Anggota Rombel")])),_:1})]),_:2},1032,["onClick"]),e(X,{onClick:L=>q(o.rombongan_belajar_id)},{prepend:n(()=>[e(I,{icon:"tabler-list"})]),default:n(()=>[e(Z,null,{default:n(()=>a[12]||(a[12]=[S("Pembelajaran")])),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),bottom:n(()=>[e(V,{page:s(t).page,"onUpdate:page":a[2]||(a[2]=o=>s(t).page=o),"items-per-page":s(t).itemsPerPage,"total-items":s(p)},null,8,["page","items-per-page","total-items"])]),_:1},8,["page","items-per-page","items","server-items-length","items-length","options","loading"]),e(re,{isDialogVisible:s(b),"onUpdate:isDialogVisible":a[4]||(a[4]=o=>A(b)?b.value=o:null),isLoading:s(_),"onUpdate:isLoading":a[5]||(a[5]=o=>A(_)?_.value=o:null),"dialog-title":s(x),listData:s(i),"onUpdate:listData":a[6]||(a[6]=o=>A(i)?i.value=o:null),"list-guru":s(u),"list-kelompok":s(B),onSave:z,onRefresh:N},null,8,["isDialogVisible","isLoading","dialog-title","listData","list-guru","list-kelompok"]),e(ie,{isDialogVisible:s(h),"onUpdate:isDialogVisible":a[7]||(a[7]=o=>A(h)?h.value=o:null),isLoading:s(_),"onUpdate:isLoading":a[8]||(a[8]=o=>A(_)?_.value=o:null),"dialog-title":s(x),listData:s(P),"onUpdate:listData":a[9]||(a[9]=o=>A(P)?P.value=o:null),onRefresh:Q},null,8,["isDialogVisible","isLoading","dialog-title","listData"]),e(fa,{modelValue:s($),"onUpdate:modelValue":a[10]||(a[10]=o=>A($)?$.value=o:null),color:"success",location:s(w)},{default:n(()=>[S(j(s(U)),1)]),_:1},8,["modelValue","location"])]),_:1})}}};export{Ya as _};
