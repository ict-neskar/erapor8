import{_ as M}from"./ConfirmDialog-BeQZcop1.js";import{_ as O}from"./AppSelect-D2mvpW-q.js";import{_ as q}from"./AppTextField-CpIb7EwY.js";import{_ as z}from"./ProfileSiswa-BQqhhPWB.js";import{_ as H}from"./AppAutocomplete-BQpxGdUG.js";import{G,r as u,f as c,e as i,o as d,b as t,t as D,m as e,am as S,c as h,ap as J,d as r,y as A,F as $,h as Q,aa as W,a2 as P}from"./main-WcaAB0Vb.js";import{d as C,a as R}from"./mixins-CyMBM5fU.js";import{u as X,c as Y}from"./createUrl-5K3jXwP3.js";import{$ as F}from"./api-bn4q6wV9.js";import{V as Z,c as aa,a as ea,b as w}from"./VCard-B6efkknt.js";import{V as la}from"./VDivider-DIWjfe5J.js";import{V as ta}from"./VForm-Ceyv7-oM.js";import{V as B,a as T}from"./VRow-e-Ng4Tme.js";import{V as oa}from"./VTable-Dxydgzys.js";import{V as ra}from"./VAlert-CjOr7Ksk.js";import"./VDialog-B8hMcs5D.js";import"./VOverlay-Baakzd79.js";import"./forwardRefs-DWGaNmQL.js";import"./scopeId-UpMB3NtI.js";import"./VImg-BR-W7-GF.js";import"./VLabel-6jXlAgoN.js";import"./VSelect-D68HqIbk.js";import"./VList-BTYRvNWn.js";import"./ssrBoot-Dq8dOG3X.js";import"./VAvatar-C5PogN-2.js";import"./VMenu-BI4mPtMf.js";import"./VSelectionControl-D1_dFLIC.js";import"./VChip-LzakvH-4.js";import"./VSlideGroup-aRldGfCL.js";/* empty css                   */import"./VField-Bv5GDULG.js";import"./filter-DzTfzdOB.js";import"./index-BxkgbwWS.js";/* empty css              */const ia={key:0,class:"text-center"},na=["innerHTML"],Oa={__name:"pkl",setup(sa){G(async()=>{await L()});const p=u({body:!1,table:!1}),_=u({user_id:C.user_id,guru_id:C.guru_id,sekolah_id:C.sekolah_id,semester_id:R.semester_id,periode_aktif:R.nama,aksi:"praktik-kerja-lapangan"}),l=u({merdeka:!1,allowed:!1,informasi:null,dudi_id:null,prakerin_id:{},lokasi_prakerin:{},skala:{},lama_prakerin:{},keterangan_prakerin:{}}),g=u({dudi:[],siswa:[]}),k=u(!1),U=u(!1),V=u(!1),v=u({color:null,title:null,text:null}),K=u({dudi_id:null}),L=async()=>{p.value.body=!0;try{let a=(await X(Y("/walas",{query:{user_id:_.value.user_id,guru_id:_.value.guru_id,sekolah_id:_.value.sekolah_id,semester_id:_.value.semester_id,periode_aktif:_.value.nama,aksi:_.value.aksi}}))).data.value;l.value.merdeka=a.merdeka,l.value.informasi=a.notif,l.value.allowed=a.allowed,g.value.dudi=a.data_dudi}catch(m){console.error(m)}finally{p.value.body=!1}},j=async()=>{k.value=!0;const m={..._.value,...l.value};await F("/walas/save",{method:"POST",body:m,onResponseError({response:a}){console.log("ERROR:",a._data.errors),k.value=!1},onResponse({response:a}){k.value=!1;let f=a._data;f.errors||(V.value=!0,v.value=f)}})},E=async m=>{const a={...m,..._.value,...l.value};await F("/walas/get-data",{method:"POST",body:a,onResponse({response:f}){let b=f._data;g.value.siswa=b.data_siswa,b.data_siswa.forEach(n=>{var y,x,o,s,N;l.value.prakerin_id[n.anggota_rombel.anggota_rombel_id]=(y=n.anggota_rombel.single_prakerin)==null?void 0:y.prakerin_id,l.value.lokasi_prakerin[n.anggota_rombel.anggota_rombel_id]=((x=n.anggota_rombel.single_prakerin)==null?void 0:x.lokasi_prakerin)??b.dudi.alamat_jalan,l.value.skala[n.anggota_rombel.anggota_rombel_id]=(o=n.anggota_rombel.single_prakerin)==null?void 0:o.skala,l.value.lama_prakerin[n.anggota_rombel.anggota_rombel_id]=(s=n.anggota_rombel.single_prakerin)==null?void 0:s.lama_prakerin,l.value.keterangan_prakerin[n.anggota_rombel.anggota_rombel_id]=(N=n.anggota_rombel.single_prakerin)==null?void 0:N.keterangan_prakerin}),p.value.table=!1}})},I=async m=>{m&&(p.value.table=!0,await E({data:"anggota-pkl"}))};return(m,a)=>{const f=H,b=z,n=q,y=O,x=M;return d(),c(Z,null,{default:i(()=>[t(ea,{class:"pb-4"},{default:i(()=>[t(aa,null,{default:i(()=>a[3]||(a[3]=[D("Praktik Kerja Lapangan")])),_:1})]),_:1}),t(la),e(p).body?(d(),c(w,{key:0,class:"text-center"},{default:i(()=>[t(S,{size:60,indeterminate:"",color:"error",class:"my-10"})]),_:1})):(d(),h($,{key:1},[e(l).allowed?(d(),c(ta,{key:0,onSubmit:J(j,["prevent"])},{default:i(()=>[t(w,null,{default:i(()=>[t(B,null,{default:i(()=>[t(T,{cols:"12"},{default:i(()=>[t(B,{"no-gutters":""},{default:i(()=>[t(T,{cols:"12",md:"3",class:"d-flex align-items-center"},{default:i(()=>a[4]||(a[4]=[r("label",{class:"v-label text-body-2 text-high-emphasis",for:"dudi_id"},"DUDI",-1)])),_:1}),t(T,{cols:"12",md:"9"},{default:i(()=>[t(f,{modelValue:e(l).dudi_id,"onUpdate:modelValue":[a[0]||(a[0]=o=>e(l).dudi_id=o),I],placeholder:"== Pilih DUDI ==",items:e(g).dudi,clearable:"","clear-icon":"tabler-x","error-messages":e(K).dudi_id,"item-value":"dudi_id","item-title":"nama"},null,8,["modelValue","items","error-messages"])]),_:1})]),_:1})]),_:1})]),_:1}),e(p).table?(d(),h("div",ia,[t(S,{size:60,indeterminate:"",color:"error",class:"my-10"})])):A("",!0)]),_:1}),e(g).siswa.length?(d(),c(oa,{key:0},{default:i(()=>[a[5]||(a[5]=r("thead",null,[r("tr",null,[r("th",{class:"text-center"},"Nama Peserta Didik"),r("th",{class:"text-center"},"Alamat DUDI"),r("th",{class:"text-center"},[D("Skala Kesesuaian dengan Kompetensi Keahlian "),r("br"),D("(1-10)")]),r("th",{class:"text-center"},"Lamanya (bulan)"),r("th",{class:"text-center"},"Keterangan")])],-1)),r("tbody",null,[(d(!0),h($,null,Q(e(g).siswa,o=>(d(),h("tr",null,[r("td",null,[t(b,{item:o},null,8,["item"])]),r("td",null,[t(n,{modelValue:e(l).lokasi_prakerin[o.anggota_rombel.anggota_rombel_id],"onUpdate:modelValue":s=>e(l).lokasi_prakerin[o.anggota_rombel.anggota_rombel_id]=s},null,8,["modelValue","onUpdate:modelValue"])]),r("td",null,[t(y,{modelValue:e(l).skala[o.anggota_rombel.anggota_rombel_id],"onUpdate:modelValue":s=>e(l).skala[o.anggota_rombel.anggota_rombel_id]=s,placeholder:"== Pilih Skala ==",items:[1,2,3,4,5,6,7,8,9,10],clearable:"","clear-icon":"tabler-x"},null,8,["modelValue","onUpdate:modelValue"])]),r("td",null,[t(n,{modelValue:e(l).lama_prakerin[o.anggota_rombel.anggota_rombel_id],"onUpdate:modelValue":s=>e(l).lama_prakerin[o.anggota_rombel.anggota_rombel_id]=s},null,8,["modelValue","onUpdate:modelValue"])]),r("td",null,[t(n,{modelValue:e(l).keterangan_prakerin[o.anggota_rombel.anggota_rombel_id],"onUpdate:modelValue":s=>e(l).keterangan_prakerin[o.anggota_rombel.anggota_rombel_id]=s},null,8,["modelValue","onUpdate:modelValue"])])]))),256))])]),_:1})):A("",!0),e(g).siswa.length?(d(),c(w,{key:1,class:"d-flex justify-end flex-wrap gap-3 pt-5 overflow-visible"},{default:i(()=>[t(W,{variant:"elevated",type:"submit",loading:e(k),disabled:e(k)},{default:i(()=>a[6]||(a[6]=[D(" Simpan ")])),_:1},8,["loading","disabled"])]),_:1})):A("",!0)]),_:1})):(d(),c(w,{key:1},{default:i(()=>[t(ra,{color:"error",class:"my-4",variant:"tonal"},{default:i(()=>[a[7]||(a[7]=r("h2",{class:"mt-4 mb-4 text-center"},"Akses ditutup!",-1)),r("p",{innerHTML:e(l).informasi},null,8,na)]),_:1})]),_:1}))],64)),t(x,{isDialogVisible:e(U),"onUpdate:isDialogVisible":a[1]||(a[1]=o=>P(U)?U.value=o:null),isNotifVisible:e(V),"onUpdate:isNotifVisible":a[2]||(a[2]=o=>P(V)?V.value=o:null),"confirmation-question":"Apakah Anda yakin?","confirmation-text":"Tindakan ini tidak dapat dikembalikan!","confirm-color":e(v).color,"confirm-title":e(v).title,"confirm-msg":e(v).text},null,8,["isDialogVisible","isNotifVisible","confirm-color","confirm-title","confirm-msg"])]),_:1})}}};export{Oa as default};
