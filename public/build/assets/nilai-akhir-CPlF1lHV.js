import{a as Y,d as N,e as Z,f as ee}from"./mixins-1QYt5fru.js";import{r as d,f as U,e as u,o as b,b as n,t as A,m as e,a2 as k,d as o,c as w,am as ae,y as F,h as z,F as S,aa as le,ao as te,v as E}from"./main-Dl0rUCYh.js";import{_ as ne}from"./ConfirmDialog-DJg6T0Ss.js";import{_ as ie}from"./AppTextField-BYuq6zq8.js";import{_ as oe,a as re}from"./DefaultForm-D6NoUxT3.js";import{_ as se}from"./AppSelect-DlsWZOle.js";import{$}from"./api-CiS_WuT0.js";import{V as ue,c as me,a as de,b as O}from"./VCard-cOUOYXWj.js";import{V as I}from"./VDivider-DE02SI82.js";import{V as K,a as B}from"./VRow-BWoXzrFX.js";import{V as pe}from"./VTable-DOTAg6_r.js";import{V as fe}from"./VForm-C8sZwdRj.js";import"./VDialog-DALwxD56.js";import"./VOverlay-DA1Ejrlc.js";import"./forwardRefs-DWGaNmQL.js";import"./VImg-DiBI_SCk.js";import"./VLabel-BTSq7zPr.js";import"./VAvatar-AahfVeEd.js";import"./VList-DLdPu79M.js";import"./VMenu-DmZE3Mnu.js";import"./VSelectionControl-Bmf3QYSu.js";import"./VChip-pgoMLksa.js";import"./index-BxkgbwWS.js";/* empty css              */const _e={key:0,class:"text-center"},be=["rowspan"],ce=["rowspan"],ke=["rowspan"],ge={style:{"inline-size":"6rem"}},Le={__name:"nilai-akhir",setup(ve){const s=d({tingkat:null,rombongan_belajar_id:null,pembelajaran_id:null,bentuk_penilaian:null}),p=d({akhir:{},kompeten:{}}),c=d({tingkat:null,rombongan_belajar_id:null,pembelajaran_id:null,bentuk_penilaian:null}),i=d({rombel:[],mapel:[],teknik:[],siswa:[],tp:[]}),r=d({rombel:!1,mapel:!1,bentuk_penilaian:!1,body:!1}),j=d(!1),g=d(!1),C=d(!1),v=d(!1),R=d(""),V=d({color:"",title:"",text:""}),M=async()=>{g.value=!0;const l={...y,...s.value,...p.value};await $("/penilaian/simpan",{method:"POST",body:l,onResponse({response:a}){let f=a._data;g.value=!1,f.errors?c.value=f.errors:(v.value=!0,V.value=f)}})},y={opsi:"nilai-akhir",semester_id:Y.semester_id,user_id:N.user_id,guru_id:N.guru_id,sekolah_id:N.sekolah_id,merdeka:!1},q=()=>{s.value={tingkat:null,rombongan_belajar_id:null,pembelajaran_id:null,bentuk_penilaian:null},p.value={akhir:{},kompeten:{}},c.value={tingkat:null,rombongan_belajar_id:null,pembelajaran_id:null,bentuk_penilaian:null},i.value={rombel:[],mapel:[],teknik:[],siswa:[],tp:[]},r.value={rombel:!1,mapel:!1,bentuk_penilaian:!1,body:!1},j.value=!1,g.value=!1,C.value=!1,v.value=!1,R.value="",V.value={color:"",title:"",text:""},y.opsi="nilai-akhir"},P=async l=>{const a={...l,...y};await $("/referensi/get-data",{method:"POST",body:a,onResponse({response:f}){let m=f._data;l.data=="rombel"&&(i.value.rombel=m),l.data=="mapel"&&(i.value.mapel=m.mapel,y.merdeka=m.merdeka),l.data=="teknik"&&(i.value.teknik=m)}})},L=async l=>{s.value.rombongan_belajar_id=null,s.value.pembelajaran_id=null,l&&(r.value.rombel=!0,await P({data:"rombel",nilai:1,tingkat:l}).then(()=>{r.value.rombel=!1}))},G=async l=>{s.value.pembelajaran_id=null,l&&(r.value.mapel=!0,await P({data:"mapel",nilai:1,rombongan_belajar_id:l}).then(()=>{r.value.mapel=!1}))},H=async l=>{s.value.bentuk_penilaian=null,l&&(r.value.bentuk_penilaian=!0,await P({data:"teknik"}).then(()=>{r.value.bentuk_penilaian=!1}))},T=d(!1),J=async l=>{if(i.value.siswa=[],i.value.tp=[],l){const a={...s.value,...y};r.value.body=!0,j.value=!1,await $("/penilaian/get-nilai-akhir",{method:"POST",body:a,onResponse({response:f}){let m=f._data;i.value.siswa=m.data_siswa,i.value.tp=m.data_tp,s.value.bentuk_penilaian=="asesmen"?T.value=!0:T.value=!1,m.data_siswa.forEach(_=>{s.value.bentuk_penilaian=="asesmen"?p.value.akhir[_.anggota_rombel_id]=_.nilai_asesmen:p.value.akhir[_.anggota_rombel_id]=_.nilai_akhir,m.data_tp.forEach(D=>{const h=_.capaian_kompeten.find(t=>t.tp_id===D.tp_id);p.value.kompeten[_.anggota_rombel_id+"#"+D.tp_id]=h==null?void 0:h.kompeten})}),j.value=!0,r.value.body=!1}})}},Q=()=>{q()};return(l,a)=>{const f=oe,m=se,_=re,D=ie,h=ne;return b(),U(ue,{class:"mb-6"},{default:u(()=>[n(de,{class:"pb-4"},{default:u(()=>[n(me,null,{default:u(()=>a[7]||(a[7]=[A("Input Nilai Akhir")])),_:1})]),_:1}),n(I),n(fe,{onSubmit:te(M,["prevent"])},{default:u(()=>[n(O,null,{default:u(()=>[n(K,null,{default:u(()=>[n(f,{form:e(s),"onUpdate:form":a[0]||(a[0]=t=>k(s)?s.value=t:null),errors:e(c),"onUpdate:errors":a[1]||(a[1]=t=>k(c)?c.value=t:null),arrayData:e(i),"onUpdate:arrayData":a[2]||(a[2]=t=>k(i)?i.value=t:null),loading:e(r),"onUpdate:loading":a[3]||(a[3]=t=>k(r)?r.value=t:null),onTingkat:L,onRombongan_belajar_id:G,onPembelajaran_id:H},null,8,["form","errors","arrayData","loading"]),n(B,{cols:"12"},{default:u(()=>[n(K,{"no-gutters":""},{default:u(()=>[n(B,{cols:"12",md:"3",class:"d-flex align-items-center"},{default:u(()=>a[8]||(a[8]=[o("label",{class:"v-label text-body-2 text-high-emphasis",for:"bentuk_penilaian"},"Bentuk Penilaian",-1)])),_:1}),n(B,{cols:"12",md:"9"},{default:u(()=>[n(m,{modelValue:e(s).bentuk_penilaian,"onUpdate:modelValue":[a[4]||(a[4]=t=>e(s).bentuk_penilaian=t),J],placeholder:"== Pilih Bentuk Penilaian ==",items:"bentukPenilaian"in l?l.bentukPenilaian:e(Z),clearable:"","clear-icon":"tabler-x","error-messages":e(c).bentuk_penilaian,loading:e(r).bentuk_penilaian,disabled:e(r).bentuk_penilaian},null,8,["modelValue","items","error-messages","loading","disabled"])]),_:1})]),_:1})]),_:1})]),_:1}),e(r).body?(b(),w("div",_e,[n(ae,{size:60,indeterminate:"",color:"error",class:"my-10"})])):F("",!0)]),_:1}),e(i).siswa.length?(b(),U(pe,{key:0},{default:u(()=>[a[9]||(a[9]=o("thead",null,[o("tr",null,[o("th",{class:"text-center"},"No."),o("th",{class:"text-center"},"Nama Peserta Didik"),o("th",{class:"text-center"},"Nilai Akhir"),o("th",{class:"text-center"},"Ketercapaian Kompetensi"),o("th",null,"Deskripsi Tujuan Pembelajaran")])],-1)),o("tbody",null,[(b(!0),w(S,null,z(e(i).siswa,(t,W)=>(b(),w(S,null,[o("tr",null,[o("td",{class:"text-center pt-2",rowspan:e(i).tp.length+1,style:{"vertical-align":"top"}},E(W+1),9,be),o("td",{rowspan:e(i).tp.length+1,class:"text-no-wrap pt-2",style:{"vertical-align":"top"}},[n(_,{item:t},null,8,["item"])],8,ce),o("td",{rowspan:e(i).tp.length+1,style:{"vertical-align":"top"},class:"pt-2"},[o("div",ge,[n(D,{type:"number",modelValue:e(p).akhir[t.anggota_rombel_id],"onUpdate:modelValue":x=>e(p).akhir[t.anggota_rombel_id]=x,disabled:e(T)},null,8,["modelValue","onUpdate:modelValue","disabled"])])],8,ke)]),(b(!0),w(S,null,z(e(i).tp,(x,Ve)=>(b(),w("tr",null,[o("td",null,[n(m,{modelValue:e(p).kompeten[t.anggota_rombel_id+"#"+x.tp_id],"onUpdate:modelValue":X=>e(p).kompeten[t.anggota_rombel_id+"#"+x.tp_id]=X,placeholder:"== Pilih Capaian ==",items:"dataCapaian"in l?l.dataCapaian:e(ee),clearable:"","clear-icon":"tabler-x",style:{"inline-size":"12rem"}},null,8,["modelValue","onUpdate:modelValue","items"])]),o("td",null,E(x.deskripsi),1)]))),256))],64))),256))])]),_:1})):F("",!0),n(I),e(j)?(b(),U(O,{key:1,class:"d-flex justify-end flex-wrap gap-3 pt-5 overflow-visible"},{default:u(()=>[n(le,{variant:"elevated",type:"submit",loading:e(g),disabled:e(g)},{default:u(()=>a[10]||(a[10]=[A(" Simpan ")])),_:1},8,["loading","disabled"])]),_:1})):F("",!0)]),_:1}),n(h,{isDialogVisible:e(C),"onUpdate:isDialogVisible":a[5]||(a[5]=t=>k(C)?C.value=t:null),isNotifVisible:e(v),"onUpdate:isNotifVisible":a[6]||(a[6]=t=>k(v)?v.value=t:null),"confirmation-question":"Apakah Anda yakin?","confirmation-text":e(R),"confirm-color":e(V).color,"confirm-title":e(V).title,"confirm-msg":e(V).text,onClose:Q},null,8,["isDialogVisible","isNotifVisible","confirmation-text","confirm-color","confirm-title","confirm-msg"])]),_:1})}}};export{Le as default};
