import{_ as M}from"./ConfirmDialog-CY_9uydO.js";import{_ as O}from"./AppSelect-DbfGRlpP.js";import{_ as q}from"./AppTextField-BYQvWqvk.js";import{_ as z}from"./ProfileSiswa-BoXX9sbX.js";import{_ as H}from"./AppAutocomplete-CoTPRzAH.js";import{G,r as u,f as c,e as i,o as d,b as t,t as D,m as l,am as S,c as h,ap as J,d as r,y as A,F as $,h as Q,aa as W,a2 as P}from"./main-BpmS5yjl.js";import{d as C,a as R}from"./mixins-CToSDW15.js";import{u as X,c as Y}from"./createUrl-jHsYqGLm.js";import{$ as F}from"./api-CqoQuUrQ.js";import{V as Z,c as aa,a as ea,b as w}from"./VCard-CHmpSx-c.js";import{V as la}from"./VDivider-gWeRf3Xl.js";import{V as ta}from"./VForm-BtS5s1QD.js";import{V as B,a as T}from"./VRow-BacuoGYF.js";import{V as oa}from"./VTable-DH5oZuZ_.js";import{V as ra}from"./VAlert-DvtwwTIG.js";import"./VDialog-DmAehLsX.js";import"./VOverlay-yY7p8is2.js";import"./forwardRefs-DWGaNmQL.js";import"./scopeId-DiP191uI.js";import"./VImg-1iDcvPVu.js";import"./VLabel-D6Y69236.js";import"./VSelect-D2E-ncti.js";import"./VList-CAazeH9Z.js";import"./ssrBoot-C9ygE__7.js";import"./VAvatar-CwdAusxZ.js";import"./VMenu-RpUw0xGr.js";import"./VSelectionControl-Bjw4k3ug.js";import"./VChip-Ce3c0jwR.js";import"./VSlideGroup-ZqIn0ESw.js";/* empty css                   */import"./VField-Cktymv3Q.js";import"./filter-B41lvxns.js";import"./index-BxkgbwWS.js";/* empty css              */const ia={key:0,class:"text-center"},na=["innerHTML"],Oa={__name:"pkl",setup(sa){G(async()=>{await L()});const g=u({body:!1,table:!1}),_=u({user_id:C.user_id,guru_id:C.guru_id,sekolah_id:C.sekolah_id,semester_id:R.semester_id,periode_aktif:R.nama,aksi:"praktik-kerja-lapangan"}),a=u({merdeka:!1,allowed:!1,informasi:null,dudi_id:null,prakerin_id:{},lokasi_prakerin:{},skala:{},lama_prakerin:{},keterangan_prakerin:{}}),p=u({dudi:[],siswa:[]}),k=u(!1),U=u(!1),v=u(!1),V=u({color:null,title:null,text:null}),K=u({dudi_id:null}),L=async()=>{g.value.body=!0;try{let e=(await X(Y("/walas",{query:{user_id:_.value.user_id,guru_id:_.value.guru_id,sekolah_id:_.value.sekolah_id,semester_id:_.value.semester_id,periode_aktif:_.value.nama,aksi:_.value.aksi}}))).data.value;a.value.merdeka=e.merdeka,a.value.informasi=e.notif,a.value.allowed=e.allowed,p.value.dudi=e.data_dudi}catch(m){console.error(m)}finally{g.value.body=!1}},j=async()=>{k.value=!0;const m={..._.value,...a.value};await F("/walas/save",{method:"POST",body:m,onResponseError({response:e}){console.log("ERROR:",e._data.errors),k.value=!1},onResponse({response:e}){k.value=!1;let f=e._data;f.errors||(v.value=!0,V.value=f)}})},E=async m=>{const e={...m,..._.value,...a.value};await F("/walas/get-data",{method:"POST",body:e,onResponse({response:f}){let b=f._data;p.value.siswa=b.data_siswa,b.data_siswa.forEach(n=>{var y,x,o,s,N;a.value.prakerin_id[n.anggota_rombel.anggota_rombel_id]=(y=n.anggota_rombel.single_prakerin)==null?void 0:y.prakerin_id,a.value.lokasi_prakerin[n.anggota_rombel.anggota_rombel_id]=((x=n.anggota_rombel.single_prakerin)==null?void 0:x.lokasi_prakerin)??b.dudi.alamat_jalan,a.value.skala[n.anggota_rombel.anggota_rombel_id]=(o=n.anggota_rombel.single_prakerin)==null?void 0:o.skala,a.value.lama_prakerin[n.anggota_rombel.anggota_rombel_id]=(s=n.anggota_rombel.single_prakerin)==null?void 0:s.lama_prakerin,a.value.keterangan_prakerin[n.anggota_rombel.anggota_rombel_id]=(N=n.anggota_rombel.single_prakerin)==null?void 0:N.keterangan_prakerin}),g.value.table=!1}})},I=async m=>{a.value.prakerin_id={},a.value.lokasi_prakerin={},a.value.skala={},a.value.lama_prakerin={},a.value.keterangan_prakerin={},p.value.siswa=[],m&&(g.value.table=!0,await E({data:"anggota-pkl"}))};return(m,e)=>{const f=H,b=z,n=q,y=O,x=M;return d(),c(Z,null,{default:i(()=>[t(ea,{class:"pb-4"},{default:i(()=>[t(aa,null,{default:i(()=>e[3]||(e[3]=[D("Praktik Kerja Lapangan")])),_:1})]),_:1}),t(la),l(g).body?(d(),c(w,{key:0,class:"text-center"},{default:i(()=>[t(S,{size:60,indeterminate:"",color:"error",class:"my-10"})]),_:1})):(d(),h($,{key:1},[l(a).allowed?(d(),c(ta,{key:0,onSubmit:J(j,["prevent"])},{default:i(()=>[t(w,null,{default:i(()=>[t(B,null,{default:i(()=>[t(T,{cols:"12"},{default:i(()=>[t(B,{"no-gutters":""},{default:i(()=>[t(T,{cols:"12",md:"3",class:"d-flex align-items-center"},{default:i(()=>e[4]||(e[4]=[r("label",{class:"v-label text-body-2 text-high-emphasis",for:"dudi_id"},"DUDI",-1)])),_:1}),t(T,{cols:"12",md:"9"},{default:i(()=>[t(f,{modelValue:l(a).dudi_id,"onUpdate:modelValue":[e[0]||(e[0]=o=>l(a).dudi_id=o),I],placeholder:"== Pilih DUDI ==",items:l(p).dudi,clearable:"","clear-icon":"tabler-x","error-messages":l(K).dudi_id,"item-value":"dudi_id","item-title":"nama"},null,8,["modelValue","items","error-messages"])]),_:1})]),_:1})]),_:1})]),_:1}),l(g).table?(d(),h("div",ia,[t(S,{size:60,indeterminate:"",color:"error",class:"my-10"})])):A("",!0)]),_:1}),l(p).siswa.length?(d(),c(oa,{key:0},{default:i(()=>[e[5]||(e[5]=r("thead",null,[r("tr",null,[r("th",{class:"text-center"},"Nama Peserta Didik"),r("th",{class:"text-center"},"Alamat DUDI"),r("th",{class:"text-center"},[D("Skala Kesesuaian dengan Kompetensi Keahlian "),r("br"),D("(1-10)")]),r("th",{class:"text-center"},"Lamanya (bulan)"),r("th",{class:"text-center"},"Keterangan")])],-1)),r("tbody",null,[(d(!0),h($,null,Q(l(p).siswa,o=>(d(),h("tr",null,[r("td",null,[t(b,{item:o},null,8,["item"])]),r("td",null,[t(n,{modelValue:l(a).lokasi_prakerin[o.anggota_rombel.anggota_rombel_id],"onUpdate:modelValue":s=>l(a).lokasi_prakerin[o.anggota_rombel.anggota_rombel_id]=s},null,8,["modelValue","onUpdate:modelValue"])]),r("td",null,[t(y,{modelValue:l(a).skala[o.anggota_rombel.anggota_rombel_id],"onUpdate:modelValue":s=>l(a).skala[o.anggota_rombel.anggota_rombel_id]=s,placeholder:"== Pilih Skala ==",items:[1,2,3,4,5,6,7,8,9,10],clearable:"","clear-icon":"tabler-x"},null,8,["modelValue","onUpdate:modelValue"])]),r("td",null,[t(n,{modelValue:l(a).lama_prakerin[o.anggota_rombel.anggota_rombel_id],"onUpdate:modelValue":s=>l(a).lama_prakerin[o.anggota_rombel.anggota_rombel_id]=s},null,8,["modelValue","onUpdate:modelValue"])]),r("td",null,[t(n,{modelValue:l(a).keterangan_prakerin[o.anggota_rombel.anggota_rombel_id],"onUpdate:modelValue":s=>l(a).keterangan_prakerin[o.anggota_rombel.anggota_rombel_id]=s},null,8,["modelValue","onUpdate:modelValue"])])]))),256))])]),_:1})):A("",!0),l(p).siswa.length?(d(),c(w,{key:1,class:"d-flex justify-end flex-wrap gap-3 pt-5 overflow-visible"},{default:i(()=>[t(W,{variant:"elevated",type:"submit",loading:l(k),disabled:l(k)},{default:i(()=>e[6]||(e[6]=[D(" Simpan ")])),_:1},8,["loading","disabled"])]),_:1})):A("",!0)]),_:1})):(d(),c(w,{key:1},{default:i(()=>[t(ra,{color:"error",class:"my-4",variant:"tonal"},{default:i(()=>[e[7]||(e[7]=r("h2",{class:"mt-4 mb-4 text-center"},"Akses ditutup!",-1)),r("p",{innerHTML:l(a).informasi},null,8,na)]),_:1})]),_:1}))],64)),t(x,{isDialogVisible:l(U),"onUpdate:isDialogVisible":e[1]||(e[1]=o=>P(U)?U.value=o:null),isNotifVisible:l(v),"onUpdate:isNotifVisible":e[2]||(e[2]=o=>P(v)?v.value=o:null),"confirmation-question":"Apakah Anda yakin?","confirmation-text":"Tindakan ini tidak dapat dikembalikan!","confirm-color":l(V).color,"confirm-title":l(V).title,"confirm-msg":l(V).text},null,8,["isDialogVisible","isNotifVisible","confirm-color","confirm-title","confirm-msg"])]),_:1})}}};export{Oa as default};
