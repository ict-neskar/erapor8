import{a as U,d as $,t as G}from"./mixins-CKlf8GuV.js";import{r as _,f as B,e as t,o as b,b as l,t as y,d as i,m as a,am as H,y as E,c,F as v,h as F,aa as J,ap as Q,a2 as A,q as W,v as C}from"./main-BUumBu6a.js";import{_ as X}from"./ConfirmDialog-D2Ym9elI.js";import{_ as Y}from"./ProfileSiswa-BPofQdjj.js";import{_ as Z}from"./AppSelect-DwS2KVgh.js";import{_ as aa}from"./AppTextField-BkZ8OLsx.js";import{$ as K}from"./api-DGas9VfV.js";import{V as ea,c as la,a as ta,b as N}from"./VCard-BpJLDfhD.js";import{V as R}from"./VDivider-BnEsdsgF.js";import{a as m,V as T}from"./VRow-D5VnEZ_i.js";import{V as na}from"./VTable-BUsnUoL5.js";import{V as oa}from"./VForm-DjKeRf84.js";import{V as ra}from"./VTooltip-CEfZsqvI.js";import{V as ia}from"./VTextarea-B6eEthks.js";import"./VDialog-BEKtFyZX.js";import"./VOverlay-Bb4CDEq4.js";import"./forwardRefs-DWGaNmQL.js";import"./scopeId-CDzN2yrl.js";import"./VImg-D2Juqgex.js";import"./VAvatar-Ba-Ggnm6.js";import"./VLabel-BS4UTjHC.js";import"./VSelect-CUZzVBlY.js";import"./VList-DzyT1C46.js";import"./ssrBoot-BYz6_xqb.js";import"./VMenu-CW6Pdemc.js";import"./VSelectionControl-C5g1YuyM.js";import"./VChip-BQa_6tD-.js";import"./VSlideGroup-DCwY19Ye.js";/* empty css                   */import"./VField-BQoKA9XH.js";import"./index-BxkgbwWS.js";/* empty css              */const sa=["colspan"],da={class:"text-center"},ma={rowspan:"2"},ua={class:"py-4"},_a=["colspan"],Ga={__name:"penilaian",setup(ba){const S=_(),n=_({semester_id:U.semester_id,user_id:$.user_id,guru_id:$.guru_id,sekolah_id:$.sekolah_id,tingkat:null,rombongan_belajar_id:null,rencana_budaya_kerja_id:null,nilai:{},deskripsi:{}}),V=_({tingkat:null,rombongan_belajar_id:null,rencana_budaya_kerja_id:null}),s=_({rombel:[],rencana:[],siswa:[],aspek:[],opsi:[]}),u=_({rombel:!1,rencana:!1,body:!1}),j=_(!1),q=()=>{var r;(r=S.value)==null||r.validate().then(({valid:e})=>{e&&z()})},z=async()=>{j.value=!0;const e={...{data:"nilai"},...n.value};await K("/projek/save",{method:"POST",body:e,onResponse({response:f}){let d=f._data;h.value=!0,x.value=d,j.value=!1}})},w=async r=>{const e={...r,...n.value};await K("/referensi/get-data",{method:"POST",body:e,onResponse({response:f}){let d=f._data;r.data=="rombel"&&(s.value.rombel=d),r.data=="rencana-p5"&&(s.value.rencana=d),r.data=="nilai-p5"&&(s.value.siswa=d.data_siswa,s.value.aspek=d.rencana_budaya_kerja.aspek_budaya_kerja,s.value.opsi=d.opsi_budaya_kerja,d.data_siswa.forEach(g=>{var P;g.anggota_rombel.nilai_budaya_kerja.forEach(o=>{n.value.nilai[g.anggota_rombel.anggota_rombel_id+"#"+o.aspek_budaya_kerja_id]=o.opsi_id+"#"+o.elemen_id}),n.value.deskripsi[n.value.rencana_budaya_kerja_id+"#"+g.anggota_rombel.anggota_rombel_id]=(P=g.anggota_rombel.catatan_budaya_kerja)==null?void 0:P.catatan}))}})},O=async r=>{s.value.rombel=[],n.value.rombongan_belajar_id=null,n.value.rencana_budaya_kerja_id=null,r&&(u.value.rombel=!0,await w({data:"rombel",aksi:"nilai-p5",tingkat:r}).then(()=>{u.value.rombel=!1}))},I=async r=>{s.value.rencana=[],n.value.rencana_budaya_kerja_id=null,r&&(u.value.rencana=!0,await w({data:"rencana-p5",rombongan_belajar_id:r}).then(()=>{u.value.rencana=!1}))},L=async r=>{s.value.aspek=[],s.value.siswa=[],r&&(u.value.body=!0,await w({data:"nilai-p5",rencana_budaya_kerja_id:r}).then(()=>{u.value.body=!1}))},D=_(!1),x=_({color:null,title:null,text:null}),h=_(!1),M=async()=>{n.value.tingkat=null,n.value.rombongan_belajar_id=null,n.value.rencana_budaya_kerja_id=null,n.value.nilai={},n.value.deskripsi={},V.value={tingkat:null,rombongan_belajar_id:null,rencana_budaya_kerja_id:null},s.value={rombel:[],rencana:[],siswa:[],aspek:[],opsi:[]}};return(r,e)=>{const f=aa,d=Z,g=Y,P=X;return b(),B(ea,{class:"mb-6"},{default:t(()=>[l(ta,{class:"pb-4"},{default:t(()=>[l(la,null,{default:t(()=>e[5]||(e[5]=[y("Proses Penilaian P5")])),_:1})]),_:1}),l(R),l(oa,{ref_key:"refVForm",ref:S,onSubmit:Q(q,["prevent"])},{default:t(()=>[l(N,null,{default:t(()=>[l(m,{cols:"12"},{default:t(()=>[l(T,{"no-gutters":""},{default:t(()=>[l(m,{cols:"12",md:"3",class:"d-flex align-items-center"},{default:t(()=>e[6]||(e[6]=[i("label",{class:"v-label text-body-2 text-high-emphasis",for:"semester_id"},"Tahun Pelajaran",-1)])),_:1}),l(m,{cols:"12",md:"9"},{default:t(()=>[l(f,{id:"semester_id",value:("$semester"in r?r.$semester:a(U)).nama,disabled:""},null,8,["value"])]),_:1})]),_:1})]),_:1}),l(m,{cols:"12"},{default:t(()=>[l(T,{"no-gutters":""},{default:t(()=>[l(m,{cols:"12",md:"3",class:"d-flex align-items-center"},{default:t(()=>e[7]||(e[7]=[i("label",{class:"v-label text-body-2 text-high-emphasis",for:"tingkat"},"Tingkat Kelas",-1)])),_:1}),l(m,{cols:"12",md:"9"},{default:t(()=>[l(d,{modelValue:a(n).tingkat,"onUpdate:modelValue":[e[0]||(e[0]=o=>a(n).tingkat=o),O],placeholder:"== Pilih Tingkat kelas ==",items:"tingkatKelas"in r?r.tingkatKelas:a(G),clearable:"","clear-icon":"tabler-x","error-messages":a(V).tingkat},null,8,["modelValue","items","error-messages"])]),_:1})]),_:1})]),_:1}),l(m,{cols:"12"},{default:t(()=>[l(T,{"no-gutters":""},{default:t(()=>[l(m,{cols:"12",md:"3",class:"d-flex align-items-center"},{default:t(()=>e[8]||(e[8]=[i("label",{class:"v-label text-body-2 text-high-emphasis",for:"rombongan_belajar_id"},"Rombongan Belajar",-1)])),_:1}),l(m,{cols:"12",md:"9"},{default:t(()=>[l(d,{modelValue:a(n).rombongan_belajar_id,"onUpdate:modelValue":[e[1]||(e[1]=o=>a(n).rombongan_belajar_id=o),I],placeholder:"== Pilih Rombongan Belajar ==","item-value":"rombongan_belajar_id","item-title":"nama",items:a(s).rombel,clearable:"","clear-icon":"tabler-x","error-messages":a(V).rombongan_belajar_id,loading:a(u).rombel,disabled:a(u).rombel},null,8,["modelValue","items","error-messages","loading","disabled"])]),_:1})]),_:1})]),_:1}),l(m,{cols:"12"},{default:t(()=>[l(T,{"no-gutters":""},{default:t(()=>[l(m,{cols:"12",md:"3",class:"d-flex align-items-center"},{default:t(()=>e[9]||(e[9]=[i("label",{class:"v-label text-body-2 text-high-emphasis",for:"rencana_budaya_kerja_id"},"Rencana Penilaian",-1)])),_:1}),l(m,{cols:"12",md:"9"},{default:t(()=>[l(d,{modelValue:a(n).rencana_budaya_kerja_id,"onUpdate:modelValue":[e[2]||(e[2]=o=>a(n).rencana_budaya_kerja_id=o),L],placeholder:"== Pilih Rencana Penilaian ==","item-value":"rencana_budaya_kerja_id","item-title":"nama",items:a(s).rencana,clearable:"","clear-icon":"tabler-x","error-messages":a(V).rencana_budaya_kerja_id,loading:a(u).rencana,disabled:a(u).rencana},null,8,["modelValue","items","error-messages","loading","disabled"])]),_:1})]),_:1})]),_:1})]),_:1}),a(u).body?(b(),B(N,{key:0,class:"text-center"},{default:t(()=>[l(H,{size:60,indeterminate:"",color:"error",class:"my-10"})]),_:1})):E("",!0),a(s).aspek.length?(b(),c(v,{key:1},[l(R),l(na,{class:"text-no-wrap"},{default:t(()=>[i("thead",null,[i("tr",null,[e[10]||(e[10]=i("th",{class:"text-center border-right",rowspan:"2"},"Nama Peserta Didik",-1)),i("th",{class:"text-center",colspan:a(s).aspek.length},"Sub Elemen",8,sa)]),i("tr",null,[(b(!0),c(v,null,F(a(s).aspek,(o,p)=>(b(),c("th",da,[l(ra,{location:"top"},{activator:t(({props:k})=>[i("a",W({href:"javascript:void(0)",ref_for:!0},k),C(p+1),17)]),default:t(()=>[i("span",null,[i("p",null,[e[11]||(e[11]=i("strong",null,"Dimensi:",-1)),y(" "+C(o.budaya_kerja.aspek),1)]),i("p",null,[e[12]||(e[12]=i("strong",null,"Elemen:",-1)),y(" "+C(o.elemen_budaya_kerja.elemen),1)]),i("p",null,[e[13]||(e[13]=i("strong",null,"Sub Elemen:",-1)),y(" "+C(o.elemen_budaya_kerja.deskripsi),1)])])]),_:2},1024)]))),256))])]),i("tbody",null,[(b(!0),c(v,null,F(a(s).siswa,o=>(b(),c(v,null,[i("tr",null,[i("td",ma,[l(g,{item:o},null,8,["item"])]),(b(!0),c(v,null,F(a(s).aspek,p=>(b(),c("td",ua,[l(d,{modelValue:a(n).nilai[o.anggota_rombel.anggota_rombel_id+"#"+p.aspek_budaya_kerja_id],"onUpdate:modelValue":k=>a(n).nilai[o.anggota_rombel.anggota_rombel_id+"#"+p.aspek_budaya_kerja_id]=k,placeholder:"== Nilai ==",items:a(s).opsi,clearable:"","clear-icon":"tabler-x",style:{"inline-size":"8rem"},"item-title":"nama","item-value":k=>`${k.opsi_id}#${p.elemen_id}`},null,8,["modelValue","onUpdate:modelValue","items","item-value"])]))),256))]),i("tr",null,[i("td",{colspan:a(s).aspek.length,class:"py-4"},[l(ia,{label:"Catatan proses",placeholder:"Catatan proses",modelValue:a(n).deskripsi[a(n).rencana_budaya_kerja_id+"#"+o.anggota_rombel.anggota_rombel_id],"onUpdate:modelValue":p=>a(n).deskripsi[a(n).rencana_budaya_kerja_id+"#"+o.anggota_rombel.anggota_rombel_id]=p},null,8,["modelValue","onUpdate:modelValue"])],8,_a)])],64))),256))])]),_:1}),l(R),l(N,{class:"d-flex justify-end"},{default:t(()=>[l(J,{variant:"elevated",loading:a(j),disabled:a(j),type:"submit"},{default:t(()=>e[14]||(e[14]=[y(" Simpan ")])),_:1},8,["loading","disabled"])]),_:1})],64)):E("",!0)]),_:1},512),l(P,{isDialogVisible:a(D),"onUpdate:isDialogVisible":e[3]||(e[3]=o=>A(D)?D.value=o:null),isNotifVisible:a(h),"onUpdate:isNotifVisible":e[4]||(e[4]=o=>A(h)?h.value=o:null),"confirmation-question":"Apakah Anda yakin?","confirmation-text":"Tindakan ini tidak dapat dikembalikan!","confirm-color":a(x).color,"confirm-title":a(x).title,"confirm-msg":a(x).text,onClose:M},null,8,["isDialogVisible","isNotifVisible","confirm-color","confirm-title","confirm-msg"])]),_:1})}}};export{Ga as default};
