import{_ as Z}from"./ConfirmDialog-B0Bc_YJ5.js";import{_ as ee}from"./AppTextarea-wLIHAzmS.js";import{_ as ae}from"./ProfileSiswa-QBpSSY7_.js";import{_ as te}from"./DefaultForm-B0O35sh_.js";import{r as u,f as T,e as m,o as k,b as n,t as S,m as l,a2 as v,d as r,aa as M,y as U,c as w,am as le,h as oe,F as ne,ao as re,v as z}from"./main-DOWoIBhU.js";import{a as ie,d as P}from"./mixins-I8SXeutZ.js";import{$ as R}from"./api-CAM2bx0j.js";import{V as se,c as me,a as de,b as L}from"./VCard-DRBiftP4.js";import{V as q}from"./VDivider-DgEwy873.js";import{V as I,a as B}from"./VRow-B3Odvqxs.js";import{V as ue}from"./VTable-C1nYsmx8.js";import{V as pe}from"./VForm-BTJ1vPX0.js";import"./VDialog-BP5oy-x4.js";import"./VOverlay-Cnf91z5i.js";import"./forwardRefs-DWGaNmQL.js";import"./VImg-DYyAcwaz.js";import"./VLabel-Hm2kl-Y1.js";import"./AppTextField-DGISkcON.js";import"./VAvatar-B-Z9vLfD.js";import"./AppAutocomplete-Cj-BYPX6.js";import"./AppSelect-D1gjRk4-.js";import"./VList-DWH4RJSa.js";import"./VMenu-DeAbbdJl.js";import"./VSelectionControl-C8KMTZZ4.js";import"./VChip-Tdr48uqn.js";import"./filter-CR6gUgAk.js";import"./index-BxkgbwWS.js";/* empty css              */const ge={key:0,class:"text-center"},_e={class:"text-center"},fe={class:"text-center"},Ie={__name:"capaian-kompetensi",setup(be){const p=u({tingkat:null,rombongan_belajar_id:null,pembelajaran_id:null,mata_pelajaran_id:null}),h=u({tingkat:null,rombongan_belajar_id:null,pembelajaran_id:null}),g=u({rombel:[],mapel:[],siswa:[]}),_=u({body:!1,rombel:!1,mapel:!1}),j=u(!1),N=u(0),b={opsi:"capaian-kompetensi",semester_id:ie.semester_id,user_id:P.user_id,guru_id:P.guru_id,sekolah_id:P.sekolah_id,merdeka:!1},i=u({angka:{},kompeten:{},inkompeten:{}}),$=async o=>{const e={...o,...b};await R("/referensi/get-data",{method:"POST",body:e,onResponse({response:s}){let d=s._data;o.data=="rombel"&&(g.value.rombel=d),o.data=="mapel"&&(g.value.mapel=d.mapel,b.merdeka=d.merdeka)}})},G=async o=>{p.value.rombongan_belajar_id=null,p.value.pembelajaran_id=null,o&&(_.value.rombel=!0,await $({data:"rombel",nilai:1,tingkat:o}).then(()=>{_.value.rombel=!1}))},H=async o=>{p.value.pembelajaran_id=null,o&&(_.value.mapel=!0,await $({data:"mapel",nilai:1,rombongan_belajar_id:o}).then(()=>{_.value.mapel=!1}))},K=o=>o.charAt(0).toLowerCase()+o.slice(1),A=o=>{var e=/\+([a-z\d\/+]*\-?)/gi,s,d,f,a;return o.replace(e,function(t,V){for(s=Buffer(V,"base64"),d=s.length>>1<<1,f="",a=1,a;a<d;a=a+2)f+=String.fromCharCode(s.readUInt16BE(a-1));return f})},J=async o=>{if(g.value.siswa=[],o){const e={...p.value,...b};_.value.body=!0,j.value=!1,await R("/penilaian/get-capaian-kompetensi",{method:"POST",body:e,onResponse({response:s}){var f;let d=s._data;g.value.siswa=d.data_siswa,N.value=d.show_reset,j.value=!!((f=d.data_siswa)!=null&&f.length),_.value.body=!1,d.data_siswa.forEach(a=>{if(i.value.angka[a.anggota_rombel.anggota_rombel_id]=a.anggota_rombel.nilai_akhir_mapel?a.anggota_rombel.nilai_akhir_mapel.nilai:"",a.anggota_rombel.single_deskripsi_mata_pelajaran)i.value.kompeten[a.anggota_rombel.anggota_rombel_id]=a.anggota_rombel.single_deskripsi_mata_pelajaran.deskripsi_pengetahuan,i.value.inkompeten[a.anggota_rombel.anggota_rombel_id]=a.anggota_rombel.single_deskripsi_mata_pelajaran.deskripsi_keterampilan;else{var t=[],V=[];a.anggota_rombel.tp_kompeten.length?(a.anggota_rombel.tp_kompeten.forEach(c=>{t.push(A(K(c.tp.deskripsi)))}),i.value.kompeten[a.anggota_rombel.anggota_rombel_id]="Menunjukkan penguasaan yang baik dalam "+t.join(", ")):i.value.kompeten[a.anggota_rombel.anggota_rombel_id]=null,a.anggota_rombel.tp_inkompeten.length?(a.anggota_rombel.tp_inkompeten.forEach(c=>{V.push(A(K(c.tp.deskripsi)))}),i.value.inkompeten[a.anggota_rombel.anggota_rombel_id]="Perlu ditingkatkan dalam "+V.join(", ")):i.value.inkompeten[a.anggota_rombel.anggota_rombel_id]=null}})}})}},C=u(!1),x=u(!1),D=u(!1),E=u(""),y=u({color:"",title:"",text:""}),Q=async()=>{C.value=!0;const o={...b,...p.value,...i.value};await R("/penilaian/simpan",{method:"POST",body:o,onResponse({response:e}){let s=e._data;C.value=!1,s.errors?h.value=s.errors:(x.value=!0,y.value=s)}})},F=u(!1),O=()=>{F.value=!0,p.value={tingkat:null,rombongan_belajar_id:null,pembelajaran_id:null,mata_pelajaran_id:null},h.value={tingkat:null,rombongan_belajar_id:null,pembelajaran_id:null},g.value={rombel:[],mapel:[],siswa:[]},j.value=!1,N.value=0,i.value={angka:{},kompeten:{},inkompeten:{}}},W=()=>{O()},X=()=>{D.value=!0,E.value="Tindakan ini tidak dapat dikembalikan!",y.value={color:"warning",title:"a",text:"b"}},Y=async()=>{b.opsi="reset-kompetensi";const o={...b,...p.value,...i.value};await R("/penilaian/simpan",{method:"POST",body:o,onResponse({response:e}){let s=e._data;b.opsi="capaian-kompetensi",y.value=s,x.value=!0,O()}})};return(o,e)=>{const s=te,d=ae,f=ee,a=Z;return k(),T(se,{class:"mb-6"},{default:m(()=>[n(de,{class:"pb-4"},{default:m(()=>[n(me,null,{default:m(()=>e[7]||(e[7]=[S("Capaian Kompetensi")])),_:1})]),_:1}),n(q),n(pe,{onSubmit:re(Q,["prevent"])},{default:m(()=>[n(L,null,{default:m(()=>[n(I,null,{default:m(()=>[n(s,{form:l(p),"onUpdate:form":e[0]||(e[0]=t=>v(p)?p.value=t:null),errors:l(h),"onUpdate:errors":e[1]||(e[1]=t=>v(h)?h.value=t:null),arrayData:l(g),"onUpdate:arrayData":e[2]||(e[2]=t=>v(g)?g.value=t:null),loading:l(_),"onUpdate:loading":e[3]||(e[3]=t=>v(_)?_.value=t:null),resetForm:l(F),"onUpdate:resetForm":e[4]||(e[4]=t=>v(F)?F.value=t:null),onTingkat:G,onRombongan_belajar_id:H,onPembelajaran_id:J},null,8,["form","errors","arrayData","loading","resetForm"]),l(N)?(k(),T(B,{key:0,cols:"12"},{default:m(()=>[n(I,{"no-gutters":""},{default:m(()=>[n(B,{cols:"12",md:"3",class:"d-flex align-items-center"},{default:m(()=>e[8]||(e[8]=[r("label",{class:"v-label text-body-2 text-high-emphasis"},"Reset Capaian Kompetensi",-1)])),_:1}),n(B,{cols:"12",md:"9"},{default:m(()=>[n(M,{variant:"tonal",color:"error",onClick:X},{default:m(()=>e[9]||(e[9]=[S(" Reset Capaian Kompetensi ")])),_:1})]),_:1})]),_:1})]),_:1})):U("",!0)]),_:1}),l(_).body?(k(),w("div",ge,[n(le,{size:60,indeterminate:"",color:"error",class:"my-10"})])):U("",!0)]),_:1}),l(g).siswa.length?(k(),T(ue,{key:0},{default:m(()=>[e[10]||(e[10]=r("thead",null,[r("tr",null,[r("th",{class:"text-center",rowspan:"2",style:{"vertical-align":"middle"}},"No"),r("th",{class:"text-center",rowspan:"2",style:{"vertical-align":"middle"}},"Nama Peserta Didik"),r("th",{class:"text-center",rowspan:"2",style:{"vertical-align":"middle"}},"Nilai Akhir"),r("th",{class:"text-center",colspan:"2"},"Capaian Kompetensi")]),r("tr",null,[r("th",{class:"text-center"},"Kompetensi yang telah dicapai"),r("th",{class:"text-center"},"Kompetensi yang perlu ditingkatkan")])],-1)),r("tbody",null,[(k(!0),w(ne,null,oe(l(g).siswa,(t,V)=>(k(),w("tr",null,[r("td",_e,z(V+1),1),r("td",null,[n(d,{item:t},null,8,["item"])]),r("td",fe,z(l(i).angka[t.anggota_rombel.anggota_rombel_id]),1),r("td",null,[n(f,{modelValue:l(i).kompeten[t.anggota_rombel.anggota_rombel_id],"onUpdate:modelValue":c=>l(i).kompeten[t.anggota_rombel.anggota_rombel_id]=c,placeholder:"Kompetensi yang telah dicapai",class:"py-2 px-2"},null,8,["modelValue","onUpdate:modelValue"])]),r("td",null,[n(f,{modelValue:l(i).inkompeten[t.anggota_rombel.anggota_rombel_id],"onUpdate:modelValue":c=>l(i).inkompeten[t.anggota_rombel.anggota_rombel_id]=c,placeholder:"Kompetensi yang perlu ditingkatkan"},null,8,["modelValue","onUpdate:modelValue"])])]))),256))])]),_:1})):U("",!0),n(q),l(j)?(k(),T(L,{key:1,class:"d-flex justify-end flex-wrap gap-3 pt-5 overflow-visible"},{default:m(()=>[n(M,{variant:"elevated",type:"submit",loading:l(C),disabled:l(C)},{default:m(()=>e[11]||(e[11]=[S(" Simpan ")])),_:1},8,["loading","disabled"])]),_:1})):U("",!0)]),_:1}),n(a,{isDialogVisible:l(D),"onUpdate:isDialogVisible":e[5]||(e[5]=t=>v(D)?D.value=t:null),isNotifVisible:l(x),"onUpdate:isNotifVisible":e[6]||(e[6]=t=>v(x)?x.value=t:null),"confirmation-question":"Apakah Anda yakin?","confirmation-text":l(E),"confirm-color":l(y).color,"confirm-title":l(y).title,"confirm-msg":l(y).text,onConfirm:Y,onClose:W},null,8,["isDialogVisible","isNotifVisible","confirmation-text","confirm-color","confirm-title","confirm-msg"])]),_:1})}}};export{Ie as default};
