import{_ as K}from"./ConfirmDialog-CY_9uydO.js";import{_ as L}from"./AppTextField-BYQvWqvk.js";import{_ as M}from"./ProfileSiswa-BoXX9sbX.js";import{_ as O}from"./AppAutocomplete-CoTPRzAH.js";import{G as q,r as u,c as x,b as a,e as o,m as e,a2 as z,F as D,o as c,t as P,ap as G,d as s,f as H,am as J,y as R,h as Q,aa as W}from"./main-BpmS5yjl.js";import{d as j,a as T}from"./mixins-CToSDW15.js";import{$}from"./api-CqoQuUrQ.js";import{V as X,a as Y,c as Z,b as U}from"./VCard-CHmpSx-c.js";import{V as ee}from"./VDivider-gWeRf3Xl.js";import{V as ae}from"./VForm-BtS5s1QD.js";import{V as F,a as b}from"./VRow-BacuoGYF.js";import{V as le}from"./VTable-DH5oZuZ_.js";import"./VDialog-DmAehLsX.js";import"./VOverlay-yY7p8is2.js";import"./forwardRefs-DWGaNmQL.js";import"./scopeId-DiP191uI.js";import"./VImg-1iDcvPVu.js";import"./VLabel-D6Y69236.js";/* empty css                   */import"./VField-Cktymv3Q.js";import"./VAvatar-CwdAusxZ.js";import"./VSelect-D2E-ncti.js";import"./VList-CAazeH9Z.js";import"./ssrBoot-C9ygE__7.js";import"./VMenu-RpUw0xGr.js";import"./VSelectionControl-Bjw4k3ug.js";import"./VChip-Ce3c0jwR.js";import"./VSlideGroup-ZqIn0ESw.js";import"./filter-B41lvxns.js";import"./index-BxkgbwWS.js";/* empty css              */const ie={class:"text-no-wrap border-right align-top"},te={class:"py-4"},oe={class:"py-4"},re={class:"py-4"},Ie={__name:"ketidakhadiran",setup(de){q(async()=>{d.value.rombel=!0,await g({data:"rombel"}).then(()=>{d.value.rombel=!1})});const w=u({user_id:j.user_id,guru_id:j.guru_id,sekolah_id:j.sekolah_id,semester_id:T.semester_id,periode_aktif:T.nama}),i=u({aksi:"absen",rombongan_belajar_id:void 0,pkl_id:void 0,peserta_didik_id:{},sakit:{},izin:{},alpa:{}}),k=u({rombongan_belajar_id:void 0,pkl_id:void 0}),n=u({rombel:[],pkl:[],siswa:[]}),d=u({rombel:!1,pkl:!1,body:!1}),g=async r=>{const l={...r,...w.value,...i.value};await $("/praktik-kerja-lapangan/get-data",{method:"POST",body:l,async onResponse({response:p}){let _=p._data;r.data=="rombel"&&(n.value.rombel=_),r.data=="pkl"&&(n.value.pkl=_),r.data=="siswa"&&(n.value.siswa=_.siswa,n.value.tp=_.tp,_.siswa.forEach(m=>{var h,t,f;i.value.peserta_didik_id[m.peserta_didik_id]=m.peserta_didik_id,i.value.sakit[m.peserta_didik_id]=((h=m.absensi_pkl)==null?void 0:h.sakit)??null,i.value.izin[m.peserta_didik_id]=((t=m.absensi_pkl)==null?void 0:t.izin)??null,i.value.alpa[m.peserta_didik_id]=((f=m.absensi_pkl)==null?void 0:f.alpa)??null}))}})},B=async r=>{i.value.pkl_id=null,n.value.pkl=[],r&&(d.value.pkl=!0,await g({data:"pkl"}).then(()=>{d.value.pkl=!1}))},S=async r=>{n.value.siswa=[],n.value.tp=[],r&&(d.value.body=!0,await g({data:"siswa"}).then(()=>{d.value.body=!1}))},N=u(),V=u(!1),v=u(!1),C=u(!1),y=u({color:void 0,title:void 0,text:void 0}),A=async()=>{var r;(r=N.value)==null||r.validate().then(({valid:l})=>{l&&I()})},I=async()=>{V.value=!0;const r={...w.value,...i.value};await $("/praktik-kerja-lapangan/save",{method:"POST",body:r,onResponse({response:l}){V.value=!1;let p=l._data;p.errors?k.value=p.errors:(E(),v.value=!0,y.value=p)}})},E=async()=>{i.value={aksi:"absen",rombongan_belajar_id:void 0,pkl_id:void 0,peserta_didik_id:{},sakit:{},izin:{},alpa:{}},k.value={rombongan_belajar_id:void 0,pkl_id:void 0},n.value={rombel:[],pkl:[],siswa:[]},d.value.rombel=!0,await g({data:"rombel"}).then(()=>{d.value.rombel=!1})};return(r,l)=>{const p=O,_=M,m=L,h=K;return c(),x(D,null,[a(X,{class:"mb-6"},{default:o(()=>[a(Y,{class:"pb-4"},{default:o(()=>[a(Z,null,{default:o(()=>l[4]||(l[4]=[P("Input Ketidakhadiran PKL")])),_:1})]),_:1}),a(ee),a(ae,{ref_key:"refVForm",ref:N,onSubmit:G(A,["prevent"])},{default:o(()=>[a(U,null,{default:o(()=>[a(F,null,{default:o(()=>[a(b,{cols:"12"},{default:o(()=>[a(F,{"no-gutters":""},{default:o(()=>[a(b,{cols:"12",md:"3",class:"d-flex align-items-center"},{default:o(()=>l[5]||(l[5]=[s("label",{class:"v-label text-body-2 text-high-emphasis",for:"rombongan_belajar_id"},"Rombongan Belajar",-1)])),_:1}),a(b,{cols:"12",md:"9"},{default:o(()=>[a(p,{modelValue:e(i).rombongan_belajar_id,"onUpdate:modelValue":[l[0]||(l[0]=t=>e(i).rombongan_belajar_id=t),B],placeholder:"== Pilih Rombongan Belajar == ",items:e(n).rombel,clearable:"","clear-icon":"tabler-x","item-value":"rombongan_belajar_id","item-title":"nama",loading:e(d).rombel,disabled:e(d).rombel,"error-messages":e(k).rombongan_belajar_id},null,8,["modelValue","items","loading","disabled","error-messages"])]),_:1})]),_:1})]),_:1}),a(b,{cols:"12"},{default:o(()=>[a(F,{"no-gutters":""},{default:o(()=>[a(b,{cols:"12",md:"3",class:"d-flex align-items-center"},{default:o(()=>l[6]||(l[6]=[s("label",{class:"v-label text-body-2 text-high-emphasis",for:"pkl_id"},"DUDI",-1)])),_:1}),a(b,{cols:"12",md:"9"},{default:o(()=>[a(p,{modelValue:e(i).pkl_id,"onUpdate:modelValue":[l[1]||(l[1]=t=>e(i).pkl_id=t),S],placeholder:"== Pilih DUDI == ",items:e(n).pkl,clearable:"","clear-icon":"tabler-x","item-value":"pkl_id","item-title":"nama_dudi",loading:e(d).pkl,disabled:e(d).pkl,"error-messages":e(k).pkl_id},null,8,["modelValue","items","loading","disabled","error-messages"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(d).body?(c(),H(U,{key:0,class:"text-center"},{default:o(()=>[a(J,{size:60,indeterminate:"",color:"error"})]),_:1})):R("",!0),e(n).siswa.length?(c(),x(D,{key:1},[a(le,null,{default:o(()=>[l[7]||(l[7]=s("thead",null,[s("tr",null,[s("th",null,"Nama Peserta Didik"),s("th",{class:"text-center"},"Sakit"),s("th",{class:"text-center"},"Izin"),s("th",{class:"text-center"},"Alpa")])],-1)),s("tbody",null,[(c(!0),x(D,null,Q(e(n).siswa,t=>(c(),x("tr",null,[s("td",ie,[a(_,{item:t},null,8,["item"])]),s("td",te,[a(m,{modelValue:e(i).sakit[t.peserta_didik_id],"onUpdate:modelValue":f=>e(i).sakit[t.peserta_didik_id]=f},null,8,["modelValue","onUpdate:modelValue"])]),s("td",oe,[a(m,{modelValue:e(i).izin[t.peserta_didik_id],"onUpdate:modelValue":f=>e(i).izin[t.peserta_didik_id]=f},null,8,["modelValue","onUpdate:modelValue"])]),s("td",re,[a(m,{modelValue:e(i).alpa[t.peserta_didik_id],"onUpdate:modelValue":f=>e(i).alpa[t.peserta_didik_id]=f},null,8,["modelValue","onUpdate:modelValue"])])]))),256))])]),_:1}),a(U,{class:"d-flex justify-end flex-wrap gap-3 pt-5"},{default:o(()=>[a(W,{variant:"elevated",type:"submit",loading:e(V),disabled:e(V)},{default:o(()=>l[8]||(l[8]=[P(" Simpan ")])),_:1},8,["loading","disabled"])]),_:1})],64)):R("",!0)]),_:1},512)]),_:1}),a(h,{isDialogVisible:e(C),"onUpdate:isDialogVisible":l[2]||(l[2]=t=>z(C)?C.value=t:null),isNotifVisible:e(v),"onUpdate:isNotifVisible":l[3]||(l[3]=t=>z(v)?v.value=t:null),"confirmation-question":"Apakah Anda yakin?","confirmation-text":"Tindakan ini tidak dapat dikembalikan!","confirm-color":e(y).color,"confirm-title":e(y).title,"confirm-msg":e(y).text,onConfirm:r.confirmDelete,onClose:r.confirmClose},null,8,["isDialogVisible","isNotifVisible","confirm-color","confirm-title","confirm-msg","onConfirm","onClose"])],64)}}};export{Ie as default};
