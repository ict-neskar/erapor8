import{r as A}from"./validators-BHkKs9Dp.js";import{r as n,G as K,c as Y,d as o,m as a,v as b,b as s,e as r,F as z,i as J,j as Q,a as W,o as g,H as c,f as k,t as y,ao as X,aa as Z,y as ee,a8 as u,ap as ae}from"./main-CSMdQ8mb.js";import{_ as se}from"./AppSelect-CeXS5wcI.js";import{_ as te}from"./AppTextField-Duq1qxek.js";import{u as D,a as oe,b as re}from"./misc-mask-light-C2oZDvJJ.js";import{a as L,l as N}from"./index-DI7F95Gi.js";import{u as le}from"./useAbility-Cv_9vl1L.js";import{$ as ie}from"./api-mpQpYnTe.js";import{u as ne,c as ue}from"./createUrl-Dffv--5r.js";import{V as B,a as d}from"./VRow-CmcOkPQS.js";import{V as j}from"./VImg-Coh-qlqv.js";import{V as me,b as w}from"./VCard-BZDGD_jp.js";import{V as de}from"./VForm-Cj0oB0hN.js";import{V as pe}from"./VCheckbox-BAws5aRN.js";import"./VLabel-C8L1S7dm.js";import"./forwardRefs-DWGaNmQL.js";import"./VList-CSs9t2aq.js";import"./VAvatar-BCC8MQt3.js";import"./VDivider-DpMv7xOp.js";import"./VOverlay-DZAOnpyg.js";import"./VMenu-mjtxgdnd.js";import"./VSelectionControl-DCgpgMre.js";import"./VChip-IKqjzZw0.js";import"./index-BxkgbwWS.js";/* empty css              */const ce="/build/assets/auth-v2-login-illustration-bordered-dark-cDkPk8mY.png",fe="/build/assets/auth-v2-login-illustration-bordered-light-CIHqcIVA.png",ge={href:"javascript:void(0)"},he={class:"auth-logo d-flex align-center gap-x-3"},ve=["src"],Ve={class:"auth-title"},_e={class:"position-relative bg-background w-100 me-0"},be={class:"d-flex align-center justify-center w-100 h-100",style:{"padding-inline":"6.25rem"}},ke=["src"],ye={class:"text-h2 mb-1"},we=["src"],xe={class:"d-flex align-center flex-wrap justify-space-between my-6"},We={__name:"login",setup(Se){const q=D(L,L,fe,ce,!0),U=D(re,oe),x=n(),l=n({email:"",password:"",semester_id:"",remember:!1}),S=J(),M=Q(),$=le(),h=n({email:void 0,password:void 0}),f=n(!1),T=n([]),I=n(""),F=()=>{N(`<strong>Selamat Datang ${I.value}</strong>
    <br>Anda telah berhasil masuk sebagai <strong>${T.value}</strong>. Sekarang Anda dapat mulai berselancar di Aplikasi e-Rapor SMK!`,{closeOnClick:!1,autoClose:5e3,position:N.POSITION.TOP_RIGHT,dangerouslyHTMLString:!0})},p=n(!1),O=async()=>{p.value=!0;try{const t=await ie("/auth/login",{method:"POST",body:{email:l.value.email,password:l.value.password,semester_id:l.value.semester_id},onResponseError({response:G}){h.value=G._data.errors,p.value=!1}}),{accessToken:e,userData:m,sekolah:V,semester:_,userAbility:i,roles:R}=t;I.value=m.name,u("userAbilityRules").value=i,$.update(i),u("userData").value=m,u("accessToken").value=e,u("sekolah").value=V,u("semester").value=_,u("roles").value=R,u("profilePhotoPath").value=m.profile_photo_path,T.value=R.join(", "),p.value=!1,await ae(()=>{M.replace(S.query.to?String(S.query.to):"/").then(()=>{F()})})}catch(t){console.error(t)}},E=()=>{var t;(t=x.value)==null||t.validate().then(({valid:e})=>{e&&O()})},C=n(!1),P=n([]),v=n();K(async()=>{await H()});const H=async()=>{try{let e=(await ne(ue("/auth/semester"))).data.value;P.value=e.semester,l.value.semester_id=e.semester_id,C.value=e.allowRegister,v.value=e.bg_login}catch(t){console.error(t)}};return(t,e)=>{const m=te,V=se,_=W("RouterLink");return g(),Y(z,null,[o("a",ge,[o("div",he,[o("img",{src:a(c).app.logo,height:"24"},null,8,ve),o("h1",Ve,b(a(c).app.title),1)])]),s(B,{"no-gutters":"",class:"auth-wrapper bg-surface"},{default:r(()=>[s(d,{md:"8",class:"d-none d-md-flex"},{default:r(()=>[o("div",_e,[o("div",be,[a(v)?(g(),k(j,{key:0,"max-width":"613",src:a(v),class:"auth-illustration mt-16 mb-2"},null,8,["src"])):(g(),k(j,{key:1,"max-width":"613",src:a(q),class:"auth-illustration mt-16 mb-2"},null,8,["src"]))]),o("img",{class:"auth-footer-mask flip-in-rtl",src:a(U),alt:"auth-footer-mask",height:"280",width:"100"},null,8,ke)])]),_:1}),s(d,{cols:"12",md:"4",class:"auth-card-v2 d-flex align-center justify-center"},{default:r(()=>[s(me,{flat:"","max-width":500,class:"mt-sm-0 pa-6"},{default:r(()=>[s(w,{class:"text-center"},{default:r(()=>[o("h1",ye,[o("img",{src:a(c).app.logo,height:"28"},null,8,we),y(" "+b(a(c).app.title),1)]),o("p",null,"Versi "+b(a(c).app.version),1),e[5]||(e[5]=o("p",{class:"mb-0"},"Silahkan login untuk dapat mengakses Aplikasi",-1))]),_:1}),s(w,null,{default:r(()=>[s(de,{ref_key:"refVForm",ref:x,onSubmit:X(E,["prevent"])},{default:r(()=>[s(B,null,{default:r(()=>[s(d,{cols:"12"},{default:r(()=>[s(m,{modelValue:a(l).email,"onUpdate:modelValue":e[0]||(e[0]=i=>a(l).email=i),"error-messages":a(h).email,autofocus:"",label:"Email/NUPTK/NISN",placeholder:"Email/NUPTK/NISN",rules:["requiredValidator"in t?t.requiredValidator:a(A)]},null,8,["modelValue","error-messages","rules"])]),_:1}),s(d,{cols:"12"},{default:r(()=>[s(m,{modelValue:a(l).password,"onUpdate:modelValue":e[1]||(e[1]=i=>a(l).password=i),"error-messages":a(h).password,label:"Password",placeholder:"············",type:a(f)?"text":"password",autocomplete:"password","append-inner-icon":a(f)?"tabler-eye-off":"tabler-eye","onClick:appendInner":e[2]||(e[2]=i=>f.value=!a(f)),rules:["requiredValidator"in t?t.requiredValidator:a(A)]},null,8,["modelValue","error-messages","type","append-inner-icon","rules"])]),_:1}),s(d,{cols:"12"},{default:r(()=>[s(V,{items:a(P),"item-title":"nama","item-value":"semester_id",label:"Tahun Pelajaran",modelValue:a(l).semester_id,"onUpdate:modelValue":e[3]||(e[3]=i=>a(l).semester_id=i),placeholder:"Select Item"},null,8,["items","modelValue"]),o("div",xe,[s(pe,{modelValue:a(l).remember,"onUpdate:modelValue":e[4]||(e[4]=i=>a(l).remember=i),label:"Simpan Login"},null,8,["modelValue"]),e[6]||(e[6]=o("a",{class:"text-primary",href:"javascript:void(0)"}," Lupa Password? ",-1))]),s(Z,{block:"",type:"submit",loading:a(p),disabled:a(p)},{default:r(()=>e[7]||(e[7]=[y(" Login ")])),_:1},8,["loading","disabled"])]),_:1}),a(C)?(g(),k(d,{key:0,cols:"12",class:"text-center"},{default:r(()=>[e[9]||(e[9]=o("span",null,"Pengguna Baru?",-1)),s(_,{class:"text-primary ms-1",to:{name:"register"}},{default:r(()=>e[8]||(e[8]=[y(" Register Disini ")])),_:1})]),_:1})):ee("",!0)]),_:1})]),_:1},512)]),_:1}),s(w)]),_:1})]),_:1})]),_:1})],64)}}};export{We as default};
