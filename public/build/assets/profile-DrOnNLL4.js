import{_ as C}from"./AppTextField-CpIb7EwY.js";import{r as d,G as N,c as S,b as e,e as a,o as v,d as p,m as t,f as w,v as x,t as y,y as U,am as D,ap as K,aa as T,a8 as A,ab as E}from"./main-WcaAB0Vb.js";import{u as j,c as I}from"./createUrl-5K3jXwP3.js";import{$}from"./api-bn4q6wV9.js";import{V as m,a as s}from"./VRow-e-Ng4Tme.js";import{V as L,b as V}from"./VCard-B6efkknt.js";import{V as M}from"./VDivider-DIWjfe5J.js";import{V as R}from"./VAlert-CjOr7Ksk.js";import{V as q}from"./VForm-Ceyv7-oM.js";import{V as z}from"./VImg-BR-W7-GF.js";import{V as G}from"./VFileInput-BxfRpVfA.js";import"./VLabel-6jXlAgoN.js";/* empty css                   */import"./VField-Bv5GDULG.js";import"./forwardRefs-DWGaNmQL.js";import"./index-BxkgbwWS.js";/* empty css              */import"./VAvatar-C5PogN-2.js";import"./VChip-LzakvH-4.js";import"./VSlideGroup-aRldGfCL.js";const ce={__name:"profile",setup(O){const h=d(!0),b=d(),f=d(),_=d(!1),c=d({color:"",title:"",text:""}),l=d({name:null,email:null,password:null,password_confirmation:null,photo:null});N(async()=>{await k()});const k=async()=>{try{let o=(await j(I("/auth/user"))).data.value;l.value.name=o.name,l.value.email=o.email,f.value=o.profile_photo_path}catch(r){console.error(r)}finally{h.value=!1}},F=()=>{var r;(r=b.value)==null||r.validate().then(({valid:o})=>{o&&B()})},i=d({name:void 0,email:void 0,password:void 0,password_confirmation:void 0,photo:void 0}),P=E("erapor"),B=async()=>{i.value={name:void 0,email:void 0,password:void 0,password_confirmation:void 0,photo:void 0};const r=new FormData;r.append("data","user"),r.append("name",l.value.name?l.value.name:""),r.append("email",l.value.email?l.value.email:""),r.append("password",l.value.password?l.value.password:""),r.append("password_confirmation",l.value.password_confirmation?l.value.password_confirmation:""),r.append("photo",l.value.photo?l.value.photo:""),await $("/auth/user",{method:"POST",body:r,onResponse({request:o,response:u,options:n}){let g=u._data;if(g.errors)i.value=g.errors;else{_.value=!0,c.value=g,l.value.photo=null,l.value.password=null,l.value.password_confirmation=null,f.value=g.user.profile_photo_path,A("profilePhotoPath").value=f.value;try{P.emit(f.value)}catch{}setTimeout(()=>{_.value=!1},5e3)}}})};return(r,o)=>{const u=C;return v(),S("div",null,[e(m,null,{default:a(()=>[e(s,{cols:"12"},{default:a(()=>[e(L,{title:"Informasi Profil Pengguna"},{append:a(()=>o[5]||(o[5]=[p("span",{class:"text-disabled text-subtitle-2"},"Perbaharui informasi profil dan alamat email akun Anda jika diperlukan.",-1)])),default:a(()=>[e(M),t(_)?(v(),w(V,{key:0},{default:a(()=>[e(R,{border:"bottom",color:t(c).color,variant:"tonal"},{default:a(()=>[p("strong",null,x(t(c).title),1),y(" "+x(t(c).text),1)]),_:1},8,["color"])]),_:1})):U("",!0),t(h)?(v(),w(V,{key:1,class:"text-center"},{default:a(()=>[e(D,{size:60,indeterminate:"",color:"error"})]),_:1})):(v(),w(V,{key:2},{default:a(()=>[e(q,{ref_key:"refVForm",ref:b,onSubmit:K(F,["prevent"])},{default:a(()=>[e(m,null,{default:a(()=>[e(s,{cols:"8"},{default:a(()=>[e(m,null,{default:a(()=>[e(s,{cols:"12"},{default:a(()=>[e(m,{"no-gutters":""},{default:a(()=>[e(s,{cols:"12",md:"3",class:"d-flex align-items-center"},{default:a(()=>o[6]||(o[6]=[p("label",{class:"v-label text-body-2 text-high-emphasis",for:"name"},"Nama Lengkap",-1)])),_:1}),e(s,{cols:"12",md:"9"},{default:a(()=>[e(u,{id:"name",modelValue:t(l).name,"onUpdate:modelValue":o[0]||(o[0]=n=>t(l).name=n),placeholder:"Nama Lengkap","persistent-placeholder":"","error-messages":t(i).name},null,8,["modelValue","error-messages"])]),_:1})]),_:1})]),_:1}),e(s,{cols:"12"},{default:a(()=>[e(m,{"no-gutters":""},{default:a(()=>[e(s,{cols:"12",md:"3",class:"d-flex align-items-center"},{default:a(()=>o[7]||(o[7]=[p("label",{class:"v-label text-body-2 text-high-emphasis",for:"email"},"Email",-1)])),_:1}),e(s,{cols:"12",md:"9"},{default:a(()=>[e(u,{id:"email",type:"email",modelValue:t(l).email,"onUpdate:modelValue":o[1]||(o[1]=n=>t(l).email=n),placeholder:"Email","persistent-placeholder":"","error-messages":t(i).email},null,8,["modelValue","error-messages"])]),_:1})]),_:1})]),_:1}),e(s,{cols:"12"},{default:a(()=>[e(m,{"no-gutters":""},{default:a(()=>[e(s,{cols:"12",md:"3",class:"d-flex align-items-center"},{default:a(()=>o[8]||(o[8]=[p("label",{class:"v-label text-body-2 text-high-emphasis",for:"password"},"Kata Sandi Baru",-1)])),_:1}),e(s,{cols:"12",md:"9"},{default:a(()=>[e(u,{id:"password",type:"password",modelValue:t(l).password,"onUpdate:modelValue":o[2]||(o[2]=n=>t(l).password=n),placeholder:"Kosongkan jika tidak ingin mengganti kata sandi","persistent-placeholder":"","error-messages":t(i).password},null,8,["modelValue","error-messages"])]),_:1})]),_:1})]),_:1}),e(s,{cols:"12"},{default:a(()=>[e(m,{"no-gutters":""},{default:a(()=>[e(s,{cols:"12",md:"3",class:"d-flex align-items-center"},{default:a(()=>o[9]||(o[9]=[p("label",{class:"v-label text-body-2 text-high-emphasis",for:"password_confirmation"},"Konfirmasi Kata Sandi",-1)])),_:1}),e(s,{cols:"12",md:"9"},{default:a(()=>[e(u,{id:"password_confirmation",type:"password",modelValue:t(l).password_confirmation,"onUpdate:modelValue":o[3]||(o[3]=n=>t(l).password_confirmation=n),placeholder:"Kosongkan jika tidak ingin mengganti kata sandi","persistent-placeholder":"","error-messages":t(i).password_confirmation},null,8,["modelValue","error-messages"])]),_:1})]),_:1})]),_:1}),e(s,{"offset-md":"3",cols:"12",md:"9",class:"d-flex gap-4"},{default:a(()=>[e(T,{type:"submit"},{default:a(()=>o[10]||(o[10]=[y(" Submit ")])),_:1})]),_:1})]),_:1})]),_:1}),e(s,{cols:"4",class:"text-center"},{default:a(()=>[e(z,{alt:t(l).name,src:t(f),cover:"",class:"mx-auto mb-10",width:"250px"},null,8,["alt","src"]),e(G,{modelValue:t(l).photo,"onUpdate:modelValue":o[4]||(o[4]=n=>t(l).photo=n),"error-messages":t(i).photo,accept:"image/*",label:"Unggah Foto Profil"},null,8,["modelValue","error-messages"])]),_:1})]),_:1})]),_:1},512)]),_:1})),e(V)]),_:1})]),_:1})]),_:1})])}}};export{ce as default};
