import{r as k}from"./validators-CXK_eVNV.js";import{r as n,G as C,c as $,b as o,e as i,m as l,a2 as x,o as m,f,am as J,ap as N,d as M,$ as O,aa as E,t as Z}from"./main-4ibPTuoX.js";import{_ as G}from"./AlertDialog-CuzkofM7.js";import{_ as H}from"./AppTextField-Bdwte880.js";import{i as Y,_ as Q}from"./id-Qx8JmyYn.js";import{_ as X}from"./AppSelect-DFrAhbhb.js";import{u as ee,c as ae}from"./createUrl-8zoAcX36.js";import{d as A,a as D}from"./mixins-BjVJEZvR.js";import{$ as K}from"./api-Bkbcc4ec.js";import{V as le,b as B}from"./VCard-CswHtBsG.js";import{V as oe}from"./VDivider-DBczu0Ow.js";import{V as te}from"./VForm-BUGxzJlr.js";import{V as j,a as s}from"./VRow-C9aDKUvo.js";import{V as h}from"./VFileInput-CjthOGiK.js";import{V as re}from"./VImg-B9UUOYt7.js";import"./VDialog-BkAb0UEZ.js";import"./VOverlay-Dt1Dy2Gr.js";import"./forwardRefs-DWGaNmQL.js";import"./scopeId-DgdHYkHx.js";import"./VLabel-B0eCB5jg.js";/* empty css                   */import"./VField-DDWomVtf.js";import"./_commonjsHelpers-Cpj98o6Y.js";import"./VSelect-CJIVueWh.js";import"./VList-DRMF5v6F.js";import"./ssrBoot-CGBhTCaE.js";import"./VAvatar-DuOErqu_.js";import"./VMenu-HPtXLDMp.js";import"./VSelectionControl-Dw3cA4UE.js";import"./VChip-ClHLREYK.js";import"./VSlideGroup-DECG9arN.js";import"./index-BxkgbwWS.js";/* empty css              */const Ce={__name:"umum",setup(ie){const c=n(),e=n({semester_id:null,tanggal_rapor:null,tanggal_rapor_kelas_akhir:null,zona:null,kepala_sekolah:null,jabatan:null,rombel_4_tahun:[],url_dapodik:null,token_dapodik:null,photo:null,bg_login:null});C(async()=>{await b()});const v=n([]),S=n([]),T=n([]),U=n(!0),p=n(!1),g=n({color:"",title:"",text:""}),y=n(),b=async()=>{try{let a=(await ee(ae("/setting",{query:{sekolah_id:A.sekolah_id,semester_id:D.semester_id}}))).data.value;v.value=a.semester,S.value=a.data_guru,T.value=a.data_rombel,y.value=a.bg_login,e.value.semester_id=a.semester_id,e.value.tanggal_rapor=a.tanggal_rapor,e.value.tanggal_rapor_kelas_akhir=a.tanggal_rapor_kelas_akhir,e.value.zona=a.zona,e.value.kepala_sekolah=a.kepala_sekolah,e.value.jabatan=a.jabatan,e.value.rombel_4_tahun=a.rombel_4_tahun,e.value.url_dapodik=a.url_dapodik,e.value.token_dapodik=a.token_dapodik,a.logo_sekolah&&(P.value=a.logo_sekolah)}catch(t){console.error(t)}finally{U.value=!1}},R=n([{value:"Asia/Jakarta",title:"Waktu Indonesia Barat (WIB)"},{value:"Asia/Makassar",title:"Waktu Indonesia Tengah (WITA)"},{value:"Asia/Jayapura",title:"Waktu Indonesia Timur (WIT)"}]),z=n([{value:"Kepala Sekolah",title:"Kepala Sekolah"},{value:"Plt. Kepala Sekolah",title:"PLT Kepala Sekolah"},{value:"Plh. Kepala Sekolah",title:"PLH Kepala Sekolah"}]),P=n("/images/logo/tutwuri.png"),F=()=>{var t;(t=c.value)==null||t.validate().then(({valid:a})=>{a&&I()})},_=n({photo:void 0,bg_login:void 0}),I=async()=>{const t=new FormData;t.append("photo",e.value.photo?e.value.photo:""),t.append("bg_login",e.value.bg_login?e.value.bg_login:""),t.append("semester_id",e.value.semester_id),t.append("sekolah_id",A.sekolah_id),t.append("semester_aktif",D.semester_id),t.append("tanggal_rapor_pts",e.value.tanggal_rapor_pts?e.value.tanggal_rapor_pts:""),t.append("tanggal_rapor",e.value.tanggal_rapor?e.value.tanggal_rapor:""),t.append("tanggal_rapor_kelas_akhir",e.value.tanggal_rapor_kelas_akhir?e.value.tanggal_rapor_kelas_akhir:""),t.append("zona",e.value.zona?e.value.zona:""),t.append("kepala_sekolah",e.value.kepala_sekolah?e.value.kepala_sekolah:""),t.append("jabatan",e.value.jabatan?e.value.jabatan:""),t.append("rombel_4_tahun",JSON.stringify(e.value.rombel_4_tahun)),t.append("url_dapodik",e.value.url_dapodik?e.value.url_dapodik:""),t.append("token_dapodik",e.value.token_dapodik?e.value.token_dapodik:""),await K("/setting/update",{method:"POST",body:t,onResponse({request:a,response:d,options:V}){let u=d._data;u.errors?_.value=u.errors:(p.value=!0,g.value={color:u.color,title:u.title,text:u.text})}})},w=()=>{b(),e.value.photo=null,e.value.bg_login=null},q=n({locale:Y.Indonesian,altFormat:"j F Y",altInput:!0}),L=async()=>{console.log("resetBgLogin"),await K("/setting/reset-bg",{method:"POST",onResponse(){b()}})};return(t,a)=>{const d=X,V=Q,u=H,W=G;return m(),$("section",null,[o(le,{title:"Pengaturan Umum"},{default:i(()=>[o(oe),l(U)?(m(),f(B,{key:0,class:"text-center"},{default:i(()=>[o(J,{size:60,indeterminate:"",color:"error"})]),_:1})):(m(),f(B,{key:1},{default:i(()=>[o(te,{ref_key:"refVForm",ref:c,onSubmit:N(F,["prevent"])},{default:i(()=>[o(j,null,{default:i(()=>[o(s,{cols:"7"},{default:i(()=>[o(j,null,{default:i(()=>[o(s,{cols:"12"},{default:i(()=>[o(d,{modelValue:l(e).semester_id,"onUpdate:modelValue":a[0]||(a[0]=r=>l(e).semester_id=r),items:l(v),rules:["requiredValidator"in t?t.requiredValidator:l(k)],placeholder:"== Pilih Semester ==",label:"Periode Aktif",name:"semester_id","item-title":"nama","item-value":"semester_id",require:""},null,8,["modelValue","items","rules"])]),_:1}),o(s,{cols:"12"},{default:i(()=>[o(V,{modelValue:l(e).tanggal_rapor,"onUpdate:modelValue":a[1]||(a[1]=r=>l(e).tanggal_rapor=r),label:"Tanggal Rapor Semester",placeholder:"== Pilih Tanggal Rapor Semester ==",config:l(q)},null,8,["modelValue","config"])]),_:1}),o(s,{cols:"12"},{default:i(()=>[o(V,{modelValue:l(e).tanggal_rapor_kelas_akhir,"onUpdate:modelValue":a[2]||(a[2]=r=>l(e).tanggal_rapor_kelas_akhir=r),label:"Tanggal Rapor Kelas Akhir",placeholder:"== Pilih Tanggal Rapor Kelas Akhir ==",config:l(q)},null,8,["modelValue","config"])]),_:1}),o(s,{cols:"12"},{default:i(()=>[o(d,{modelValue:l(e).zona,"onUpdate:modelValue":a[3]||(a[3]=r=>l(e).zona=r),items:l(R),rules:["requiredValidator"in t?t.requiredValidator:l(k)],placeholder:"== Pilih Zona Waktu ==",label:"Zona Waktu",name:"semester_id",require:""},null,8,["modelValue","items","rules"])]),_:1}),o(s,{cols:"12"},{default:i(()=>[o(d,{modelValue:l(e).kepala_sekolah,"onUpdate:modelValue":a[4]||(a[4]=r=>l(e).kepala_sekolah=r),items:l(S),rules:["requiredValidator"in t?t.requiredValidator:l(k)],placeholder:"== Pilih Kepala Sekolah ==",label:"Kepala Sekolah",name:"semester_id","item-title":"nama_lengkap","item-value":"guru_id",require:""},null,8,["modelValue","items","rules"])]),_:1}),o(s,{cols:"12"},{default:i(()=>[o(d,{modelValue:l(e).jabatan,"onUpdate:modelValue":a[5]||(a[5]=r=>l(e).jabatan=r),items:l(z),rules:["requiredValidator"in t?t.requiredValidator:l(k)],placeholder:"== Pilih Semester ==",label:"Jabatan Kepala Sekolah",name:"jabatan",require:""},null,8,["modelValue","items","rules"])]),_:1}),o(s,{cols:"12"},{default:i(()=>[o(d,{modelValue:l(e).rombel_4_tahun,"onUpdate:modelValue":a[6]||(a[6]=r=>l(e).rombel_4_tahun=r),chips:"",multiple:"","closable-chips":"",items:l(T),placeholder:"== Pilih Rombel 4 Tahun ==",label:"Rombel 4 Tahun",name:"rombel_4_tahun","item-title":"nama","item-value":"rombongan_belajar_id",require:""},null,8,["modelValue","items"])]),_:1}),o(s,{cols:"12"},{default:i(()=>[o(u,{modelValue:l(e).url_dapodik,"onUpdate:modelValue":a[7]||(a[7]=r=>l(e).url_dapodik=r),label:"URL Dapodik",placeholder:"Contoh: http://localhost:5774 (tanpa garis miring di akhir!)"},null,8,["modelValue"])]),_:1}),o(s,{cols:"12"},{default:i(()=>[o(u,{modelValue:l(e).token_dapodik,"onUpdate:modelValue":a[8]||(a[8]=r=>l(e).token_dapodik=r),label:"Token Web Services Dapodik",placeholder:"Token Web Services Dapodik"},null,8,["modelValue"])]),_:1}),o(s,{cols:"12"},{default:i(()=>[a[13]||(a[13]=M("label",{class:"v-label text-body-2 text-high-emphasis",for:"bg_login"},"Kustom Background (Laman Login & Register)",-1)),l(y)?(m(),f(h,{key:0,id:"bg_login",modelValue:l(e).bg_login,"onUpdate:modelValue":a[9]||(a[9]=r=>l(e).bg_login=r),"error-messages":l(_).bg_login,accept:"image/*",label:"Unggah Kustom Background"},{append:i(()=>[o(O,{icon:"tabler-trash",color:"error",size:"26",onClick:L})]),_:1},8,["modelValue","error-messages"])):(m(),f(h,{key:1,id:"bg_login",modelValue:l(e).bg_login,"onUpdate:modelValue":a[10]||(a[10]=r=>l(e).bg_login=r),"error-messages":l(_).bg_login,accept:"image/*",label:"Unggah Kustom Background"},null,8,["modelValue","error-messages"]))]),_:1}),o(s,{cols:"12",class:"d-flex gap-4"},{default:i(()=>[o(E,{type:"submit"},{default:i(()=>a[14]||(a[14]=[Z(" Simpan ")])),_:1})]),_:1})]),_:1})]),_:1}),o(s,{cols:"5"},{default:i(()=>[o(re,{alt:"Logo Sekolah",src:l(P),cover:"",class:"w-100 mx-auto mb-10"},null,8,["src"]),o(h,{modelValue:l(e).photo,"onUpdate:modelValue":a[11]||(a[11]=r=>l(e).photo=r),"error-messages":l(_).photo,accept:"image/*",label:"Unggah Logo Sekolah"},null,8,["modelValue","error-messages"])]),_:1})]),_:1})]),_:1},512)]),_:1}))]),_:1}),o(W,{isDialogVisible:l(p),"onUpdate:isDialogVisible":a[12]||(a[12]=r=>x(p)?p.value=r:null),"confirm-color":l(g).color,"confirm-title":l(g).title,"confirm-msg":l(g).text,onConfirm:w},null,8,["isDialogVisible","confirm-color","confirm-title","confirm-msg"])])}}};export{Ce as default};
