import{_ as L}from"./ProfileSiswa-BQqhhPWB.js";import{d as h,a as j}from"./mixins-CyMBM5fU.js";import{u as S,c as T}from"./createUrl-5K3jXwP3.js";import{V as A,c as F,a as I,b as R}from"./VCard-B6efkknt.js";import{G as U,r as y,f as C,e as p,o as a,b as c,aa as z,t as N,m as g,c as r,am as M,F as o,d as s,h as k,y as q,v as d}from"./main-WcaAB0Vb.js";import{V as E}from"./VDivider-DIWjfe5J.js";import{V as G}from"./VTable-Dxydgzys.js";import"./VImg-BR-W7-GF.js";import"./VAvatar-C5PogN-2.js";import"./index-BxkgbwWS.js";const K={key:0},H={class:"text-center"},J={class:"text-center",rowspan:"3"},O={key:0,class:"text-center"},Q={key:1,class:"text-center"},W={key:0,class:"text-center"},X={class:"text-center"},Y={class:"text-center"},Z={class:"text-center"},ee={key:1,class:"text-center"},ae={class:"text-center"},te={class:"text-center"},re={class:"text-center"},ce={__name:"unduh-legger",setup(se){U(async()=>{await D()});const x=y({body:!1}),l=y({user_id:h.user_id,guru_id:h.guru_id,sekolah_id:h.sekolah_id,semester_id:j.semester_id,periode_aktif:j.nama,aksi:"unduh-legger",rapor_pts:!1,merdeka:!1,is_ppa:!1,rombongan_belajar_id:null}),m=y({siswa:[],pembelajaran:[]}),D=async()=>{x.value.body=!0;try{let e=(await S(T("/walas",{query:{user_id:l.value.user_id,guru_id:l.value.guru_id,sekolah_id:l.value.sekolah_id,semester_id:l.value.semester_id,periode_aktif:l.value.nama,aksi:l.value.aksi,pilihan:0}}))).data.value;l.value.rombongan_belajar_id=e.rombel.rombongan_belajar_id,l.value.merdeka=e.merdeka,l.value.is_ppa=e.is_ppa,m.value.siswa=e.data_siswa,m.value.pembelajaran=e.pembelajaran}catch(n){console.error(n)}finally{x.value.body=!1}},$=()=>{if(l.value.rombongan_belajar_id){if(l.value.merdeka||l.value.is_ppa)var n=`/downloads/leger-nilai-kurmer/${l.value.rombongan_belajar_id}/${l.value.sekolah_id}/${l.value.semester_id}`;else var n=`/downloads/leger-nilai-rapor/${l.value.rombongan_belajar_id}`;window.open(n,"_blank").focus()}},b=(n,e)=>{const _=n.find(t=>t.anggota_rombel_id===e);return(_==null?void 0:_.nilai)??"-"},v=(n,e)=>{const _=n.find(t=>t.anggota_rombel_id===e.anggota_rombel_id);return(_==null?void 0:_.nilai)??"-"},P=(n,e,_,t)=>{n=n*f(_),e=e*f(t);var u=(n+e)/100;return isNaN(u)?u="-":u=Math.ceil(u),u},f=n=>n??50;return(n,e)=>{const _=L;return a(),C(A,{class:"mb-6"},{default:p(()=>[c(I,{class:"pb-4"},{append:p(()=>[c(z,{"prepend-icon":"tabler-file-type-xls",onClick:$},{default:p(()=>e[1]||(e[1]=[N(" Unduh Legger ")])),_:1})]),default:p(()=>[c(F,null,{default:p(()=>e[0]||(e[0]=[N("Unduh Legger")])),_:1})]),_:1}),g(x).body?(a(),r(o,{key:0},[c(E),c(R,{class:"text-center"},{default:p(()=>[c(M,{size:60,indeterminate:"",color:"error",class:"my-10"})]),_:1})],64)):(a(),r(o,{key:1},[g(m).siswa.length?(a(),C(G,{key:0,class:"text-no-wrap"},{default:p(()=>[s("thead",null,[g(l).merdeka||g(l).is_ppa?(a(),r("tr",K,[e[2]||(e[2]=s("th",{class:"text-center"},"Peserta Didik",-1)),(a(!0),r(o,null,k(g(m).pembelajaran,(t,u)=>(a(),r("th",H,d(t.nama_mata_pelajaran),1))),256)),e[3]||(e[3]=s("th",{class:"text-center align-middle",rowspan:"3"},"S",-1)),e[4]||(e[4]=s("th",{class:"text-center align-middle",rowspan:"3"},"I",-1)),e[5]||(e[5]=s("th",{class:"text-center align-middle",rowspan:"3"},"A",-1))])):(a(),r(o,{key:1},[e[9]||(e[9]=s("th",{class:"text-center"},"Peserta Didik",-1)),(a(!0),r(o,null,k(g(m).pembelajaran,(t,u)=>(a(),r("th",J,d(t.nama_mata_pelajaran),1))),256)),e[10]||(e[10]=s("th",{class:"text-center align-middle",rowspan:"3"},"S",-1)),e[11]||(e[11]=s("th",{class:"text-center align-middle",rowspan:"3"},"I",-1)),e[12]||(e[12]=s("th",{class:"text-center align-middle",rowspan:"3"},"A",-1)),s("tr",null,[(a(!0),r(o,null,k(g(m).pembelajaran,(t,u)=>(a(),r(o,null,[e[6]||(e[6]=s("th",{class:"text-center"},"P",-1)),e[7]||(e[7]=s("th",{class:"text-center"},"K",-1)),e[8]||(e[8]=s("th",{class:"text-center"},"R",-1))],64))),256))])],64))]),s("tbody",null,[(a(!0),r(o,null,k(g(m).siswa,t=>{var u,w,V;return a(),r("tr",null,[s("td",null,[c(_,{item:t},null,8,["item"])]),g(l).merdeka?(a(!0),r(o,{key:0},k(g(m).pembelajaran,(i,B)=>(a(),r(o,null,[i.rombongan_belajar.jenis_rombel=="1"?(a(),r("td",O,d(b(i.all_nilai_akhir_kurmer,t.anggota_rombel.anggota_rombel_id)),1)):(a(),r("td",Q,d(v(i.all_nilai_akhir_kurmer,t.anggota_pilihan)),1))],64))),256)):(a(!0),r(o,{key:1},k(n.data_pembelajaran,(i,B)=>(a(),r(o,null,[i.rombongan_belajar.jenis_rombel=="1"?(a(),r(o,{key:0},[n.is_ppa?(a(),r("td",W,d(b(i.all_nilai_akhir_pengetahuan,t.anggota_rombel.anggota_rombel_id)),1)):(a(),r(o,{key:1},[s("td",X,d(b(i.all_nilai_akhir_pengetahuan,t.anggota_rombel.anggota_rombel_id)),1),s("td",Y,d(b(i.all_nilai_akhir_keterampilan,t.anggota_rombel.anggota_rombel_id)),1),s("td",Z,d(P(b(i.all_nilai_akhir_pengetahuan,t.anggota_rombel.anggota_rombel_id),b(i.all_nilai_akhir_keterampilan,t.anggota_rombel.anggota_rombel_id),f(i.rasio_p),f(i.rasio_k))),1)],64))],64)):(a(),r("td",ee,d(v(i.all_nilai_akhir_kurmer,t.anggota_pilihan)),1))],64))),256)),s("td",ae,d(((u=t.anggota_rombel.absensi)==null?void 0:u.sakit)??"-"),1),s("td",te,d(((w=t.anggota_rombel.absensi)==null?void 0:w.izin)??"-"),1),s("td",re,d(((V=t.anggota_rombel.absensi)==null?void 0:V.alpa)??"-"),1)])}),256))])]),_:1})):q("",!0)],64))]),_:1})}}};export{ce as default};
